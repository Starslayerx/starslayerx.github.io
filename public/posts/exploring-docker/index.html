<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Exploring Docker | Starslayerx&#39; Blog</title>
<meta name="keywords" content="Docker">
<meta name="description" content="之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：

Docker version
Server information
Downloading image updates
Inspecting containers
Entering a running container
Returning a result
Viewing logs
Monitoring statistics

Printing the Docker Version
% docker version

Client:
 Version:           28.4.0
 API version:       1.51
 Go version:        go1.24.7
 Git commit:        d8eb465
 Built:             Wed Sep  3 20:56:26 2025
 OS/Arch:           darwin/arm64
 Context:           desktop-linux

Server: Docker Desktop 4.47.0 (206054)
 Engine:
  Version:          28.4.0
  API version:      1.51 (minimum version 1.24)
  Go version:       go1.24.7
  Git commit:       249d679
  Built:            Wed Sep  3 20:58:53 2025
  OS/Arch:          linux/arm64
  Experimental:     false
 containerd:
  Version:          1.7.27
  GitCommit:        05044ec0a9a75232cad458027ca83437aae3f4da
 runc:
  Version:          1.2.5
  GitCommit:        v1.2.5-0-g59923ef
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0
注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。
一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。">
<meta name="author" content="Starslayerx">
<link rel="canonical" href="http://localhost:1313/posts/exploring-docker/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.svg">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.svg">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.svg">
<link rel="mask-icon" href="http://localhost:1313/favicon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/exploring-docker/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/posts/exploring-docker/">
  <meta property="og:site_name" content="Starslayerx&#39; Blog">
  <meta property="og:title" content="Exploring Docker">
  <meta property="og:description" content="之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：
Docker version Server information Downloading image updates Inspecting containers Entering a running container Returning a result Viewing logs Monitoring statistics Printing the Docker Version % docker version Client: Version: 28.4.0 API version: 1.51 Go version: go1.24.7 Git commit: d8eb465 Built: Wed Sep 3 20:56:26 2025 OS/Arch: darwin/arm64 Context: desktop-linux Server: Docker Desktop 4.47.0 (206054) Engine: Version: 28.4.0 API version: 1.51 (minimum version 1.24) Go version: go1.24.7 Git commit: 249d679 Built: Wed Sep 3 20:58:53 2025 OS/Arch: linux/arm64 Experimental: false containerd: Version: 1.7.27 GitCommit: 05044ec0a9a75232cad458027ca83437aae3f4da runc: Version: 1.2.5 GitCommit: v1.2.5-0-g59923ef docker-init: Version: 0.19.0 GitCommit: de40ad0 注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。 一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。">
  <meta property="og:locale" content="en-US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-11T08:00:00+08:00">
    <meta property="article:modified_time" content="2025-12-11T08:00:00+08:00">
    <meta property="article:tag" content="Docker">
      <meta property="og:image" content="http://localhost:1313/images/og-default.avif">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/og-default.avif">
<meta name="twitter:title" content="Exploring Docker">
<meta name="twitter:description" content="之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：

Docker version
Server information
Downloading image updates
Inspecting containers
Entering a running container
Returning a result
Viewing logs
Monitoring statistics

Printing the Docker Version
% docker version

Client:
 Version:           28.4.0
 API version:       1.51
 Go version:        go1.24.7
 Git commit:        d8eb465
 Built:             Wed Sep  3 20:56:26 2025
 OS/Arch:           darwin/arm64
 Context:           desktop-linux

Server: Docker Desktop 4.47.0 (206054)
 Engine:
  Version:          28.4.0
  API version:      1.51 (minimum version 1.24)
  Go version:       go1.24.7
  Git commit:       249d679
  Built:            Wed Sep  3 20:58:53 2025
  OS/Arch:          linux/arm64
  Experimental:     false
 containerd:
  Version:          1.7.27
  GitCommit:        05044ec0a9a75232cad458027ca83437aae3f4da
 runc:
  Version:          1.2.5
  GitCommit:        v1.2.5-0-g59923ef
 docker-init:
  Version:          0.19.0
  GitCommit:        de40ad0
注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。
一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Exploring Docker",
      "item": "http://localhost:1313/posts/exploring-docker/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Exploring Docker",
  "name": "Exploring Docker",
  "description": "之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：\nDocker version Server information Downloading image updates Inspecting containers Entering a running container Returning a result Viewing logs Monitoring statistics Printing the Docker Version % docker version Client: Version: 28.4.0 API version: 1.51 Go version: go1.24.7 Git commit: d8eb465 Built: Wed Sep 3 20:56:26 2025 OS/Arch: darwin/arm64 Context: desktop-linux Server: Docker Desktop 4.47.0 (206054) Engine: Version: 28.4.0 API version: 1.51 (minimum version 1.24) Go version: go1.24.7 Git commit: 249d679 Built: Wed Sep 3 20:58:53 2025 OS/Arch: linux/arm64 Experimental: false containerd: Version: 1.7.27 GitCommit: 05044ec0a9a75232cad458027ca83437aae3f4da runc: Version: 1.2.5 GitCommit: v1.2.5-0-g59923ef docker-init: Version: 0.19.0 GitCommit: de40ad0 注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。 一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。\n",
  "keywords": [
    "Docker"
  ],
  "articleBody": "之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：\nDocker version Server information Downloading image updates Inspecting containers Entering a running container Returning a result Viewing logs Monitoring statistics Printing the Docker Version % docker version Client: Version: 28.4.0 API version: 1.51 Go version: go1.24.7 Git commit: d8eb465 Built: Wed Sep 3 20:56:26 2025 OS/Arch: darwin/arm64 Context: desktop-linux Server: Docker Desktop 4.47.0 (206054) Engine: Version: 28.4.0 API version: 1.51 (minimum version 1.24) Go version: go1.24.7 Git commit: 249d679 Built: Wed Sep 3 20:58:53 2025 OS/Arch: linux/arm64 Experimental: false containerd: Version: 1.7.27 GitCommit: 05044ec0a9a75232cad458027ca83437aae3f4da runc: Version: 1.2.5 GitCommit: v1.2.5-0-g59923ef docker-init: Version: 0.19.0 GitCommit: de40ad0 注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。 一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。\nServer Information 通过 docker server 能够看到文件系统的类型、内核版本、操作相同类型，安装了哪些插件，使用的哪个 runtime，以及存储了多少容器和镜像。\n% docker system info Client: Version: 28.4.0 Context: desktop-linux Debug Mode: false Plugins: ai: Docker AI Agent - Ask Gordon (Docker Inc.) Version: v1.9.11 Path: /Users/starslayerx/.docker/cli-plugins/docker-ai buildx: Docker Buildx (Docker Inc.) Version: v0.28.0-desktop.1 Path: /Users/starslayerx/.docker/cli-plugins/docker-buildx cloud: Docker Cloud (Docker Inc.) Version: v0.4.29 Path: /Users/starslayerx/.docker/cli-plugins/docker-cloud compose: Docker Compose (Docker Inc.) Version: v2.39.4-desktop.1 Path: /Users/starslayerx/.docker/cli-plugins/docker-compose debug: Get a shell into any image or container (Docker Inc.) Version: 0.0.42 Path: /Users/starslayerx/.docker/cli-plugins/docker-debug desktop: Docker Desktop commands (Docker Inc.) Version: v0.2.0 Path: /Users/starslayerx/.docker/cli-plugins/docker-desktop extension: Manages Docker extensions (Docker Inc.) Version: v0.2.31 Path: /Users/starslayerx/.docker/cli-plugins/docker-extension init: Creates Docker-related starter files for your project (Docker Inc.) Version: v1.4.0 Path: /Users/starslayerx/.docker/cli-plugins/docker-init mcp: Docker MCP Plugin (Docker Inc.) Version: v0.21.0 Path: /Users/starslayerx/.docker/cli-plugins/docker-mcp model: Docker Model Runner (Docker Inc.) Version: v0.1.41 Path: /Users/starslayerx/.docker/cli-plugins/docker-model sbom: View the packaged-based Software Bill Of Materials (SBOM) for an image (Anchore Inc.) Version: 0.6.0 Path: /Users/starslayerx/.docker/cli-plugins/docker-sbom scout: Docker Scout (Docker Inc.) Version: v1.18.3 Path: /Users/starslayerx/.docker/cli-plugins/docker-scout Server: Containers: 0 Running: 0 Paused: 0 Stopped: 0 Images: 5 Server Version: 28.4.0 Storage Driver: overlay2 Backing Filesystem: extfs Supports d_type: true Using metacopy: false Native Overlay Diff: true userxattr: false Logging Driver: json-file Cgroup Driver: cgroupfs Cgroup Version: 2 Plugins: Volume: local Network: bridge host ipvlan macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog CDI spec directories: /etc/cdi /var/run/cdi Swarm: inactive Runtimes: io.containerd.runc.v2 runc Default Runtime: runc Init Binary: docker-init containerd version: 05044ec0a9a75232cad458027ca83437aae3f4da runc version: v1.2.5-0-g59923ef init version: de40ad0 Security Options: seccomp Profile: builtin cgroupns Kernel Version: 6.10.14-linuxkit Operating System: Docker Desktop OSType: linux Architecture: aarch64 CPUs: 6 Total Memory: 3.828GiB Name: docker-desktop ID: 60fc8d35-0ffd-4da6-8abf-f8260e25c336 Docker Root Dir: /var/lib/docker Debug Mode: false HTTP Proxy: http.docker.internal:3128 HTTPS Proxy: http.docker.internal:3128 No Proxy: hubproxy.docker.internal Labels: com.docker.desktop.address=unix:///Users/starslayerx/Library/Containers/com.docker.docker/Data/docker-cli.sock Experimental: false Insecure Registries: hubproxy.docker.internal:5555 ::1/128 127.0.0.0/8 Live Restore Enabled: false Docker本身由许多不同的插件共同协作构成。 这种设计极具优势，因为它意味着用户还可以安装由社区成员贡献的其他多种插件。 即使您只是想确认Docker是否已识别最近添加的插件，能够查看已安装的插件列表也非常实用。\n在大多数情况下，默认的根目录 /var/lib/docker 将用来存储镜像和容器。 如果要修改这个位置，可以使用 --data-root 指定其他位置\nsudo dockerd \\ -H unix://var/run/docker.sock \\ --data-root=\"/data/docker\" 默认的 docker 配置文件在 /etc/docker/daemon.json，该文件的配置会直接传递给 dockerd，建议使用该文件永久配置。\nDownloading Image Updates 下面例子都使用 ubuntu 镜像。\n% docker image pull ubuntu:latest latest: Pulling from library/ubuntu 97dd3f0ce510: Pull complete Digest: sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54 Status: Downloaded newer image for ubuntu:latest docker.io/library/ubuntu:latest 需要记住的是，即使拉取了最新版本，Docker 也不会自动更新本地镜像。 这需要自己负责处理。 不过，如果部署基于较新版本 ubuntu:latest 的镜像，Docker 客户端会在部署过程中下载缺失的层，正如预期的那样。 注意，这是 Docker 客户端的行为，其他库或 API 工具可能不会以这种方式运行。 强烈建议始终使用固定版本标签而非 latest 标签来部署生产代码。这有助于确保获得预期的版本，避免意外情况。\n也可以使用镜像的 sha256 内容地址 tag，像这样：\nsha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54 对应的命令有些不同，注意符号 @\ndocker image pull ubuntu@sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54 这里的 sha256 地址不能简写，想要完整的地址\nInspecting a Container 容器创建后，无论是否运行，都可以使用 docker 查看其配置。 这在调试容器和辨别容器上很有用。\n先运行一个容器：\n% docker container run --rm -t -d ubuntu /bin/bash 591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704 --rm: 容器退出后自动删除 -t: 为容器分配一个伪终端 pseudo-TTY -d: 以后台模式 detached mode 运行容器 docker 检查信息有点冗余\n% docker container inspect 591db9e9ec10 [ { \"Id\": \"591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704\", \"Created\": \"2025-12-11T09:20:40.095487792Z\", \"Path\": \"/bin/bash\", \"Args\": [], \"State\": { \"Status\": \"running\", \"Running\": true, \"Paused\": false, \"Restarting\": false, \"OOMKilled\": false, \"Dead\": false, \"Pid\": 616, \"ExitCode\": 0, \"Error\": \"\", \"StartedAt\": \"2025-12-11T09:20:40.157077708Z\", \"FinishedAt\": \"0001-01-01T00:00:00Z\" }, \"Image\": \"sha256:9a84ec2d5dd7ad691e3df0d6e7c6e7ebd6ba67fdd1b6172588c009c12359d307\", \"ResolvConfPath\": \"/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/resolv.conf\", \"HostnamePath\": \"/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/hostname\", \"HostsPath\": \"/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/hosts\", \"LogPath\": \"/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704-json.log\", \"Name\": \"/cool_bose\", \"RestartCount\": 0, \"Driver\": \"overlay2\", \"Platform\": \"linux\", \"MountLabel\": \"\", \"ProcessLabel\": \"\", \"AppArmorProfile\": \"\", \"ExecIDs\": null, \"HostConfig\": { \"Binds\": null, \"ContainerIDFile\": \"\", \"LogConfig\": { \"Type\": \"json-file\", \"Config\": {} }, \"NetworkMode\": \"bridge\", \"PortBindings\": {}, \"RestartPolicy\": { \"Name\": \"no\", \"MaximumRetryCount\": 0 }, \"AutoRemove\": true, \"VolumeDriver\": \"\", \"VolumesFrom\": null, \"ConsoleSize\": [ 35, 124 ], \"CapAdd\": null, \"CapDrop\": null, \"CgroupnsMode\": \"private\", \"Dns\": [], \"DnsOptions\": [], \"DnsSearch\": [], \"ExtraHosts\": null, \"GroupAdd\": null, \"IpcMode\": \"private\", \"Cgroup\": \"\", \"Links\": null, \"OomScoreAdj\": 0, \"PidMode\": \"\", \"Privileged\": false, \"PublishAllPorts\": false, \"ReadonlyRootfs\": false, \"SecurityOpt\": null, \"UTSMode\": \"\", \"UsernsMode\": \"\", \"ShmSize\": 67108864, \"Runtime\": \"runc\", \"Isolation\": \"\", \"CpuShares\": 0, \"Memory\": 0, \"NanoCpus\": 0, \"CgroupParent\": \"\", \"BlkioWeight\": 0, \"BlkioWeightDevice\": [], \"BlkioDeviceReadBps\": [], \"BlkioDeviceWriteBps\": [], \"BlkioDeviceReadIOps\": [], \"BlkioDeviceWriteIOps\": [], \"CpuPeriod\": 0, \"CpuQuota\": 0, \"CpuRealtimePeriod\": 0, \"CpuRealtimeRuntime\": 0, \"CpusetCpus\": \"\", \"CpusetMems\": \"\", \"Devices\": [], \"DeviceCgroupRules\": null, \"DeviceRequests\": null, \"MemoryReservation\": 0, \"MemorySwap\": 0, \"MemorySwappiness\": null, \"OomKillDisable\": null, \"PidsLimit\": null, \"Ulimits\": [], \"CpuCount\": 0, \"CpuPercent\": 0, \"IOMaximumIOps\": 0, \"IOMaximumBandwidth\": 0, \"MaskedPaths\": [ \"/proc/asound\", \"/proc/acpi\", \"/proc/interrupts\", \"/proc/kcore\", \"/proc/keys\", \"/proc/latency_stats\", \"/proc/timer_list\", \"/proc/timer_stats\", \"/proc/sched_debug\", \"/proc/scsi\", \"/sys/firmware\", \"/sys/devices/virtual/powercap\" ], \"ReadonlyPaths\": [ \"/proc/bus\", \"/proc/fs\", \"/proc/irq\", \"/proc/sys\", \"/proc/sysrq-trigger\" ] }, \"GraphDriver\": { \"Data\": { \"ID\": \"591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704\", \"LowerDir\": \"/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f-init/diff:/var/lib/docker/overlay2/b1a16eb3a83938d4bb52a8279e87a23c919793de6bac7691f7282fa6311c9f62/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/work\" }, \"Name\": \"overlay2\" }, \"Mounts\": [], \"Config\": { \"Hostname\": \"591db9e9ec10\", \"Domainname\": \"\", \"User\": \"\", \"AttachStdin\": false, \"AttachStdout\": false, \"AttachStderr\": false, \"Tty\": true, \"OpenStdin\": false, \"StdinOnce\": false, \"Env\": [ \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\" ], \"Cmd\": [ \"/bin/bash\" ], \"Image\": \"ubuntu\", \"Volumes\": null, \"WorkingDir\": \"\", \"Entrypoint\": null, \"OnBuild\": null, \"Labels\": { \"org.opencontainers.image.ref.name\": \"ubuntu\", \"org.opencontainers.image.version\": \"24.04\" } }, \"NetworkSettings\": { \"Bridge\": \"\", \"SandboxID\": \"079b975620af085dc5d2498a4d63f0db8005ef5d3faeb8e14809d6e27c2dae8b\", \"SandboxKey\": \"/var/run/docker/netns/079b975620af\", \"Ports\": {}, \"HairpinMode\": false, \"LinkLocalIPv6Address\": \"\", \"LinkLocalIPv6PrefixLen\": 0, \"SecondaryIPAddresses\": null, \"SecondaryIPv6Addresses\": null, \"EndpointID\": \"41ced3762ad84154bdd497801be5db07337ca54cac82d183f65349603c7e9a13\", \"Gateway\": \"172.17.0.1\", \"GlobalIPv6Address\": \"fde6:dc51:edf::2\", \"GlobalIPv6PrefixLen\": 64, \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"fde6:dc51:edf::1\", \"MacAddress\": \"da:6e:ae:6f:d5:c8\", \"Networks\": { \"bridge\": { \"IPAMConfig\": null, \"Links\": null, \"Aliases\": null, \"MacAddress\": \"da:6e:ae:6f:d5:c8\", \"DriverOpts\": null, \"GwPriority\": 0, \"NetworkID\": \"19a3c6274752109c74d9c9eabbb47ac2b4bb1e5b7d670d797b089022cf58caa9\", \"EndpointID\": \"41ced3762ad84154bdd497801be5db07337ca54cac82d183f65349603c7e9a13\", \"Gateway\": \"172.17.0.1\", \"IPAddress\": \"172.17.0.2\", \"IPPrefixLen\": 16, \"IPv6Gateway\": \"fde6:dc51:edf::1\", \"GlobalIPv6Address\": \"fde6:dc51:edf::2\", \"GlobalIPv6PrefixLen\": 64, \"DNSNames\": null } } } } ] 长 Id 字符串：完整版本的容器唯一 id，也可以看到容器创建的具体时间，并比 docker container ls 要详细的多 还有以下在容器启动时可以配置的内容：\ntop level command environment base image container hostname 常见的给容器传递配置的方法是环境变量，因此通过 docker container inspect 能看到大量信息用于调试。\nExploring the shell docker container run --rm -it ubuntu:20.04 /bin/bash 这条命令会启动进入一个 ubuntu 20.04 版本，并开启 bash shell 作为顶层进程。\n查看容器的进程信息如下：\nroot@d0ba261b2d2c:/# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 12:07 pts/0 00:00:00 /bin/bash root 9 1 0 12:09 pts/0 00:00:00 ps -ef 也就是说，该容器内只有一个 bash 进程，没有任何其他进程。 这也是如何在容器中运行 shell 的方法，如果要运行其他软件，使用 apt update 和 apt install 来安装运行，但这些内容只会在容器的生命周期存在，这只是在修改容器本身，而不是镜像。\n如果直接退出 shell 会自然关闭容器\nexit Returning a result docker container run --rm ubuntu:22.04 /bin/false echo $? 1\ndocker container run --rm ubuntu:22.04 /bin/true echo $? 0\n上面命令中\n/bin/true: 什么都不做，立即以退出码 0 退出（成功） /bin/false: 什么都不做，立即以退出码 1 结束（失败） 它们常用于测试、脚本控制流等\n% docker container run --rm ubuntu:20.04 /bin/cat /etc/passwd | wc -l 19 上面命令是将容器中的 cat 输出，通过管道传递到本地的 wc 命令，而不是容器内的 wc 命令。 管道本身不会传递到容器内，如果想要在容日内使用管道，需要使用 bash -c \" | \" 这样的命令。 对应上面命令就是：\ndocker container run ubuntu:20.04 /bin/bash -c \"/bin/cat /etc/passwd | wc -l\" Getting Inside a Running Container 使用 docker container exec 进入一个新的交互式容器的命令，但有一种更加 linux 原生的方式，叫做 nsenter。\n下面先创建一个容器\ndocker container run --rm ubuntu:20.04 sleep 600 sleep 是一个 Linux 用户态程序，让当前进程休眠指定时间（秒） 然后进入容器，命令类似 docker container exec\ndocker container exec -it 03eeebc5ca2d /bin/bash -i: 报持 STDIN 打开 -t: 分配一个伪终端 pseudo-TTY 进入容器后查看一下进程\nroot@03eeebc5ca2d:/# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 02:26 ? 00:00:00 sleep 600 root 6 0 0 02:27 pts/0 00:00:00 /bin/bash root 14 6 0 02:28 pts/0 00:00:00 ps -ef 也可以使用 docker container exec 在容器中启动额外的后台进程，类似 docker run 命令，使用参数 -d (detached)。 但对于调试之外，应该谨慎使用该机制，因为这会破坏镜像部署的可重复性。 因为其他人必须要知道向 docker container exec 传入哪些命令，才能获取预期的功能。 更好的方式应该是重新构建容器镜像，如果只是需要通知容器内的软件执行某个动作，更加合理的方式是使用 docker container kill -s ，通过标准的 Unix 信号向容器内的进程传递信息。\nDocker 支持一个 volume 命令，可用于列出存储在根目录中的所有卷，并可进一步查看他们的详细信息，包括这些卷在服务器上的物理存储位置。\n这些 volumes 不是绑定挂载的，相反，他们是用于持久化数据的特殊数据容器。\n% docker volume ls DRIVER VOLUME NAME local 8ae9318b841d9590eb9bb4325ee8bcd65ad7255e71561189dd4b56965b4cfb43 local 160507e738bcb4d769e42bdad8597b4a2e0e7fe3ed73ccaa56368c9980c8cdcf local b6800a72157489e14f94b287b8cee35a7e725ca83afd4ccde866f6942cec83c8 local deploy_postgres_data_cloud local deploy_redis_data_cloud local f8c40ca914edbf435c2de5e5d7ae7a382eb0be948b9d2c253c03281c82a9b5d7 可以自己创建卷\ndocker volume create my-data 还可以检查数据卷\n% docker volume inspect my-data [ { \"CreatedAt\": \"2025-12-13T03:27:41Z\", \"Driver\": \"local\", \"Labels\": null, \"Mountpoint\": \"/var/lib/docker/volumes/my-data/_data\", \"Name\": \"my-data\", \"Options\": null, \"Scope\": \"local\" } ] 现在就可以在启动容器的时候使用该该数据卷了\ndocker container run --rm \\ --mount source=mydata, target=/app \\ ubuntu:latest touch /app/my-persistent-data 也可以自己删除相关数据卷\ndocker volume rm my-data Logging Logging 日志是一个在生产环境中至关重要的部分，当出问题的时候，日志是恢复服务的重要工具。 如果你运行在一台主机上，你可能会将日志输出到一个本地的 logfile 文件中。 或者将输出记录在内核缓存 (kernel buffer) 中，然后从 dmesg 读取。 或者像许多使用 systemd 的现代 Linux 发行版那样，期望日志可以通过 journalctl 来查看。\njournalctl 是 systemd 提供的统一日志查询工具，用于读取 systemd-journald 收集的日志。 由于容器的限制和 docker 的构建方式，这些方法在不配置的情况下都不会正常工作。 但没有关系，因为 logging 在 docker 内有一流支持。\nDocker 会捕获容器内所有的文本输出，任何 stdout 或 stderr 都会被 Docker daemon 捕获，并将其推送至一个后端日志中。\ndocker container logs docker 内置了 json-file 日志插件，每个容器内应用的日志会被 Docker daemon 流式传输到一个 JSON 文件中。 可以使用 docker container logs 命令查看日志\n先拉取一个镜像并创建容器\ndocker container run --rm -d --name nginx-test --rm nginx:latest 然后查看日志\n% docker container logs 7bdfc9e334d8 /docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/ /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh 10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf 10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh /docker-entrypoint.sh: Configuration complete; ready for start up 2025/12/13 06:37:18 [notice] 1#1: using the \"epoll\" event method 2025/12/13 06:37:18 [notice] 1#1: nginx/1.29.4 2025/12/13 06:37:18 [notice] 1#1: built by gcc 14.2.0 (Debian 14.2.0-19) 2025/12/13 06:37:18 [notice] 1#1: OS: Linux 6.10.14-linuxkit 2025/12/13 06:37:18 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576 2025/12/13 06:37:18 [notice] 1#1: start worker processes 2025/12/13 06:37:18 [notice] 1#1: start worker process 29 2025/12/13 06:37:18 [notice] 1#1: start worker process 30 2025/12/13 06:37:18 [notice] 1#1: start worker process 31 2025/12/13 06:37:18 [notice] 1#1: start worker process 32 2025/12/13 06:37:18 [notice] 1#1: start worker process 33 2025/12/13 06:37:18 [notice] 1#1: start worker process 34 这种方式对于小容量的日志十分有用。\n要将日志输出限制为较新的内容，可以使用 --since 选项，显示在指定直接后的日志，时间可以使用以下格式：\nRFC 3339 格式：2020-10-02T10:00:00-05:00 Unix 时间戳：1450071961 标准日期格式：20220731 Go 时间段字符串：5m45s 还可以使用 --tail 选项显示指定的若干行\n实际的日志存储地址默认在 /var/lib/docker/containers/\n$ sudo ls /var/lib/docker/containers 13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad 17518b5d83f8b9dec547373a65f8505d76204b1c7e73cbb70accb20b14b99e3a 197ad199c73e6b0d118cfcf2c12e66df1f969920d730f0ae147f89687c1e0361 8e333a8c7241c332dd65751b0bbc1a0c8e93b9f1d44c1f307ce5b1a16dcc867a f471f0bc60bdaf943f41c9c97255262d843e760676c7fa4b78d5a27b500013c6 fb6fdf34f33213953eba036a48089b08b9513e027fafb6f410e1433e87679487 上面列出的是每个容器的目录，若要查询日志，需要查看目录下面的 -json.log 文件\n$ sudo tail -3 /var/lib/docker/containers/13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad/13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad-json.log {\"log\":\"2025-12-13 05:54:51.691 UTC [27] LOG: checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.503 s, sync=0.078 s, total=0.765 s; sync files=6, longest=0.055 s, average=0.013 s; distance=19 kB, estimate=22 kB; lsn=0/1B96448, redo lsn=0/1B96410\\n\",\"stream\":\"stderr\",\"time\":\"2025-12-13T05:54:51.69140269Z\"} {\"log\":\"2025-12-13 06:09:50.890 UTC [27] LOG: checkpoint starting: time\\n\",\"stream\":\"stderr\",\"time\":\"2025-12-13T06:09:50.890460875Z\"} {\"log\":\"2025-12-13 06:09:51.669 UTC [27] LOG: checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.505 s, sync=0.126 s, total=0.780 s; sync files=6, longest=0.103 s, average=0.021 s; distance=20 kB, estimate=22 kB; lsn=0/1B9B4E0, redo lsn=0/1B9B4A8\\n\",\"stream\":\"stderr\",\"time\":\"2025-12-13T06:09:51.66995443Z\"} 使用参数 -f 可以进入交互式环境，持续查看最近的日志信息\ndocker container logs -f nginx-test 对于单一主机的日志而言，这种方法很不错。 其不足之处在于日志轮转、轮转后远程访问日志以及高流量日志记录时的磁盘空间占用问题。 如果你有更加复制的环境，你将需要更加鲁棒和中心化的日志功能。\nDocker daemon 守护进程的默认配置并不会启用日志轮转。 因此，如果在生成环境中运行容器，务必通过命令行参数或 daemon.json 配置文件显示指定 --log-opt max-size 和 --log-opt max-file 这两个选项。\n其中，max-size 用于限定单个日志文件在触发轮转之前所允许的最大大小，而 max-file 用于限定日志轮转后最多保留的日志文件数量。 要注意的是，单独配置 max-file 并不会生效，因为 Docker 只有在知道合适需要进行日志轮转的情况下，才会创建多个日志文件。 当日志轮转启用后，docker container logs 只会返回当前正在写入的日志文件中的数据，而不会读取已经归档的旧日志文件。\nMore Advanced Logging 当默认的机制不够用的时候，尤其是在大规模场景下，Docker 还支持可配置的日志后端。 这些日志后端的插件列表在不断增长，除了前面提到的 json-file，还有 syslog、fluentd、journald、gelf、awslgos、splunk、gcplogs、local、logentries 等，这些后端用于把容器日志发送到各种主流的日志框架和日志服务中。 可以使用命令参数 --log-driver=syslog 来指定后端。\nTIPS\n在 docker compose 里面可以这样配置\nservices: # PostgreSQL 数据库 postgres: image: postgres:16-alpine container_name: postgres_db logging: driver: \"json-file\" options: max-size: \"10m\" max-file: \"10\" 这样表示使用 json-file 作为后端，单个容器日志文件最多 10 个，每个最大 10 MiB。\n如果使用 daemon.json 配置，其一般位于 /etc/docker 下面，如果使用 docker desktop 则可以使用图像界面去修改配置。\n",
  "wordCount" : "1635",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/og-default.avif","datePublished": "2025-12-11T08:00:00+08:00",
  "dateModified": "2025-12-11T08:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Starslayerx"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/exploring-docker/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Starslayerx' Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.svg"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Starslayerx&#39; Blog (Alt + H)">
                <img src="http://localhost:1313/favicon.svg" alt="" aria-label="logo"
                    height="35">Starslayerx&#39; Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="http://localhost:1313/zh-cn/" title="简体中文"
                                aria-label="简体中文">Zh-Cn</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Exploring Docker
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-12-11 08:00:00 +0800 CST'>December 11, 2025</span>&nbsp;·&nbsp;<span>8 min</span>&nbsp;·&nbsp;<span>1635 words</span>&nbsp;·&nbsp;<span>Starslayerx</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#printing-the-docker-version">Printing the Docker Version</a></li>
        <li><a href="#server-information">Server Information</a></li>
        <li><a href="#downloading-image-updates">Downloading Image Updates</a></li>
        <li><a href="#inspecting-a-container">Inspecting a Container</a></li>
        <li><a href="#exploring-the-shell">Exploring the shell</a></li>
        <li><a href="#returning-a-result">Returning a result</a></li>
        <li><a href="#getting-inside-a-running-container">Getting Inside a Running Container</a></li>
      </ul>
    </li>
    <li><a href="#logging">Logging</a>
      <ul>
        <li><a href="#docker-container-logs">docker container logs</a></li>
        <li><a href="#more-advanced-logging">More Advanced Logging</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>之前几篇关于 docker 的文章已经介绍了 image、container 方面的内容，这篇文章将介绍 Docker 其他方面的能力：</p>
<ul>
<li>Docker version</li>
<li>Server information</li>
<li>Downloading image updates</li>
<li>Inspecting containers</li>
<li>Entering a running container</li>
<li>Returning a result</li>
<li>Viewing logs</li>
<li>Monitoring statistics</li>
</ul>
<h3 id="printing-the-docker-version">Printing the Docker Version<a hidden class="anchor" aria-hidden="true" href="#printing-the-docker-version">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker version
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Client:
</span></span><span class="line"><span class="cl"> Version:           28.4.0
</span></span><span class="line"><span class="cl"> API version:       1.51
</span></span><span class="line"><span class="cl"> Go version:        go1.24.7
</span></span><span class="line"><span class="cl"> Git commit:        d8eb465
</span></span><span class="line"><span class="cl"> Built:             Wed Sep  3 20:56:26 2025
</span></span><span class="line"><span class="cl"> OS/Arch:           darwin/arm64
</span></span><span class="line"><span class="cl"> Context:           desktop-linux
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Server: Docker Desktop 4.47.0 (206054)
</span></span><span class="line"><span class="cl"> Engine:
</span></span><span class="line"><span class="cl">  Version:          28.4.0
</span></span><span class="line"><span class="cl">  API version:      1.51 (minimum version 1.24)
</span></span><span class="line"><span class="cl">  Go version:       go1.24.7
</span></span><span class="line"><span class="cl">  Git commit:       249d679
</span></span><span class="line"><span class="cl">  Built:            Wed Sep  3 20:58:53 2025
</span></span><span class="line"><span class="cl">  OS/Arch:          linux/arm64
</span></span><span class="line"><span class="cl">  Experimental:     false
</span></span><span class="line"><span class="cl"> containerd:
</span></span><span class="line"><span class="cl">  Version:          1.7.27
</span></span><span class="line"><span class="cl">  GitCommit:        05044ec0a9a75232cad458027ca83437aae3f4da
</span></span><span class="line"><span class="cl"> runc:
</span></span><span class="line"><span class="cl">  Version:          1.2.5
</span></span><span class="line"><span class="cl">  GitCommit:        v1.2.5-0-g59923ef
</span></span><span class="line"><span class="cl"> docker-init:
</span></span><span class="line"><span class="cl">  Version:          0.19.0
</span></span><span class="line"><span class="cl">  GitCommit:        de40ad0
</span></span></code></pre></div><p>注意到有 client 和 server 的区分，上面例子中 client 和 server 是匹配的版本，因为是一起安装的，但这并不总是相同的。
一般在生产环境会使用相同版本，在开发换即使版本有一些不大的区别，也会有很大问题。</p>
<h3 id="server-information">Server Information<a hidden class="anchor" aria-hidden="true" href="#server-information">#</a></h3>
<p>通过 docker server 能够看到文件系统的类型、内核版本、操作相同类型，安装了哪些插件，使用的哪个 runtime，以及存储了多少容器和镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker system info
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Client:
</span></span><span class="line"><span class="cl"> Version:    28.4.0
</span></span><span class="line"><span class="cl"> Context:    desktop-linux
</span></span><span class="line"><span class="cl"> Debug Mode: false
</span></span><span class="line"><span class="cl"> Plugins:
</span></span><span class="line"><span class="cl">  ai: Docker AI Agent - Ask Gordon (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v1.9.11
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-ai
</span></span><span class="line"><span class="cl">  buildx: Docker Buildx (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.28.0-desktop.1
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-buildx
</span></span><span class="line"><span class="cl">  cloud: Docker Cloud (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.4.29
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-cloud
</span></span><span class="line"><span class="cl">  compose: Docker Compose (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v2.39.4-desktop.1
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-compose
</span></span><span class="line"><span class="cl">  debug: Get a shell into any image or container (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  0.0.42
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-debug
</span></span><span class="line"><span class="cl">  desktop: Docker Desktop commands (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.2.0
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-desktop
</span></span><span class="line"><span class="cl">  extension: Manages Docker extensions (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.2.31
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-extension
</span></span><span class="line"><span class="cl">  init: Creates Docker-related starter files for your project (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v1.4.0
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-init
</span></span><span class="line"><span class="cl">  mcp: Docker MCP Plugin (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.21.0
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-mcp
</span></span><span class="line"><span class="cl">  model: Docker Model Runner (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v0.1.41
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-model
</span></span><span class="line"><span class="cl">  sbom: View the packaged-based Software Bill Of Materials (SBOM) for an image (Anchore Inc.)
</span></span><span class="line"><span class="cl">    Version:  0.6.0
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-sbom
</span></span><span class="line"><span class="cl">  scout: Docker Scout (Docker Inc.)
</span></span><span class="line"><span class="cl">    Version:  v1.18.3
</span></span><span class="line"><span class="cl">    Path:     /Users/starslayerx/.docker/cli-plugins/docker-scout
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Server:
</span></span><span class="line"><span class="cl"> Containers: 0
</span></span><span class="line"><span class="cl">  Running: 0
</span></span><span class="line"><span class="cl">  Paused: 0
</span></span><span class="line"><span class="cl">  Stopped: 0
</span></span><span class="line"><span class="cl"> Images: 5
</span></span><span class="line"><span class="cl"> Server Version: 28.4.0
</span></span><span class="line"><span class="cl"> Storage Driver: overlay2
</span></span><span class="line"><span class="cl">  Backing Filesystem: extfs
</span></span><span class="line"><span class="cl">  Supports d_type: true
</span></span><span class="line"><span class="cl">  Using metacopy: false
</span></span><span class="line"><span class="cl">  Native Overlay Diff: true
</span></span><span class="line"><span class="cl">  userxattr: false
</span></span><span class="line"><span class="cl"> Logging Driver: json-file
</span></span><span class="line"><span class="cl"> Cgroup Driver: cgroupfs
</span></span><span class="line"><span class="cl"> Cgroup Version: 2
</span></span><span class="line"><span class="cl"> Plugins:
</span></span><span class="line"><span class="cl">  Volume: local
</span></span><span class="line"><span class="cl">  Network: bridge host ipvlan macvlan null overlay
</span></span><span class="line"><span class="cl">  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
</span></span><span class="line"><span class="cl"> CDI spec directories:
</span></span><span class="line"><span class="cl">  /etc/cdi
</span></span><span class="line"><span class="cl">  /var/run/cdi
</span></span><span class="line"><span class="cl"> Swarm: inactive
</span></span><span class="line"><span class="cl"> Runtimes: io.containerd.runc.v2 runc
</span></span><span class="line"><span class="cl"> Default Runtime: runc
</span></span><span class="line"><span class="cl"> Init Binary: docker-init
</span></span><span class="line"><span class="cl"> containerd version: 05044ec0a9a75232cad458027ca83437aae3f4da
</span></span><span class="line"><span class="cl"> runc version: v1.2.5-0-g59923ef
</span></span><span class="line"><span class="cl"> init version: de40ad0
</span></span><span class="line"><span class="cl"> Security Options:
</span></span><span class="line"><span class="cl">  seccomp
</span></span><span class="line"><span class="cl">   Profile: builtin
</span></span><span class="line"><span class="cl">  cgroupns
</span></span><span class="line"><span class="cl"> Kernel Version: 6.10.14-linuxkit
</span></span><span class="line"><span class="cl"> Operating System: Docker Desktop
</span></span><span class="line"><span class="cl"> OSType: linux
</span></span><span class="line"><span class="cl"> Architecture: aarch64
</span></span><span class="line"><span class="cl"> CPUs: 6
</span></span><span class="line"><span class="cl"> Total Memory: 3.828GiB
</span></span><span class="line"><span class="cl"> Name: docker-desktop
</span></span><span class="line"><span class="cl"> ID: 60fc8d35-0ffd-4da6-8abf-f8260e25c336
</span></span><span class="line"><span class="cl"> Docker Root Dir: /var/lib/docker
</span></span><span class="line"><span class="cl"> Debug Mode: false
</span></span><span class="line"><span class="cl"> HTTP Proxy: http.docker.internal:3128
</span></span><span class="line"><span class="cl"> HTTPS Proxy: http.docker.internal:3128
</span></span><span class="line"><span class="cl"> No Proxy: hubproxy.docker.internal
</span></span><span class="line"><span class="cl"> Labels:
</span></span><span class="line"><span class="cl">  com.docker.desktop.address=unix:///Users/starslayerx/Library/Containers/com.docker.docker/Data/docker-cli.sock
</span></span><span class="line"><span class="cl"> Experimental: false
</span></span><span class="line"><span class="cl"> Insecure Registries:
</span></span><span class="line"><span class="cl">  hubproxy.docker.internal:5555
</span></span><span class="line"><span class="cl">  ::1/128
</span></span><span class="line"><span class="cl">  127.0.0.0/8
</span></span><span class="line"><span class="cl"> Live Restore Enabled: false
</span></span></code></pre></div><p>Docker本身由许多不同的插件共同协作构成。
这种设计极具优势，因为它意味着用户还可以安装由社区成员贡献的其他多种插件。
即使您只是想确认Docker是否已识别最近添加的插件，能够查看已安装的插件列表也非常实用。</p>
<p>在大多数情况下，默认的根目录 <code>/var/lib/docker</code> 将用来存储镜像和容器。
如果要修改这个位置，可以使用 <code>--data-root</code> 指定其他位置</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo dockerd <span class="se">\
</span></span></span><span class="line"><span class="cl">  -H unix://var/run/docker.sock <span class="se">\
</span></span></span><span class="line"><span class="cl">  --data-root<span class="o">=</span><span class="s2">&#34;/data/docker&#34;</span>
</span></span></code></pre></div><p>默认的 docker 配置文件在 <code>/etc/docker/daemon.json</code>，该文件的配置会直接传递给 dockerd，建议使用该文件永久配置。</p>
<h3 id="downloading-image-updates">Downloading Image Updates<a hidden class="anchor" aria-hidden="true" href="#downloading-image-updates">#</a></h3>
<p>下面例子都使用 ubuntu 镜像。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker image pull ubuntu:latest
</span></span><span class="line"><span class="cl">latest: Pulling from library/ubuntu
</span></span><span class="line"><span class="cl">97dd3f0ce510: Pull complete
</span></span><span class="line"><span class="cl">Digest: sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54
</span></span><span class="line"><span class="cl">Status: Downloaded newer image for ubuntu:latest
</span></span><span class="line"><span class="cl">docker.io/library/ubuntu:latest
</span></span></code></pre></div><p>需要记住的是，即使拉取了最新版本，Docker 也不会自动更新本地镜像。
这需要自己负责处理。
不过，如果部署基于较新版本 <code>ubuntu:latest</code> 的镜像，Docker 客户端会在部署过程中下载缺失的层，正如预期的那样。
注意，这是 Docker 客户端的行为，其他库或 API 工具可能不会以这种方式运行。
强烈建议始终使用固定版本标签而非 <code>latest</code> 标签来部署生产代码。这有助于确保获得预期的版本，避免意外情况。</p>
<p>也可以使用镜像的 sha256 内容地址 tag，像这样：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54
</span></span></code></pre></div><p>对应的命令有些不同，注意符号 @</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">docker image pull ubuntu@sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54
</span></span></code></pre></div><p>这里的 sha256 地址不能简写，想要完整的地址</p>
<h3 id="inspecting-a-container">Inspecting a Container<a hidden class="anchor" aria-hidden="true" href="#inspecting-a-container">#</a></h3>
<p>容器创建后，无论是否运行，都可以使用 docker 查看其配置。
这在调试容器和辨别容器上很有用。</p>
<p>先运行一个容器：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% docker container run --rm -t -d ubuntu /bin/bash
</span></span><span class="line"><span class="cl">591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704
</span></span></code></pre></div><ul>
<li><code>--rm</code>: 容器退出后自动删除</li>
<li><code>-t</code>: 为容器分配一个伪终端 pseudo-TTY</li>
<li><code>-d</code>: 以后台模式 detached mode 运行容器</li>
</ul>
<p>docker 检查信息有点冗余</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker container inspect 591db9e9ec10
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        &#34;Id&#34;: &#34;591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704&#34;,
</span></span><span class="line"><span class="cl">        &#34;Created&#34;: &#34;2025-12-11T09:20:40.095487792Z&#34;,
</span></span><span class="line"><span class="cl">        &#34;Path&#34;: &#34;/bin/bash&#34;,
</span></span><span class="line"><span class="cl">        &#34;Args&#34;: [],
</span></span><span class="line"><span class="cl">        &#34;State&#34;: {
</span></span><span class="line"><span class="cl">            &#34;Status&#34;: &#34;running&#34;,
</span></span><span class="line"><span class="cl">            &#34;Running&#34;: true,
</span></span><span class="line"><span class="cl">            &#34;Paused&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;Restarting&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;OOMKilled&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;Dead&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;Pid&#34;: 616,
</span></span><span class="line"><span class="cl">            &#34;ExitCode&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;Error&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;StartedAt&#34;: &#34;2025-12-11T09:20:40.157077708Z&#34;,
</span></span><span class="line"><span class="cl">            &#34;FinishedAt&#34;: &#34;0001-01-01T00:00:00Z&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;Image&#34;: &#34;sha256:9a84ec2d5dd7ad691e3df0d6e7c6e7ebd6ba67fdd1b6172588c009c12359d307&#34;,
</span></span><span class="line"><span class="cl">        &#34;ResolvConfPath&#34;: &#34;/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/resolv.conf&#34;,
</span></span><span class="line"><span class="cl">        &#34;HostnamePath&#34;: &#34;/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/hostname&#34;,
</span></span><span class="line"><span class="cl">        &#34;HostsPath&#34;: &#34;/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/hosts&#34;,
</span></span><span class="line"><span class="cl">        &#34;LogPath&#34;: &#34;/var/lib/docker/containers/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704/591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704-json.log&#34;,
</span></span><span class="line"><span class="cl">        &#34;Name&#34;: &#34;/cool_bose&#34;,
</span></span><span class="line"><span class="cl">        &#34;RestartCount&#34;: 0,
</span></span><span class="line"><span class="cl">        &#34;Driver&#34;: &#34;overlay2&#34;,
</span></span><span class="line"><span class="cl">        &#34;Platform&#34;: &#34;linux&#34;,
</span></span><span class="line"><span class="cl">        &#34;MountLabel&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">        &#34;ProcessLabel&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">        &#34;AppArmorProfile&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">        &#34;ExecIDs&#34;: null,
</span></span><span class="line"><span class="cl">        &#34;HostConfig&#34;: {
</span></span><span class="line"><span class="cl">            &#34;Binds&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;ContainerIDFile&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;LogConfig&#34;: {
</span></span><span class="line"><span class="cl">                &#34;Type&#34;: &#34;json-file&#34;,
</span></span><span class="line"><span class="cl">                &#34;Config&#34;: {}
</span></span><span class="line"><span class="cl">            },
</span></span><span class="line"><span class="cl">            &#34;NetworkMode&#34;: &#34;bridge&#34;,
</span></span><span class="line"><span class="cl">            &#34;PortBindings&#34;: {},
</span></span><span class="line"><span class="cl">            &#34;RestartPolicy&#34;: {
</span></span><span class="line"><span class="cl">                &#34;Name&#34;: &#34;no&#34;,
</span></span><span class="line"><span class="cl">                &#34;MaximumRetryCount&#34;: 0
</span></span><span class="line"><span class="cl">            },
</span></span><span class="line"><span class="cl">            &#34;AutoRemove&#34;: true,
</span></span><span class="line"><span class="cl">            &#34;VolumeDriver&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;VolumesFrom&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;ConsoleSize&#34;: [
</span></span><span class="line"><span class="cl">                35,
</span></span><span class="line"><span class="cl">                124
</span></span><span class="line"><span class="cl">            ],
</span></span><span class="line"><span class="cl">            &#34;CapAdd&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;CapDrop&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;CgroupnsMode&#34;: &#34;private&#34;,
</span></span><span class="line"><span class="cl">            &#34;Dns&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;DnsOptions&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;DnsSearch&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;ExtraHosts&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;GroupAdd&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;IpcMode&#34;: &#34;private&#34;,
</span></span><span class="line"><span class="cl">            &#34;Cgroup&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;Links&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;OomScoreAdj&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;PidMode&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;Privileged&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;PublishAllPorts&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;ReadonlyRootfs&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;SecurityOpt&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;UTSMode&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;UsernsMode&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;ShmSize&#34;: 67108864,
</span></span><span class="line"><span class="cl">            &#34;Runtime&#34;: &#34;runc&#34;,
</span></span><span class="line"><span class="cl">            &#34;Isolation&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;CpuShares&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;Memory&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;NanoCpus&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CgroupParent&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;BlkioWeight&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;BlkioWeightDevice&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;BlkioDeviceReadBps&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;BlkioDeviceWriteBps&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;BlkioDeviceReadIOps&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;BlkioDeviceWriteIOps&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;CpuPeriod&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CpuQuota&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CpuRealtimePeriod&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CpuRealtimeRuntime&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CpusetCpus&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;CpusetMems&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;Devices&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;DeviceCgroupRules&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;DeviceRequests&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;MemoryReservation&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;MemorySwap&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;MemorySwappiness&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;OomKillDisable&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;PidsLimit&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;Ulimits&#34;: [],
</span></span><span class="line"><span class="cl">            &#34;CpuCount&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;CpuPercent&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;IOMaximumIOps&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;IOMaximumBandwidth&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;MaskedPaths&#34;: [
</span></span><span class="line"><span class="cl">                &#34;/proc/asound&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/acpi&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/interrupts&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/kcore&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/keys&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/latency_stats&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/timer_list&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/timer_stats&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/sched_debug&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/scsi&#34;,
</span></span><span class="line"><span class="cl">                &#34;/sys/firmware&#34;,
</span></span><span class="line"><span class="cl">                &#34;/sys/devices/virtual/powercap&#34;
</span></span><span class="line"><span class="cl">            ],
</span></span><span class="line"><span class="cl">            &#34;ReadonlyPaths&#34;: [
</span></span><span class="line"><span class="cl">                &#34;/proc/bus&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/fs&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/irq&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/sys&#34;,
</span></span><span class="line"><span class="cl">                &#34;/proc/sysrq-trigger&#34;
</span></span><span class="line"><span class="cl">            ]
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;GraphDriver&#34;: {
</span></span><span class="line"><span class="cl">            &#34;Data&#34;: {
</span></span><span class="line"><span class="cl">                &#34;ID&#34;: &#34;591db9e9ec1008cc6e5c1a8e64167454386ff3768a8b74c452e8ed545c38e704&#34;,
</span></span><span class="line"><span class="cl">                &#34;LowerDir&#34;: &#34;/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f-init/diff:/var/lib/docker/overlay2/b1a16eb3a83938d4bb52a8279e87a23c919793de6bac7691f7282fa6311c9f62/diff&#34;,
</span></span><span class="line"><span class="cl">                &#34;MergedDir&#34;: &#34;/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/merged&#34;,
</span></span><span class="line"><span class="cl">                &#34;UpperDir&#34;: &#34;/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/diff&#34;,
</span></span><span class="line"><span class="cl">                &#34;WorkDir&#34;: &#34;/var/lib/docker/overlay2/54fe3ed56bbca61cf784634cd23beb85f874788aee7f5404c89ea8057df5a62f/work&#34;
</span></span><span class="line"><span class="cl">            },
</span></span><span class="line"><span class="cl">            &#34;Name&#34;: &#34;overlay2&#34;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;Mounts&#34;: [],
</span></span><span class="line"><span class="cl">        &#34;Config&#34;: {
</span></span><span class="line"><span class="cl">            &#34;Hostname&#34;: &#34;591db9e9ec10&#34;,
</span></span><span class="line"><span class="cl">            &#34;Domainname&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;User&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;AttachStdin&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;AttachStdout&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;AttachStderr&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;Tty&#34;: true,
</span></span><span class="line"><span class="cl">            &#34;OpenStdin&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;StdinOnce&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;Env&#34;: [
</span></span><span class="line"><span class="cl">                &#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;
</span></span><span class="line"><span class="cl">            ],
</span></span><span class="line"><span class="cl">            &#34;Cmd&#34;: [
</span></span><span class="line"><span class="cl">                &#34;/bin/bash&#34;
</span></span><span class="line"><span class="cl">            ],
</span></span><span class="line"><span class="cl">            &#34;Image&#34;: &#34;ubuntu&#34;,
</span></span><span class="line"><span class="cl">            &#34;Volumes&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;WorkingDir&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;Entrypoint&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;OnBuild&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;Labels&#34;: {
</span></span><span class="line"><span class="cl">                &#34;org.opencontainers.image.ref.name&#34;: &#34;ubuntu&#34;,
</span></span><span class="line"><span class="cl">                &#34;org.opencontainers.image.version&#34;: &#34;24.04&#34;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        &#34;NetworkSettings&#34;: {
</span></span><span class="line"><span class="cl">            &#34;Bridge&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;SandboxID&#34;: &#34;079b975620af085dc5d2498a4d63f0db8005ef5d3faeb8e14809d6e27c2dae8b&#34;,
</span></span><span class="line"><span class="cl">            &#34;SandboxKey&#34;: &#34;/var/run/docker/netns/079b975620af&#34;,
</span></span><span class="line"><span class="cl">            &#34;Ports&#34;: {},
</span></span><span class="line"><span class="cl">            &#34;HairpinMode&#34;: false,
</span></span><span class="line"><span class="cl">            &#34;LinkLocalIPv6Address&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">            &#34;LinkLocalIPv6PrefixLen&#34;: 0,
</span></span><span class="line"><span class="cl">            &#34;SecondaryIPAddresses&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;SecondaryIPv6Addresses&#34;: null,
</span></span><span class="line"><span class="cl">            &#34;EndpointID&#34;: &#34;41ced3762ad84154bdd497801be5db07337ca54cac82d183f65349603c7e9a13&#34;,
</span></span><span class="line"><span class="cl">            &#34;Gateway&#34;: &#34;172.17.0.1&#34;,
</span></span><span class="line"><span class="cl">            &#34;GlobalIPv6Address&#34;: &#34;fde6:dc51:edf::2&#34;,
</span></span><span class="line"><span class="cl">            &#34;GlobalIPv6PrefixLen&#34;: 64,
</span></span><span class="line"><span class="cl">            &#34;IPAddress&#34;: &#34;172.17.0.2&#34;,
</span></span><span class="line"><span class="cl">            &#34;IPPrefixLen&#34;: 16,
</span></span><span class="line"><span class="cl">            &#34;IPv6Gateway&#34;: &#34;fde6:dc51:edf::1&#34;,
</span></span><span class="line"><span class="cl">            &#34;MacAddress&#34;: &#34;da:6e:ae:6f:d5:c8&#34;,
</span></span><span class="line"><span class="cl">            &#34;Networks&#34;: {
</span></span><span class="line"><span class="cl">                &#34;bridge&#34;: {
</span></span><span class="line"><span class="cl">                    &#34;IPAMConfig&#34;: null,
</span></span><span class="line"><span class="cl">                    &#34;Links&#34;: null,
</span></span><span class="line"><span class="cl">                    &#34;Aliases&#34;: null,
</span></span><span class="line"><span class="cl">                    &#34;MacAddress&#34;: &#34;da:6e:ae:6f:d5:c8&#34;,
</span></span><span class="line"><span class="cl">                    &#34;DriverOpts&#34;: null,
</span></span><span class="line"><span class="cl">                    &#34;GwPriority&#34;: 0,
</span></span><span class="line"><span class="cl">                    &#34;NetworkID&#34;: &#34;19a3c6274752109c74d9c9eabbb47ac2b4bb1e5b7d670d797b089022cf58caa9&#34;,
</span></span><span class="line"><span class="cl">                    &#34;EndpointID&#34;: &#34;41ced3762ad84154bdd497801be5db07337ca54cac82d183f65349603c7e9a13&#34;,
</span></span><span class="line"><span class="cl">                    &#34;Gateway&#34;: &#34;172.17.0.1&#34;,
</span></span><span class="line"><span class="cl">                    &#34;IPAddress&#34;: &#34;172.17.0.2&#34;,
</span></span><span class="line"><span class="cl">                    &#34;IPPrefixLen&#34;: 16,
</span></span><span class="line"><span class="cl">                    &#34;IPv6Gateway&#34;: &#34;fde6:dc51:edf::1&#34;,
</span></span><span class="line"><span class="cl">                    &#34;GlobalIPv6Address&#34;: &#34;fde6:dc51:edf::2&#34;,
</span></span><span class="line"><span class="cl">                    &#34;GlobalIPv6PrefixLen&#34;: 64,
</span></span><span class="line"><span class="cl">                    &#34;DNSNames&#34;: null
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">]
</span></span></code></pre></div><ul>
<li>长 Id 字符串：完整版本的容器唯一 id，也可以看到容器创建的具体时间，并比 <code>docker container ls</code> 要详细的多</li>
</ul>
<p>还有以下在容器启动时可以配置的内容：</p>
<ul>
<li>top level command</li>
<li>environment</li>
<li>base image</li>
<li>container hostname</li>
</ul>
<p>常见的给容器传递配置的方法是环境变量，因此通过 <code>docker container inspect</code> 能看到大量信息用于调试。</p>
<h3 id="exploring-the-shell">Exploring the shell<a hidden class="anchor" aria-hidden="true" href="#exploring-the-shell">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker container run --rm -it ubuntu:20.04 /bin/bash
</span></span></code></pre></div><p>这条命令会启动进入一个 ubuntu 20.04 版本，并开启 bash shell 作为顶层进程。</p>
<p>查看容器的进程信息如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@d0ba261b2d2c:/# ps -ef
</span></span><span class="line"><span class="cl">UID        PID  PPID  C STIME TTY          TIME CMD
</span></span><span class="line"><span class="cl">root         <span class="m">1</span>     <span class="m">0</span>  <span class="m">0</span> 12:07 pts/0    00:00:00 /bin/bash
</span></span><span class="line"><span class="cl">root         <span class="m">9</span>     <span class="m">1</span>  <span class="m">0</span> 12:09 pts/0    00:00:00 ps -ef
</span></span></code></pre></div><p>也就是说，该容器内只有一个 bash 进程，没有任何其他进程。
这也是如何在容器中运行 shell 的方法，如果要运行其他软件，使用 apt update 和 apt install 来安装运行，但这些内容只会在容器的生命周期存在，这只是在修改容器本身，而不是镜像。</p>
<p>如果直接退出 shell 会自然关闭容器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exit</span>
</span></span></code></pre></div><h3 id="returning-a-result">Returning a result<a hidden class="anchor" aria-hidden="true" href="#returning-a-result">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker container run --rm ubuntu:22.04 /bin/false
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$?</span>
</span></span></code></pre></div><p>1</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker container run --rm ubuntu:22.04 /bin/true
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$?</span>
</span></span></code></pre></div><p>0</p>
<p>上面命令中</p>
<ul>
<li><code>/bin/true</code>: 什么都不做，立即以退出码 0 退出（成功）</li>
<li><code>/bin/false</code>: 什么都不做，立即以退出码 1 结束（失败）</li>
</ul>
<p>它们常用于测试、脚本控制流等</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker container run --rm ubuntu:20.04 /bin/cat /etc/passwd | wc -l
</span></span><span class="line"><span class="cl">      19
</span></span></code></pre></div><p>上面命令是将容器中的 cat 输出，通过管道传递到本地的 wc 命令，而不是容器内的 wc 命令。
管道本身不会传递到容器内，如果想要在容日内使用管道，需要使用 <code>bash -c &quot;&lt;your_command&gt; | &lt;something_else&gt;&quot;</code> 这样的命令。
对应上面命令就是：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">docker container run ubuntu:20.04 /bin/bash -c &#34;/bin/cat /etc/passwd | wc -l&#34;
</span></span></code></pre></div><h3 id="getting-inside-a-running-container">Getting Inside a Running Container<a hidden class="anchor" aria-hidden="true" href="#getting-inside-a-running-container">#</a></h3>
<p>使用 <code>docker container exec</code> 进入一个新的交互式容器的命令，但有一种更加 linux 原生的方式，叫做 <code>nsenter</code>。</p>
<p>下面先创建一个容器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker container run --rm ubuntu:20.04 sleep <span class="m">600</span>
</span></span></code></pre></div><ul>
<li><code>sleep</code> 是一个 Linux 用户态程序，让当前进程休眠指定时间（秒）</li>
</ul>
<p>然后进入容器，命令类似 <code>docker container exec</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker container <span class="nb">exec</span> -it 03eeebc5ca2d /bin/bash
</span></span></code></pre></div><ul>
<li><code>-i</code>: 报持 STDIN 打开</li>
<li><code>-t</code>: 分配一个伪终端 pseudo-TTY</li>
</ul>
<p>进入容器后查看一下进程</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">root@03eeebc5ca2d:/# ps -ef
</span></span><span class="line"><span class="cl">UID        PID  PPID  C STIME TTY          TIME CMD
</span></span><span class="line"><span class="cl">root         1     0  0 02:26 ?        00:00:00 sleep 600
</span></span><span class="line"><span class="cl">root         6     0  0 02:27 pts/0    00:00:00 /bin/bash
</span></span><span class="line"><span class="cl">root        14     6  0 02:28 pts/0    00:00:00 ps -ef
</span></span></code></pre></div><p>也可以使用 <code>docker container exec</code> 在容器中启动额外的后台进程，类似 <code>docker run</code> 命令，使用参数 <code>-d</code> (detached)。
但对于调试之外，应该谨慎使用该机制，因为这会破坏镜像部署的可重复性。
因为其他人必须要知道向 <code>docker container exec</code> 传入哪些命令，才能获取预期的功能。
更好的方式应该是重新构建容器镜像，如果只是需要通知容器内的软件执行某个动作，更加合理的方式是使用 <code>docker container kill -s &lt;SIGNAL&gt;</code>，通过标准的 Unix 信号向容器内的进程传递信息。</p>
<hr>
<p>Docker 支持一个 volume 命令，可用于列出存储在根目录中的所有卷，并可进一步查看他们的详细信息，包括这些卷在服务器上的物理存储位置。</p>
<p>这些 volumes 不是绑定挂载的，相反，他们是用于持久化数据的特殊数据容器。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% docker volume ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DRIVER    VOLUME NAME
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     8ae9318b841d9590eb9bb4325ee8bcd65ad7255e71561189dd4b56965b4cfb43
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     160507e738bcb4d769e42bdad8597b4a2e0e7fe3ed73ccaa56368c9980c8cdcf
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     b6800a72157489e14f94b287b8cee35a7e725ca83afd4ccde866f6942cec83c8
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     deploy_postgres_data_cloud
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     deploy_redis_data_cloud
</span></span><span class="line"><span class="cl"><span class="nb">local</span>     f8c40ca914edbf435c2de5e5d7ae7a382eb0be948b9d2c253c03281c82a9b5d7
</span></span></code></pre></div><p>可以自己创建卷</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker volume create my-data
</span></span></code></pre></div><p>还可以检查数据卷</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% docker volume inspect my-data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;CreatedAt&#34;</span>: <span class="s2">&#34;2025-12-13T03:27:41Z&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Labels&#34;</span>: null,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Mountpoint&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/my-data/_data&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;my-data&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Options&#34;</span>: null,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><p>现在就可以在启动容器的时候使用该该数据卷了</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker container run --rm <span class="se">\
</span></span></span><span class="line"><span class="cl">  --mount <span class="nv">source</span><span class="o">=</span>mydata, <span class="nv">target</span><span class="o">=</span>/app <span class="se">\
</span></span></span><span class="line"><span class="cl">  ubuntu:latest touch /app/my-persistent-data
</span></span></code></pre></div><p>也可以自己删除相关数据卷</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">docker volume rm my-data
</span></span></code></pre></div><h2 id="logging">Logging<a hidden class="anchor" aria-hidden="true" href="#logging">#</a></h2>
<p>Logging 日志是一个在生产环境中至关重要的部分，当出问题的时候，日志是恢复服务的重要工具。
如果你运行在一台主机上，你可能会将日志输出到一个本地的 logfile 文件中。
或者将输出记录在内核缓存 (kernel buffer) 中，然后从 dmesg 读取。
或者像许多使用 systemd 的现代 Linux 发行版那样，期望日志可以通过 journalctl 来查看。</p>
<ul>
<li>journalctl 是 systemd 提供的统一日志查询工具，用于读取 systemd-journald 收集的日志。</li>
</ul>
<p>由于容器的限制和 docker 的构建方式，这些方法在不配置的情况下都不会正常工作。
但没有关系，因为 logging 在 docker 内有一流支持。</p>
<p>Docker 会捕获容器内所有的文本输出，任何 stdout 或 stderr 都会被 Docker daemon 捕获，并将其推送至一个后端日志中。</p>
<h3 id="docker-container-logs">docker container logs<a hidden class="anchor" aria-hidden="true" href="#docker-container-logs">#</a></h3>
<p>docker 内置了 <code>json-file</code> 日志插件，每个容器内应用的日志会被 Docker daemon 流式传输到一个 JSON 文件中。
可以使用 <code>docker container logs</code> 命令查看日志</p>
<p>先拉取一个镜像并创建容器</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">docker container run --rm -d --name nginx-test --rm nginx:latest
</span></span></code></pre></div><p>然后查看日志</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% docker container logs 7bdfc9e334d8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh
</span></span><span class="line"><span class="cl">10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf
</span></span><span class="line"><span class="cl">10-listen-on-ipv6-by-default.sh: info: Enabled listen on IPv6 in /etc/nginx/conf.d/default.conf
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh
</span></span><span class="line"><span class="cl">/docker-entrypoint.sh: Configuration complete; ready for start up
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: using the &#34;epoll&#34; event method
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: nginx/1.29.4
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: built by gcc 14.2.0 (Debian 14.2.0-19)
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: OS: Linux 6.10.14-linuxkit
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker processes
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 29
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 30
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 31
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 32
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 33
</span></span><span class="line"><span class="cl">2025/12/13 06:37:18 [notice] 1#1: start worker process 34
</span></span></code></pre></div><p>这种方式对于小容量的日志十分有用。</p>
<p>要将日志输出限制为较新的内容，可以使用 <code>--since</code> 选项，显示在指定直接后的日志，时间可以使用以下格式：</p>
<ul>
<li>RFC 3339 格式：2020-10-02T10:00:00-05:00</li>
<li>Unix 时间戳：1450071961</li>
<li>标准日期格式：20220731</li>
<li>Go 时间段字符串：5m45s</li>
</ul>
<p>还可以使用 <code>--tail</code> 选项显示指定的若干行</p>
<p>实际的日志存储地址默认在 <code>/var/lib/docker/containers/&lt;container_id&gt;</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ sudo ls /var/lib/docker/containers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad
</span></span><span class="line"><span class="cl">17518b5d83f8b9dec547373a65f8505d76204b1c7e73cbb70accb20b14b99e3a
</span></span><span class="line"><span class="cl">197ad199c73e6b0d118cfcf2c12e66df1f969920d730f0ae147f89687c1e0361
</span></span><span class="line"><span class="cl">8e333a8c7241c332dd65751b0bbc1a0c8e93b9f1d44c1f307ce5b1a16dcc867a
</span></span><span class="line"><span class="cl">f471f0bc60bdaf943f41c9c97255262d843e760676c7fa4b78d5a27b500013c6
</span></span><span class="line"><span class="cl">fb6fdf34f33213953eba036a48089b08b9513e027fafb6f410e1433e87679487
</span></span></code></pre></div><p>上面列出的是每个容器的目录，若要查询日志，需要查看目录下面的 <code>&lt;container_id&gt;-json.log</code> 文件</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ sudo tail -3 /var/lib/docker/containers/13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad/13470e5fef4b71232d1cb18e342cab1884ba36dd42661772cea321737f27f2ad-json.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;log&#34;:&#34;2025-12-13 05:54:51.691 UTC [27] LOG:  checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.503 s, sync=0.078 s, total=0.765 s; sync files=6, longest=0.055 s, average=0.013 s; distance=19 kB, estimate=22 kB; lsn=0/1B96448, redo lsn=0/1B96410\n&#34;,&#34;stream&#34;:&#34;stderr&#34;,&#34;time&#34;:&#34;2025-12-13T05:54:51.69140269Z&#34;}
</span></span><span class="line"><span class="cl">{&#34;log&#34;:&#34;2025-12-13 06:09:50.890 UTC [27] LOG:  checkpoint starting: time\n&#34;,&#34;stream&#34;:&#34;stderr&#34;,&#34;time&#34;:&#34;2025-12-13T06:09:50.890460875Z&#34;}
</span></span><span class="line"><span class="cl">{&#34;log&#34;:&#34;2025-12-13 06:09:51.669 UTC [27] LOG:  checkpoint complete: wrote 6 buffers (0.0%); 0 WAL file(s) added, 0 removed, 0 recycled; write=0.505 s, sync=0.126 s, total=0.780 s; sync files=6, longest=0.103 s, average=0.021 s; distance=20 kB, estimate=22 kB; lsn=0/1B9B4E0, redo lsn=0/1B9B4A8\n&#34;,&#34;stream&#34;:&#34;stderr&#34;,&#34;time&#34;:&#34;2025-12-13T06:09:51.66995443Z&#34;}
</span></span></code></pre></div><p>使用参数 <code>-f</code> 可以进入交互式环境，持续查看最近的日志信息</p>
<pre tabindex="0"><code>docker container logs -f nginx-test
</code></pre><p>对于单一主机的日志而言，这种方法很不错。
其不足之处在于日志轮转、轮转后远程访问日志以及高流量日志记录时的磁盘空间占用问题。
如果你有更加复制的环境，你将需要更加鲁棒和中心化的日志功能。</p>
<p>Docker daemon 守护进程的默认配置并不会启用日志轮转。
因此，如果在生成环境中运行容器，务必通过命令行参数或 <code>daemon.json</code> 配置文件显示指定 <code>--log-opt max-size</code> 和 <code>--log-opt max-file</code> 这两个选项。</p>
<p>其中，<code>max-size</code> 用于限定单个日志文件在触发轮转之前所允许的最大大小，而 <code>max-file</code> 用于限定日志轮转后最多保留的日志文件数量。
要注意的是，单独配置 <code>max-file</code> 并不会生效，因为 Docker 只有在知道合适需要进行日志轮转的情况下，才会创建多个日志文件。
当日志轮转启用后，<code>docker container logs</code> 只会返回当前正在写入的日志文件中的数据，而不会读取已经归档的旧日志文件。</p>
<h3 id="more-advanced-logging">More Advanced Logging<a hidden class="anchor" aria-hidden="true" href="#more-advanced-logging">#</a></h3>
<p>当默认的机制不够用的时候，尤其是在大规模场景下，Docker 还支持可配置的日志后端。
这些日志后端的插件列表在不断增长，除了前面提到的 json-file，还有 syslog、fluentd、journald、gelf、awslgos、splunk、gcplogs、local、logentries 等，这些后端用于把容器日志发送到各种主流的日志框架和日志服务中。
可以使用命令参数 <code>--log-driver=syslog</code> 来指定后端。</p>
<blockquote>
<p>TIPS</p>
</blockquote>
<p>在 docker compose 里面可以这样配置</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># PostgreSQL 数据库</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">postgres</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:16-alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">postgres_db</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">logging</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;json-file&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">options</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max-size</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;10m&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max-file</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;10&#34;</span><span class="w">
</span></span></span></code></pre></div><p>这样表示使用 <code>json-file</code> 作为后端，单个容器日志文件最多 10 个，每个最大 10 MiB。</p>
<p>如果使用 <code>daemon.json</code> 配置，其一般位于 <code>/etc/docker</code> 下面，如果使用 docker desktop 则可以使用图像界面去修改配置。</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/docker/">Docker</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/python-tricks-part-1-basis/">
    <span class="title">« Prev</span>
    <br>
    <span>Python Tricks Part 1: Basis</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/git-cherry-pick/">
    <span class="title">Next »</span>
    <br>
    <span>Git cherry-pick</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on x"
            href="https://x.com/intent/tweet/?text=Exploring%20Docker&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f&amp;hashtags=Docker">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f&amp;title=Exploring%20Docker&amp;summary=Exploring%20Docker&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f&title=Exploring%20Docker">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on whatsapp"
            href="https://api.whatsapp.com/send?text=Exploring%20Docker%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on telegram"
            href="https://telegram.me/share/url?text=Exploring%20Docker&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Exploring Docker on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Exploring%20Docker&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fexploring-docker%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Starslayerx&#39; Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
