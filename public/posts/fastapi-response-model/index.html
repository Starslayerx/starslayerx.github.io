<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>FastAPI Response Model | Starslayerx&#39; Blog</title>
<meta name="keywords" content="FastAPI">
<meta name="description" content="本篇文章介绍 FastAPI 的返回类型 response model
可以在返回函数的类型注解中声明该接口的响应数据类型
类型注解的用法和输入数据参数一样, 可以使用:

Pydantic 模型
list 列表
dict 字典
scalar 标量值 (int, bool &hellip;)

@app.post(&#34;/items/&#34;)
async def create_item(item: Item) -&gt; Item:
    ...

@app.get(&#34;/items/&#34;)
async def read_items() -&gt; list[Item]:
    ...
FastAPI 会使用返回类型完成一下事情:


验证返回类型
如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端


在 OpenAPI 中为响应添加 JSON Schema
用于自动生成接口文档, 自动生成客户端代码


最重要的是
它会限制并过滤出数据, 只保留返回类型中定义的字段


response_model Parameter
有时候可能需要返回的数据和类型注解不完全一致, 例如:

可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型
这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象

如果直接用返回类型注解, 编辑器会提示类型不匹配的错误
这种情况下, 可以用路径装饰器的 response_model 参数来声明响应类型, 而不是用返回类型注解
class Item(BaseModel):
    name: str
    description: str | None = None
    price: float
    tax: float | None = None
    tags: list[str] = []

@app.post(&#34;/items/&#34;, response_model=Item)
async def create_item(item: Item) -&gt; Any:
    return item

@app.get(&#34;/items/&#34;, response_model=list[Item])
async def read_items() -&gt; Any:
    return [
        {&#34;name&#34;: &#34;Portal Gun&#34;, &#34;price&#34;: 42.0},
        {&#34;name&#34;: &#34;Plumbus&#34;, &#34;price&#34;: 32.0},
    ]
注意:">
<meta name="author" content="Starslayerx">
<link rel="canonical" href="http://localhost:1313/posts/fastapi-response-model/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.svg">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.svg">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon.svg">
<link rel="apple-touch-icon" href="http://localhost:1313/favicon.svg">
<link rel="mask-icon" href="http://localhost:1313/favicon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/fastapi-response-model/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/posts/fastapi-response-model/">
  <meta property="og:site_name" content="Starslayerx&#39; Blog">
  <meta property="og:title" content="FastAPI Response Model">
  <meta property="og:description" content="本篇文章介绍 FastAPI 的返回类型 response model
可以在返回函数的类型注解中声明该接口的响应数据类型
类型注解的用法和输入数据参数一样, 可以使用:
Pydantic 模型 list 列表 dict 字典 scalar 标量值 (int, bool …) @app.post(&#34;/items/&#34;) async def create_item(item: Item) -&gt; Item: ... @app.get(&#34;/items/&#34;) async def read_items() -&gt; list[Item]: ... FastAPI 会使用返回类型完成一下事情:
验证返回类型 如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端
在 OpenAPI 中为响应添加 JSON Schema 用于自动生成接口文档, 自动生成客户端代码
最重要的是 它会限制并过滤出数据, 只保留返回类型中定义的字段
response_model Parameter 有时候可能需要返回的数据和类型注解不完全一致, 例如:
可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型 这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象 如果直接用返回类型注解, 编辑器会提示类型不匹配的错误
这种情况下, 可以用路径装饰器的 response_model 参数来声明响应类型, 而不是用返回类型注解
class Item(BaseModel): name: str description: str | None = None price: float tax: float | None = None tags: list[str] = [] @app.post(&#34;/items/&#34;, response_model=Item) async def create_item(item: Item) -&gt; Any: return item @app.get(&#34;/items/&#34;, response_model=list[Item]) async def read_items() -&gt; Any: return [ {&#34;name&#34;: &#34;Portal Gun&#34;, &#34;price&#34;: 42.0}, {&#34;name&#34;: &#34;Plumbus&#34;, &#34;price&#34;: 32.0}, ] 注意:">
  <meta property="og:locale" content="en-US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-12T08:00:00+08:00">
    <meta property="article:modified_time" content="2025-08-12T08:00:00+08:00">
    <meta property="article:tag" content="FastAPI">
      <meta property="og:image" content="http://localhost:1313/images/og-default.avif">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/images/og-default.avif">
<meta name="twitter:title" content="FastAPI Response Model">
<meta name="twitter:description" content="本篇文章介绍 FastAPI 的返回类型 response model
可以在返回函数的类型注解中声明该接口的响应数据类型
类型注解的用法和输入数据参数一样, 可以使用:

Pydantic 模型
list 列表
dict 字典
scalar 标量值 (int, bool &hellip;)

@app.post(&#34;/items/&#34;)
async def create_item(item: Item) -&gt; Item:
    ...

@app.get(&#34;/items/&#34;)
async def read_items() -&gt; list[Item]:
    ...
FastAPI 会使用返回类型完成一下事情:


验证返回类型
如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端


在 OpenAPI 中为响应添加 JSON Schema
用于自动生成接口文档, 自动生成客户端代码


最重要的是
它会限制并过滤出数据, 只保留返回类型中定义的字段


response_model Parameter
有时候可能需要返回的数据和类型注解不完全一致, 例如:

可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型
这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象

如果直接用返回类型注解, 编辑器会提示类型不匹配的错误
这种情况下, 可以用路径装饰器的 response_model 参数来声明响应类型, 而不是用返回类型注解
class Item(BaseModel):
    name: str
    description: str | None = None
    price: float
    tax: float | None = None
    tags: list[str] = []

@app.post(&#34;/items/&#34;, response_model=Item)
async def create_item(item: Item) -&gt; Any:
    return item

@app.get(&#34;/items/&#34;, response_model=list[Item])
async def read_items() -&gt; Any:
    return [
        {&#34;name&#34;: &#34;Portal Gun&#34;, &#34;price&#34;: 42.0},
        {&#34;name&#34;: &#34;Plumbus&#34;, &#34;price&#34;: 32.0},
    ]
注意:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "FastAPI Response Model",
      "item": "http://localhost:1313/posts/fastapi-response-model/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "FastAPI Response Model",
  "name": "FastAPI Response Model",
  "description": "本篇文章介绍 FastAPI 的返回类型 response model\n可以在返回函数的类型注解中声明该接口的响应数据类型\n类型注解的用法和输入数据参数一样, 可以使用:\nPydantic 模型 list 列表 dict 字典 scalar 标量值 (int, bool \u0026hellip;) @app.post(\u0026#34;/items/\u0026#34;) async def create_item(item: Item) -\u0026gt; Item: ... @app.get(\u0026#34;/items/\u0026#34;) async def read_items() -\u0026gt; list[Item]: ... FastAPI 会使用返回类型完成一下事情:\n验证返回类型 如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端\n在 OpenAPI 中为响应添加 JSON Schema 用于自动生成接口文档, 自动生成客户端代码\n最重要的是 它会限制并过滤出数据, 只保留返回类型中定义的字段\nresponse_model Parameter 有时候可能需要返回的数据和类型注解不完全一致, 例如:\n可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型 这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象 如果直接用返回类型注解, 编辑器会提示类型不匹配的错误\n这种情况下, 可以用路径装饰器的 response_model 参数来声明响应类型, 而不是用返回类型注解\nclass Item(BaseModel): name: str description: str | None = None price: float tax: float | None = None tags: list[str] = [] @app.post(\u0026#34;/items/\u0026#34;, response_model=Item) async def create_item(item: Item) -\u0026gt; Any: return item @app.get(\u0026#34;/items/\u0026#34;, response_model=list[Item]) async def read_items() -\u0026gt; Any: return [ {\u0026#34;name\u0026#34;: \u0026#34;Portal Gun\u0026#34;, \u0026#34;price\u0026#34;: 42.0}, {\u0026#34;name\u0026#34;: \u0026#34;Plumbus\u0026#34;, \u0026#34;price\u0026#34;: 32.0}, ] 注意:\n",
  "keywords": [
    "FastAPI"
  ],
  "articleBody": "本篇文章介绍 FastAPI 的返回类型 response model\n可以在返回函数的类型注解中声明该接口的响应数据类型\n类型注解的用法和输入数据参数一样, 可以使用:\nPydantic 模型 list 列表 dict 字典 scalar 标量值 (int, bool …) @app.post(\"/items/\") async def create_item(item: Item) -\u003e Item: ... @app.get(\"/items/\") async def read_items() -\u003e list[Item]: ... FastAPI 会使用返回类型完成一下事情:\n验证返回类型 如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端\n在 OpenAPI 中为响应添加 JSON Schema 用于自动生成接口文档, 自动生成客户端代码\n最重要的是 它会限制并过滤出数据, 只保留返回类型中定义的字段\nresponse_model Parameter 有时候可能需要返回的数据和类型注解不完全一致, 例如:\n可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型 这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象 如果直接用返回类型注解, 编辑器会提示类型不匹配的错误\n这种情况下, 可以用路径装饰器的 response_model 参数来声明响应类型, 而不是用返回类型注解\nclass Item(BaseModel): name: str description: str | None = None price: float tax: float | None = None tags: list[str] = [] @app.post(\"/items/\", response_model=Item) async def create_item(item: Item) -\u003e Any: return item @app.get(\"/items/\", response_model=list[Item]) async def read_items() -\u003e Any: return [ {\"name\": \"Portal Gun\", \"price\": 42.0}, {\"name\": \"Plumbus\", \"price\": 32.0}, ] 注意:\nresponse_model 是装饰器(get、post 等方法)的参数, 不是函数的参数 接收的类型和 Pydantic 字段定义一样, 可以是单个模型, 也可以是模型列表等 FastAPI 用其做数据库验证、文档生成、以及过滤输出数据 如果使用 mypy 之类做 static type check, 可以声明函数返回类型为 Any\nresponse_model 优先级 如果同时声明了 response_model 和返回类型, 则 response_model 会优先生效\n如果想要禁用响应模型, 可以设置 response_model=None (用于一些非 Pydantic 类型的返回值) Return the Same Input Data 返回相同数据数据 很多情况下, 希望模型返回与输入模型相同的数据\n这式, 可以在路径函数中直接声明 response_model=YourModel, FastAPI 会自动处理\nfrom fastapi import FastAPI from pydantic import BaseModel, EmailStr app = FastAPI() class UserIn(BaseModel): username: str password: str email: EmailStr full_name: str | None = None # Don't do this in production! @app.post(\"/user/\") async def create_user(user: UserIn) -\u003e UserIn: return user 不要在生产环境中以明文形式存储用户密码, 也不要像这样直接返回密码\nAdd an Output Model 添加输出模型 我们可以改成: 输入模型包含明文密码, 输出模型不含\nfrom typing import Any from fastapi import FastAPI from pydantic import BaseModel, EmailStr app = FastAPI() # Input model class UserIn(BaseModel): username: str password: str email: EmailStr full_name: str | None = None # Output model class UserOut(BaseModel): username: str email: EmailStr full_name: str | None = None @app.post(\"/user/\", response_model=UserOut) # output async def create_user(user: UserIn) -\u003e Any: return user # like input 这样, 即使路径操作函数返回的对象中包含该字段, FastAPI 也会按照 response_model=UserOut 来过滤密码\nReturn Type and Data Filtering 返回类型与数据过滤 延续上面的例子, 希望函数的类型注解和实际返回值不同:\n函数返回的对象可能包含更多数据, 但响应中只保留输出模型声明的字段\n之前由于类不同, 只能用 response_model, 这样就失去了编辑器和类型检查对返回值的检查\n大多数情况下, 我们只是想去掉或过滤掉部分数据, 这时可以用 类继承(classes and inheritance) 来兼顾类型注解和数据过滤\nclass BaseUser(BaseModel): username: str email: EmailStr full_name: str | None = None class UserIn(BaseUser): password: str @app.post(\"/user/\") async def create_user(user: UserIn) -\u003e BaseUser: return user 通过这种方式:\nType Annotations and Testing 编辑器和类型检查工具支持: UserIn 是 BaseUser 的子类, 返回 UserIn 实例完全符合 BaseUser 类型要求 FastAPI Data Filtering 数据过滤: 响应中会自动去掉 password 字段, 只保留 BaseUser 中声明的字段 Other Return Type Annotations 其他类型注解 有些时候, 返回的内容不是有效的 Pydantic 字段, 但在函数中添加了注解, 为了获取工具支持\nReturn a response directly 直接返回响应 最常见的就是直接返回一个 Resposne\nfrom fastapi import FastAPI, Response from fastapi.resposnes import JSONResponse, RedirectResponse app = FastAPI() @app.get(\"/portal\") async def get_protal(teleport: bool = False) -\u003e Response: if teleport: return RedirectResponse(url=\"https://www.youtube.com/watch?v=dQw4w9WgXcQ\") return JSONResponse(content={\"message\": \"Here's your interdimensional portal.\"}) 这种简单情况由 FastAPI 自动处理, 因为返回类型注解是 Response 类\n开发工具也能正常工作, 因为 RedirectResponse 和 JSONResponse 都是 Response 的子类, 所以类型注解是正确的\nInvalid return type annotations 无效的类型注解 但是, 当返回一些其他任意对象(不是有效的 Pydantic 类型, 例如数据库对象)并在函数中这样注解时, FastAPI 会尝试从该类型注解创建一个 Pydantic 响应模型, 然后会失败\n如果使用了联合模型, 其中有一个或多个不是有效的 Pydantic 类型, 同样会失败\nfrom fastapi import FastAPI, Response from fastapi.responses import RedirectResponse app = FastAPI() @app.get(\"/portal\") async def get_portal(teleport: bool = False) -\u003e Response | dict: if teleport: return RedirectResponse(url=\"https://www.youtube.com/watch?v=dQw4w9WgXcQ\") return {\"message\": \"Here's your interdimensional portal.\"} 这会失败是因为类型注解不是单一的 Pydantic 类型, 也不是单一的 Response 类或子类, 而是 Response 和 dict 之间的联合类型\nDisable response Model 禁用响应类型 如果不希望 FastAPI 执行默认的数据验证、文档生成、过滤等操作, 但是又想在函数中保留返回类型注解, 以获得编辑器和类型检查工具的支持, 这种情况下设置 response_model=None 来禁用响应生成\nfrom fastapi import FastAPI, Response from fastapi.response import RedirectResponse app = FastAPI() @app.get(\"/portal\", response_model=None) async def get_protal(teleport: bool = False) -\u003e Response | dict: if teleport: return RedirectResponse(url=\"https://www.youtube.com/watch?v=dQw4w9WgXcQ\") return JSONResponse(content={\"message\": \"Here's your interdimensional portal.\"}) Response Model Encoding Parameters 响应模型编码参数 响应模型可能有默认值\nclass Item(BaseModel): name: str description: str | None = None price: float tax: float = 10.5 tags: list[str] = [] 例如, 在 NoSQL 数据库中哟许多可选属性的模型, 但不想发送默认值的很长的 JSON 响应\n可以使用 path operation operator 的 response_model_exclude_mode 参数来去除默认值\n@app.get(\"/items/{item_id}\", response_model=Item, response_model_exclude_unset=True) async def read_item(item_id: str): return items[item_id] description: str | None = None 默认值为 None tax: float = 10.5 的默认值为 10.5 tags: List[str] = [] 的默认值是空列表 [] 此时, 如果向该路径发送 ID 为 foo 的项目请求\n\"foo\": { \"name\": \"Foo\", \"price\": 50.2 } 响应将是\n{ \"name\": \"foo\", \"price\": 50.2 } response_model_include 和 response_model_exclude 也可以使用 path operation parameter 中的 response_model_include 和 response_model_exclude, 他们接受一个包含属性名称字符串的 set, 用于包含(省略其余部分)或排除(包含其余部分)\nfrom fastapi import FastAPI from pydantic import BaseModel app = FastAPI() class Item(BaseModel): name: str description: str | None = None price: float tax: float = 10.5 items = { \"foo\": {\"name\": \"Foo\", \"price\": 50.2}, \"bar\": {\"name\": \"Bar\", \"description\": \"The Bar fighters\", \"price\": 62, \"tax\": 20.2}, \"baz\": { \"name\": \"Baz\", \"description\": \"There goes my baz\", \"price\": 50.2, \"tax\": 10.5, }, } @app.get( \"/items/{item_id}/name\", response_model=Item, response_model_include={\"name\", \"description\"}, # 包含 ) async def read_item_name(item_id: str): return items[item_id] @app.get( \"/items/{item_id}/public\", response_model=Item, response_model_exclude={\"tax\"}, # 排除 ) async def read_item_public_data(item_id: str): return items[item_id] 虽然可以通过上述方法自定义返回参数包含哪些, 但还是建议使用多个类来实现该功能, 而不这些参数\n这是因为, 即使使用 response_model_include 或 response_model_exclude 来省略某些属性, 在应用程序的 OpenAPI 中生成的 JSON Schema 仍将是完整模型的 Schema\n这对于 response_model_by_alias 也是一样的\nUsing list instead of sets 如果忘记使用集和而使用元组或列表, FastAPI 仍会将其转换为集和, 确保正常工作\n@app.get( \"/items/{item_id}/name\", response_model=Item, response_model_include=[\"name\", \"description\"], # 使用列表 ) async def read_item_name(item_id: str): return items[item_id] @app.get( \"/items/{item_id}/public\", response_model=Item, response_model_exclude=[\"tax\"], # 使用列表 ) async def read_item_public_data(item_id: str): return items[item_id] Response Status Code 响应状态码 就像可以指定响应模型一样, 也可以在任何路径操作中使用 status_code 参数声明用于响应:\n@app.get() @app.post() @app.put() @app.delete() from fastapi import FastAPI app = FastAPI() @app.post(\"/items/\", status_code=201) async def create_item(name: str): return {\"name\": name} status_code 是\"装饰器\"方法的一个参数, 而不是你的路径操作函数 path operation function 的参数\nstatus_code 参数接收一个表示 HTTP 状态码的数字, 也可以接收一个 IntEnum, 比如 Python 中的 http.HTTPStatus\n将在响应中返回该状态码 并在 OpenAPI 模式中也如此记录 About HTTP status codes 在 HTTP 协议中, 会在响应中发送一个3位数的数字状态码\n这些状态码又一个相关联的名称便于识别, 但重要的是数字本身\n100~199: 用于\"信息\", 很少会直接使用它们, 这些状态码的响应不能有响应体 200~299: 用于\"成功\"的响应, 这些是最常用的 200 的默认的\"成功\"响应, 表示一切 OK 201 表示已创建, 通常在数据库中创建新记录后使用 204 表示无内容, 当没有内容返回给客户端时使用此响应, 因此不能有响应体 300~399: 用于\"重定向\", 这些状态码的响应可能有也可能没有响应体. 但 304 (未修改) 除外, 它必须没有响应体 400~499: 用于\"客户端错误\"响应, 404 用于\"未找到\"的响应 400 客户端通用错误 500~599: 用于服务器错误, 几乎从不直接使用它们. 当的应用代码或服务器的某个部分出错时, 它会自动返回这些状态码之一 要了解更多关于每个状态码的信息以及哪个代码用于什么目的，请查阅 MDN 关于 HTTP 状态码的文档\nShortcut to remember the names 除了直接使用数字外, 还可以使用 fastapi.status 中的便捷变量\nfrom fastapi import FastAPI, status app = FastAPI() @app.post(\"/items/\", status_code=status.HTTP_201_CREATED) async def create_item(name: str): return {\"name\": name} 这只是一直便利, 都是一样的树枝, 但这样可以使用编辑器的自动补全功能\n也可以使用 from starlette import status\n",
  "wordCount" : "918",
  "inLanguage": "en",
  "image": "http://localhost:1313/images/og-default.avif","datePublished": "2025-08-12T08:00:00+08:00",
  "dateModified": "2025-08-12T08:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Starslayerx"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/fastapi-response-model/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Starslayerx' Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.svg"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Starslayerx&#39; Blog (Alt + H)">
                <img src="http://localhost:1313/favicon.svg" alt="" aria-label="logo"
                    height="35">Starslayerx&#39; Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="http://localhost:1313/zh-cn/" title="简体中文"
                                aria-label="简体中文">Zh-Cn</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      FastAPI Response Model
    </h1>
    <div class="post-meta"><span title='2025-08-12 08:00:00 +0800 CST'>August 12, 2025</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>918 words</span>&nbsp;·&nbsp;<span>Starslayerx</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#response_model-parameter"><code>response_model</code> Parameter</a></li>
        <li><a href="#return-the-same-input-data-返回相同数据数据">Return the Same Input Data 返回相同数据数据</a></li>
        <li><a href="#add-an-output-model-添加输出模型">Add an Output Model 添加输出模型</a></li>
        <li><a href="#return-type-and-data-filtering-返回类型与数据过滤">Return Type and Data Filtering 返回类型与数据过滤</a></li>
        <li><a href="#other-return-type-annotations-其他类型注解">Other Return Type Annotations 其他类型注解</a>
          <ul>
            <li><a href="#return-a-response-directly-直接返回响应">Return a response directly 直接返回响应</a></li>
            <li><a href="#invalid-return-type-annotations-无效的类型注解">Invalid return type annotations 无效的类型注解</a></li>
            <li><a href="#disable-response-model-禁用响应类型">Disable response Model 禁用响应类型</a></li>
          </ul>
        </li>
        <li><a href="#response-model-encoding-parameters-响应模型编码参数">Response Model Encoding Parameters 响应模型编码参数</a>
          <ul>
            <li><a href="#using-list-instead-of-sets">Using <code>list</code> instead of <code>set</code>s</a></li>
          </ul>
        </li>
        <li><a href="#response-status-code-响应状态码">Response Status Code 响应状态码</a>
          <ul>
            <li><a href="#about-http-status-codes">About HTTP status codes</a></li>
            <li><a href="#shortcut-to-remember-the-names">Shortcut to remember the names</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>本篇文章介绍 FastAPI 的返回类型 response model</p>
<p>可以在返回函数的类型注解中声明该接口的响应数据类型</p>
<p>类型注解的用法和输入数据参数一样, 可以使用:</p>
<ul>
<li>Pydantic 模型</li>
<li>list 列表</li>
<li>dict 字典</li>
<li>scalar 标量值 (int, bool &hellip;)</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Item</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_items</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Item</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></div><p>FastAPI 会使用返回类型完成一下事情:</p>
<ul>
<li>
<p>验证返回类型
如果返回的数据无效, 说明业务代码有问题, FastAPI 会返回服务器错误, 而不是把数据发给客户端</p>
</li>
<li>
<p>在 OpenAPI 中为响应添加 JSON Schema
用于自动生成接口文档, 自动生成客户端代码</p>
</li>
<li>
<p>最重要的是
它会限制并过滤出数据, 只保留返回类型中定义的字段</p>
</li>
</ul>
<h3 id="response_model-parameter"><code>response_model</code> Parameter<a hidden class="anchor" aria-hidden="true" href="#response_model-parameter">#</a></h3>
<p>有时候可能需要返回的数据和类型注解不完全一致, 例如:</p>
<ul>
<li>可能想返回字典或数据库对象, 但声明的响应类型为 Pydantic 模型</li>
<li>这样 Pydantic 会做数据文档、验证等工作, 即使返回的是字典或 ORM 对象</li>
</ul>
<p>如果直接用返回类型注解, 编辑器会提示类型不匹配的错误</p>
<p>这种情况下, 可以用路径装饰器的 <code>response_model</code> 参数来声明响应类型, 而不是用返回类型注解</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span><span class="p">:</span> <span class="nb">float</span>
</span></span><span class="line"><span class="cl">    <span class="n">tax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">item</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="nb">list</span><span class="p">[</span><span class="n">Item</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_items</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Portal Gun&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">:</span> <span class="mf">42.0</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Plumbus&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">:</span> <span class="mf">32.0</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span></code></pre></div><p>注意:</p>
<ul>
<li><code>response_model</code> 是装饰器(<code>get</code>、<code>post</code> 等方法)的参数, 不是函数的参数</li>
<li>接收的类型和 Pydantic 字段定义一样, 可以是单个模型, 也可以是模型列表等</li>
<li>FastAPI 用其做数据库验证、文档生成、以及过滤输出数据</li>
</ul>
<blockquote>
<p>如果使用 mypy 之类做 static type check, 可以声明函数返回类型为 <code>Any</code></p>
</blockquote>
<ul>
<li><code>response_model</code> 优先级
如果同时声明了 <code>response_model</code> 和返回类型, 则 <code>response_model</code> 会优先生效<br>
如果想要禁用响应模型, 可以设置 <code>response_model=None</code> (用于一些非 Pydantic 类型的返回值)</li>
</ul>
<h3 id="return-the-same-input-data-返回相同数据数据">Return the Same Input Data 返回相同数据数据<a hidden class="anchor" aria-hidden="true" href="#return-the-same-input-data-返回相同数据数据">#</a></h3>
<p>很多情况下, 希望模型返回与输入模型相同的数据</p>
<p>这式, 可以在路径函数中直接声明 <code>response_model=YourModel</code>, FastAPI 会自动处理</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserIn</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span><span class="p">:</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Don&#39;t do this in production!</span>
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/user/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="n">user</span><span class="p">:</span> <span class="n">UserIn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UserIn</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">user</span>
</span></span></code></pre></div><blockquote>
<p>不要在生产环境中以明文形式存储用户密码, 也不要像这样直接返回密码</p>
</blockquote>
<h3 id="add-an-output-model-添加输出模型">Add an Output Model 添加输出模型<a hidden class="anchor" aria-hidden="true" href="#add-an-output-model-添加输出模型">#</a></h3>
<p>我们可以改成: 输入模型包含明文密码, 输出模型不含</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Input model</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserIn</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span><span class="p">:</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Output model</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserOut</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span><span class="p">:</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/user/&#34;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">UserOut</span><span class="p">)</span> <span class="c1"># output</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="n">user</span><span class="p">:</span> <span class="n">UserIn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">user</span> <span class="c1"># like input</span>
</span></span></code></pre></div><p>这样, 即使路径操作函数返回的对象中包含该字段, FastAPI 也会按照 <code>response_model=UserOut</code> 来过滤密码</p>
<h3 id="return-type-and-data-filtering-返回类型与数据过滤">Return Type and Data Filtering 返回类型与数据过滤<a hidden class="anchor" aria-hidden="true" href="#return-type-and-data-filtering-返回类型与数据过滤">#</a></h3>
<p>延续上面的例子, 希望函数的类型注解和实际返回值不同:</p>
<p>函数返回的对象可能包含更多数据, 但响应中只保留输出模型声明的字段</p>
<p>之前由于类不同, 只能用 <code>response_model</code>, 这样就失去了编辑器和类型检查对返回值的检查</p>
<p>大多数情况下, 我们只是想去掉或过滤掉部分数据, 这时可以用 类继承(classes and inheritance) 来兼顾类型注解和数据过滤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">BaseUser</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">email</span><span class="p">:</span> <span class="n">EmailStr</span>
</span></span><span class="line"><span class="cl">    <span class="n">full_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UserIn</span><span class="p">(</span><span class="n">BaseUser</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/user/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="n">user</span><span class="p">:</span> <span class="n">UserIn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseUser</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">user</span>
</span></span></code></pre></div><p>通过这种方式:</p>
<ol>
<li>Type Annotations and Testing 编辑器和类型检查工具支持: <code>UserIn</code> 是 <code>BaseUser</code> 的子类, 返回 <code>UserIn</code> 实例完全符合 <code>BaseUser</code> 类型要求</li>
<li>FastAPI Data Filtering 数据过滤: 响应中会自动去掉 <code>password</code> 字段, 只保留 <code>BaseUser</code> 中声明的字段</li>
</ol>
<h3 id="other-return-type-annotations-其他类型注解">Other Return Type Annotations 其他类型注解<a hidden class="anchor" aria-hidden="true" href="#other-return-type-annotations-其他类型注解">#</a></h3>
<p>有些时候, 返回的内容不是有效的 Pydantic 字段, 但在函数中添加了注解, 为了获取工具支持</p>
<h4 id="return-a-response-directly-直接返回响应">Return a response directly 直接返回响应<a hidden class="anchor" aria-hidden="true" href="#return-a-response-directly-直接返回响应">#</a></h4>
<p>最常见的就是直接返回一个 Resposne</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi.resposnes</span> <span class="kn">import</span> <span class="n">JSONResponse</span><span class="p">,</span> <span class="n">RedirectResponse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/portal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_protal</span><span class="p">(</span><span class="n">teleport</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">teleport</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">RedirectResponse</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://www.youtube.com/watch?v=dQw4w9WgXcQ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Here&#39;s your interdimensional portal.&#34;</span><span class="p">})</span>
</span></span></code></pre></div><p>这种简单情况由 FastAPI 自动处理, 因为返回类型注解是 Response 类</p>
<p>开发工具也能正常工作, 因为 <code>RedirectResponse</code> 和 <code>JSONResponse</code> 都是 <code>Response</code> 的子类, 所以类型注解是正确的</p>
<h4 id="invalid-return-type-annotations-无效的类型注解">Invalid return type annotations 无效的类型注解<a hidden class="anchor" aria-hidden="true" href="#invalid-return-type-annotations-无效的类型注解">#</a></h4>
<p>但是, 当返回一些其他任意对象(不是有效的 Pydantic 类型, 例如数据库对象)并在函数中这样注解时, FastAPI 会尝试从该类型注解创建一个 Pydantic 响应模型, 然后会失败</p>
<p>如果使用了联合模型, 其中有一个或多个不是有效的 Pydantic 类型, 同样会失败</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi.responses</span> <span class="kn">import</span> <span class="n">RedirectResponse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/portal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_portal</span><span class="p">(</span><span class="n">teleport</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">teleport</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">RedirectResponse</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://www.youtube.com/watch?v=dQw4w9WgXcQ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Here&#39;s your interdimensional portal.&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>这会失败是因为类型注解不是单一的 Pydantic 类型, 也不是单一的 Response 类或子类, 而是 Response 和 dict 之间的联合类型</p>
<h4 id="disable-response-model-禁用响应类型">Disable response Model 禁用响应类型<a hidden class="anchor" aria-hidden="true" href="#disable-response-model-禁用响应类型">#</a></h4>
<p>如果不希望 FastAPI 执行默认的数据验证、文档生成、过滤等操作, 但是又想在函数中保留返回类型注解, 以获得编辑器和类型检查工具的支持, 这种情况下设置 <code>response_model=None</code> 来禁用响应生成</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">Response</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi.response</span> <span class="kn">import</span> <span class="n">RedirectResponse</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/portal&#34;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">get_protal</span><span class="p">(</span><span class="n">teleport</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">teleport</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">RedirectResponse</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&#34;https://www.youtube.com/watch?v=dQw4w9WgXcQ&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">JSONResponse</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;message&#34;</span><span class="p">:</span> <span class="s2">&#34;Here&#39;s your interdimensional portal.&#34;</span><span class="p">})</span>
</span></span></code></pre></div><h3 id="response-model-encoding-parameters-响应模型编码参数">Response Model Encoding Parameters 响应模型编码参数<a hidden class="anchor" aria-hidden="true" href="#response-model-encoding-parameters-响应模型编码参数">#</a></h3>
<p>响应模型可能有默认值</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span><span class="p">:</span> <span class="nb">float</span>
</span></span><span class="line"><span class="cl">    <span class="n">tax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.5</span>
</span></span><span class="line"><span class="cl">    <span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span></code></pre></div><p>例如, 在 NoSQL 数据库中哟许多可选属性的模型, 但不想发送默认值的很长的 JSON 响应</p>
<p>可以使用 path operation operator 的 <code>response_model_exclude_mode</code> 参数来去除默认值</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">,</span> <span class="n">response_model_exclude_unset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
</span></span></code></pre></div><ul>
<li><code>description: str | None = None</code> 默认值为 <code>None</code></li>
<li><code>tax: float = 10.5</code> 的默认值为 10.5</li>
<li><code>tags: List[str] = []</code> 的默认值是空列表 <code>[]</code></li>
</ul>
<p>此时, 如果向该路径发送 ID 为 <code>foo</code> 的项目请求</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">&#34;foo&#34;: { &#34;name&#34;: &#34;Foo&#34;, &#34;price&#34;: </span><span class="m">50.2</span><span class="w"> </span>}<span class="w">
</span></span></span></code></pre></div><p>响应将是</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl">{<span class="w"> </span><span class="nt">&#34;name&#34;: &#34;foo&#34;, &#34;price&#34;: </span><span class="m">50.2</span><span class="w"> </span>}<span class="w">
</span></span></span></code></pre></div><ul>
<li><code>response_model_include</code> 和 <code>response_model_exclude</code></li>
</ul>
<p>也可以使用 path operation parameter 中的 <code>response_model_include</code> 和 <code>response_model_exclude</code>, 他们接受一个包含属性名称字符串的 <code>set</code>, 用于包含(省略其余部分)或排除(包含其余部分)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Item</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">price</span><span class="p">:</span> <span class="nb">float</span>
</span></span><span class="line"><span class="cl">    <span class="n">tax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">items</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;foo&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Foo&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">:</span> <span class="mf">50.2</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;bar&#34;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Bar&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;The Bar fighters&#34;</span><span class="p">,</span> <span class="s2">&#34;price&#34;</span><span class="p">:</span> <span class="mi">62</span><span class="p">,</span> <span class="s2">&#34;tax&#34;</span><span class="p">:</span> <span class="mf">20.2</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;baz&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Baz&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;There goes my baz&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;price&#34;</span><span class="p">:</span> <span class="mf">50.2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;tax&#34;</span><span class="p">:</span> <span class="mf">10.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">/name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model_include</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">},</span> <span class="c1"># 包含</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item_name</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">/public&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model_exclude</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;tax&#34;</span><span class="p">},</span> <span class="c1"># 排除</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item_public_data</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
</span></span></code></pre></div><p>虽然可以通过上述方法自定义返回参数包含哪些, 但还是建议使用多个类来实现该功能, 而不这些参数</p>
<p>这是因为, 即使使用 <code>response_model_include</code> 或 <code>response_model_exclude</code> 来省略某些属性, 在应用程序的 OpenAPI 中生成的 JSON Schema 仍将是完整模型的 Schema</p>
<p>这对于 <code>response_model_by_alias</code> 也是一样的</p>
<h4 id="using-list-instead-of-sets">Using <code>list</code> instead of <code>set</code>s<a hidden class="anchor" aria-hidden="true" href="#using-list-instead-of-sets">#</a></h4>
<p>如果忘记使用集和而使用元组或列表, FastAPI 仍会将其转换为集和, 确保正常工作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">/name&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model_include</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">,</span> <span class="s2">&#34;description&#34;</span><span class="p">],</span>  <span class="c1"># 使用列表</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item_name</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.get</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;/items/</span><span class="si">{item_id}</span><span class="s2">/public&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model</span><span class="o">=</span><span class="n">Item</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">response_model_exclude</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;tax&#34;</span><span class="p">],</span>  <span class="c1"># 使用列表</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">read_item_public_data</span><span class="p">(</span><span class="n">item_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">items</span><span class="p">[</span><span class="n">item_id</span><span class="p">]</span>
</span></span></code></pre></div><h3 id="response-status-code-响应状态码">Response Status Code 响应状态码<a hidden class="anchor" aria-hidden="true" href="#response-status-code-响应状态码">#</a></h3>
<p>就像可以指定响应模型一样, 也可以在任何路径操作中使用 <code>status_code</code> 参数声明用于响应:</p>
<ul>
<li><code>@app.get()</code></li>
<li><code>@app.post()</code></li>
<li><code>@app.put()</code></li>
<li><code>@app.delete()</code></li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span></span></code></pre></div><p><code>status_code</code> 是&quot;装饰器&quot;方法的一个参数, 而不是你的路径操作函数 <em>path operation function</em> 的参数</p>
<p><code>status_code</code> 参数接收一个表示 HTTP 状态码的数字, 也可以接收一个 <code>IntEnum</code>, 比如 Python 中的 <code>http.HTTPStatus</code></p>
<ul>
<li>将在响应中返回该状态码</li>
<li>并在 OpenAPI 模式中也如此记录</li>
</ul>
<h4 id="about-http-status-codes">About HTTP status codes<a hidden class="anchor" aria-hidden="true" href="#about-http-status-codes">#</a></h4>
<p>在 HTTP 协议中, 会在响应中发送一个3位数的数字状态码</p>
<p>这些状态码又一个相关联的名称便于识别, 但重要的是数字本身</p>
<ul>
<li>100~199: 用于&quot;信息&quot;, 很少会直接使用它们, 这些状态码的响应不能有响应体</li>
<li>200~299: 用于&quot;成功&quot;的响应, 这些是最常用的
<ul>
<li>200 的默认的&quot;成功&quot;响应, 表示一切 OK</li>
<li>201 表示已创建, 通常在数据库中创建新记录后使用</li>
<li>204 表示无内容, 当没有内容返回给客户端时使用此响应, 因此不能有响应体</li>
</ul>
</li>
<li>300~399: 用于&quot;重定向&quot;, 这些状态码的响应可能有也可能没有响应体. 但 304 (未修改) 除外, 它必须没有响应体</li>
<li>400~499: 用于&quot;客户端错误&quot;响应,
<ul>
<li>404 用于&quot;未找到&quot;的响应</li>
<li>400 客户端通用错误</li>
</ul>
</li>
<li>500~599: 用于服务器错误, 几乎从不直接使用它们. 当的应用代码或服务器的某个部分出错时, 它会自动返回这些状态码之一</li>
</ul>
<p>要了解更多关于每个状态码的信息以及哪个代码用于什么目的，请查阅 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status">MDN 关于 HTTP 状态码的文档</a></p>
<h4 id="shortcut-to-remember-the-names">Shortcut to remember the names<a hidden class="anchor" aria-hidden="true" href="#shortcut-to-remember-the-names">#</a></h4>
<p>除了直接使用数字外, 还可以使用 <code>fastapi.status</code> 中的便捷变量</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span><span class="p">,</span> <span class="n">status</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/items/&#34;</span><span class="p">,</span> <span class="n">status_code</span><span class="o">=</span><span class="n">status</span><span class="o">.</span><span class="n">HTTP_201_CREATED</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">create_item</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span></span></code></pre></div><p>这只是一直便利, 都是一样的树枝, 但这样可以使用编辑器的自动补全功能</p>
<blockquote>
<p>也可以使用 <code>from starlette import status</code></p>
</blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/fastapi/">FastAPI</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/python-strings/">
    <span class="title">« Prev</span>
    <br>
    <span>Python Strings</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/fastapi-cookie-and-header-parameters/">
    <span class="title">Next »</span>
    <br>
    <span>Fastapi Cookie and Header Parameters</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on x"
            href="https://x.com/intent/tweet/?text=FastAPI%20Response%20Model&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f&amp;hashtags=FastAPI">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f&amp;title=FastAPI%20Response%20Model&amp;summary=FastAPI%20Response%20Model&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f&title=FastAPI%20Response%20Model">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on whatsapp"
            href="https://api.whatsapp.com/send?text=FastAPI%20Response%20Model%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on telegram"
            href="https://telegram.me/share/url?text=FastAPI%20Response%20Model&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share FastAPI Response Model on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=FastAPI%20Response%20Model&u=http%3a%2f%2flocalhost%3a1313%2fposts%2ffastapi-response-model%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Starslayerx&#39; Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
