<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>uv - Python package manager | Starslayerx' Blog</title><meta name=keywords content="Python"><meta name=description content="这篇文章深入介绍 uv 管理 Python 项目的使用
Features
Python versions

uv python install: 安装 Python 版本
uv python list: 查看可用的 Python 版本
uv python find: 查找安装的 Python 版本
uv python pin: 固定当前项目的 Python 版本
uv python uninstall: 卸载一个 Python 版本

Scripts

uv run: 运行一个脚本
uv add --script: 为脚本添加一个依赖
uv remove --script: 移除一个依赖

Projects
使用 pyproject.toml 配置项目

uv init: 创建一个 Python 项目
uv add: 为项目添加依赖
uv remove: 删除项目依赖
uv sync: 同步环境下的依赖
uv lock: 为项目依赖创建一个锁文件
uv run: 在项目环境执行命令
uv tree: 查看项目依赖树
uv build: 将项目构建为分发归档文件
uv publish: 将项目发布到包索引

Tools
允许与安装工具"><meta name=author content="Starslayerx"><link rel=canonical href=https://starslayerx.github.io/posts/uv-python-package-manager/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=16x16 href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://starslayerx.github.io/favicon.svg><link rel=apple-touch-icon href=https://starslayerx.github.io/favicon.svg><link rel=mask-icon href=https://starslayerx.github.io/favicon.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://starslayerx.github.io/posts/uv-python-package-manager/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://starslayerx.github.io/posts/uv-python-package-manager/"><meta property="og:site_name" content="Starslayerx' Blog"><meta property="og:title" content="uv - Python package manager"><meta property="og:description" content="这篇文章深入介绍 uv 管理 Python 项目的使用
Features Python versions uv python install: 安装 Python 版本 uv python list: 查看可用的 Python 版本 uv python find: 查找安装的 Python 版本 uv python pin: 固定当前项目的 Python 版本 uv python uninstall: 卸载一个 Python 版本 Scripts uv run: 运行一个脚本 uv add --script: 为脚本添加一个依赖 uv remove --script: 移除一个依赖 Projects 使用 pyproject.toml 配置项目
uv init: 创建一个 Python 项目 uv add: 为项目添加依赖 uv remove: 删除项目依赖 uv sync: 同步环境下的依赖 uv lock: 为项目依赖创建一个锁文件 uv run: 在项目环境执行命令 uv tree: 查看项目依赖树 uv build: 将项目构建为分发归档文件 uv publish: 将项目发布到包索引 Tools 允许与安装工具"><meta property="og:locale" content="en-US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-22T08:00:00+08:00"><meta property="article:modified_time" content="2025-09-22T08:00:00+08:00"><meta property="article:tag" content="Python"><meta property="og:image" content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:title content="uv - Python package manager"><meta name=twitter:description content="这篇文章深入介绍 uv 管理 Python 项目的使用
Features
Python versions

uv python install: 安装 Python 版本
uv python list: 查看可用的 Python 版本
uv python find: 查找安装的 Python 版本
uv python pin: 固定当前项目的 Python 版本
uv python uninstall: 卸载一个 Python 版本

Scripts

uv run: 运行一个脚本
uv add --script: 为脚本添加一个依赖
uv remove --script: 移除一个依赖

Projects
使用 pyproject.toml 配置项目

uv init: 创建一个 Python 项目
uv add: 为项目添加依赖
uv remove: 删除项目依赖
uv sync: 同步环境下的依赖
uv lock: 为项目依赖创建一个锁文件
uv run: 在项目环境执行命令
uv tree: 查看项目依赖树
uv build: 将项目构建为分发归档文件
uv publish: 将项目发布到包索引

Tools
允许与安装工具"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://starslayerx.github.io/posts/"},{"@type":"ListItem","position":2,"name":"uv - Python package manager","item":"https://starslayerx.github.io/posts/uv-python-package-manager/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"uv - Python package manager","name":"uv - Python package manager","description":"这篇文章深入介绍 uv 管理 Python 项目的使用\nFeatures Python versions uv python install: 安装 Python 版本 uv python list: 查看可用的 Python 版本 uv python find: 查找安装的 Python 版本 uv python pin: 固定当前项目的 Python 版本 uv python uninstall: 卸载一个 Python 版本 Scripts uv run: 运行一个脚本 uv add --script: 为脚本添加一个依赖 uv remove --script: 移除一个依赖 Projects 使用 pyproject.toml 配置项目\nuv init: 创建一个 Python 项目 uv add: 为项目添加依赖 uv remove: 删除项目依赖 uv sync: 同步环境下的依赖 uv lock: 为项目依赖创建一个锁文件 uv run: 在项目环境执行命令 uv tree: 查看项目依赖树 uv build: 将项目构建为分发归档文件 uv publish: 将项目发布到包索引 Tools 允许与安装工具\n","keywords":["Python"],"articleBody":"这篇文章深入介绍 uv 管理 Python 项目的使用\nFeatures Python versions uv python install: 安装 Python 版本 uv python list: 查看可用的 Python 版本 uv python find: 查找安装的 Python 版本 uv python pin: 固定当前项目的 Python 版本 uv python uninstall: 卸载一个 Python 版本 Scripts uv run: 运行一个脚本 uv add --script: 为脚本添加一个依赖 uv remove --script: 移除一个依赖 Projects 使用 pyproject.toml 配置项目\nuv init: 创建一个 Python 项目 uv add: 为项目添加依赖 uv remove: 删除项目依赖 uv sync: 同步环境下的依赖 uv lock: 为项目依赖创建一个锁文件 uv run: 在项目环境执行命令 uv tree: 查看项目依赖树 uv build: 将项目构建为分发归档文件 uv publish: 将项目发布到包索引 Tools 允许与安装工具\nuvx / uv tool run: 在临时环境运行一个工具 uv tool install: 安装一个工具 uv tool uninstall: 卸载一个工具 uv tool list: 列出已安装工具 uv tool update-shell: 更新 shell 以包含工具执行 The pip interface 手动管理环境与包, 用于旧的工作流, 或一些高级命令功能\nuv venv: 创建虚拟环境 下面命令手动管理环境中的包 (替代 pip 和 pipdeptree)\nuv pip install: 在当前环境安装包 uv pip show: 显示已安装包的细节 uv pip freeze: 列出安装的包以及版本 uv pip check: 检查当前环境是否有兼容的软件包 uv pip list: 列出已安装包 uv pip uninstall: 卸载包 uv pip tree: 查看环境依赖 在环境中锁定包 (替代 pip-tools)\nuv pip compile: 将依赖编译到一个锁文件中 uv pip sync: 使用锁文件同步环境 Utility 管理与检查 uv 的状态, 例如缓存、存储目录或子升级\nuv cache clean: 清除缓存条目 uv cache prune: 移除过期的缓存条目 uv cache dir: 显示 uv 缓存目录的路径 uv tool dir: 显示 uv 工具目录路径 uv python dir: 显示 uv 安装的 Python 各版本路径 uv self update: 更新 uv Projects Structure and files Python 项目依赖元数据定义在 pyproject.toml 中, uv 依赖这个文件来确定项目根目录.\n一个最小的项目定义包含名称和版本\n[project] name = \"example\" version = \"0.1.0\" 额外的项目元数据和配置包含:\nPython version requirement Dependencies Build system Entry points The project environment 使用 uv 处理项目时, uv 会根据需要创建虚拟环境. 虽然某些 uv 命令会创建临时环境 (uv run --isolated), 但 uv 也会在 pyproject.toml 旁边的 .venv 目录中管理一个持久环境, 其中包含项目及其依赖项. 它存储在项目内部是为了方便编辑器查找, 编辑器需要环境来提供代码补全和类型提示. 不建议将 .venv 目录包含在版本控制中, 它会通过内部 .gitignore 文件自动从 git 中排除.\n要在项目环境中运行命令, 应该使用 uv run. 或者, 项目环境可以像普通虚拟环境一样正常激活.\n当调用 uv run 时, 如果项目环境尚不存在, 它将创建项目环境, 如果已存在则确保其是最新的. 项目环境也可以通过 uv sync 显式创建.\n不建议手动修改项目环境, 例如使用 uv pip install. 对于项目依赖项, 使用 uv add 将包添加到环境中. 对于一次性需求, 使用 uvx 或 uv run --with.\nTIP 提示\n如果不希望 uv 管理项目环境, 设置 managed = false 来禁用项目的自动锁定和同步, 例如:\n[tool.uv] managed = false The lockfile uv 会在 pyproject.toml 旁边创建一个 uv.lock 文件.\nuv.lock 是一个通用或跨平台锁文件, 它捕获在所有可能的 Python 标记 (操作系统、架构和Py版本) 上将要安装的包.\n与用于指定项目广泛要求的 pyproject.toml 不同, 锁文件包含在项目环境中安装的确切解析版本. 此文件应检入版本控制, 以允许在不同机器上进行一致且可重现的安装.\n锁文件确保从事项目工作的开发人员使用一致的包版本. 它确保在将项目部署为应用程序时，已知使用的确切包版本.\n锁文件在使用项目环境的 uv 调用期间自动创建和更新, 即 uv sync 和 uv run. 锁文件也可以使用 uv lock 显式更新.\nuv.lock 是一个人类可读的 TOML 文件, 但由 uv 管理, 不应手动编辑. uv.lock 格式专用于 uv, 其他工具无法使用.\nRelationship to pylock.toml 在 PEP 751 中, Python 标准化了一种新的解析文件格式 pylock.toml. pylock.toml 是一种解析输出格式，旨在替代 requirements.txt. pylock.toml 是标准化的且与工具无关的, 这样在未来, uv 生成的 pylock.toml 文件可以由其他工具安装. uv 的某些功能无法在 pylock.toml 格式中表达; 因此, uv 将继续在项目接口中使用 uv.lock 格式.\n但是, uv 支持将 pylock.toml 作为导出目标以及在 uv pip CLI 中使用:\nuv export -o pylock.toml: 将 uv.lock 导出为 pylock.toml 格式 uv pip compile -o pylock.toml -r requirements.in: 一组要求生成 pylock.toml 文件 uv pip sync pylock.toml 或 uv pip install -r pylock.toml: 从 pylock.toml 文件安装 Creating projects uv 支持使用 uv init 创建项目. 当创建项目时, uv 支持两种基本的模板: applications 和 libraries. 默认 uv 会创建应用项目, 使用 --lib flag 可以创建 library 项目.\nTarget directory uv 会在工作目录创建项目, 或者在目标目录, 例如 uv init foo. 如果这个位置已经存在项目了, uv 会退出并报错.\nApplications 应用项目模板很适合 web 服务器、脚本和命令行接口. 该模板是默认的 uv init 生成目标, 也可以使用 --app flag 显示指定\nuv init example-app 项目结构包含一个 pyproject.toml、一个样本文件 main.py 一个 readme 和一个 Python 版本文件 .python-version\npyproject.toml 文件包含了基本的元数据. 不包含构建系统, 它不是一个包, 并且不会在环境中安装.\n[project] name = \"example-app\" version = \"0.1.0\" description = \"Add your description here\" readme = \"README.md\" requires-python = \"\u003e=3.11\" dependencies = [] main.py 文件有类似下面的样板\ndef main(): print(\"Hello from example-app!\") if __name__ == \"__main__\": main() 通过下面命令运行 python 代码\nuv run main.py Packaged applications 如果是想要创建一个命令行工具, 并发布到 PyPI 上面, 可以使用 package 模板.\nuv init --package example-pkg 如果要放到 package/ 目录下面使用\nuv init --package packages/example-pkg 或者\nuv init packages/exmaple-pkg main.py 被替换为 src/ 目录, 该目录中会包含一个模块目录, 以及一个 __init__.py 文件.\nBuild system 被定义了, 因此该项目会被安装到环境中, pyproject.toml 类似下面这样:\n[project] name = \"example-pkg\" version = \"0.1.0\" description = \"Add your description here\" readme = \"README.md\" requires-python = \"\u003e=3.11\" dependencies = [] [project.scripts] example-pkg = \"example_pkg:main\" [build-system] requires = [\"uv_build\u003e=0.8.20,\u003c0.9.0\"] build-backend = \"uv_build\" 命令也被定义了, 可以使用下面这样命令运行 uv run\nuv run exmaple-pkg Libraries 一个库提供函数和对象为其他项目使用. 库需要构建和分发, 例如上传到 PyPI. 使用 --lib flag 来创建库结构.\nuv init --lib example-lib 类似 packaged application, 项目采用了 src/ 布局, 其中包含一个 py.typed 标记文件, 用于告知使用者此库提供了类型注解信息.\n[project] name = \"example-lib\" version = \"0.1.0\" description = \"Add your description here\" readme = \"README.md\" requires-python = \"\u003e=3.11\" dependencies = [] [build-system] requires = [\"uv_build\u003e=0.8.20,\u003c0.9.0\"] build-backend = \"uv_build\" 可以自行选择不同的构建后端, 使用 --build-backend 结合 hatchling, uv_build, flitcore, pdm-backend, setuptools, maturin 或 scikit-build-core 等使用.\n创建的模块定义了一个简单的 API 函数 __init__.py\ndef hello() -\u003e str: return \"Hello from example-lib!\" 然后可以使用 uv run 运行\nuv run python -c \"import example_lib; print(example_lib.hello())\" Projects with extension modules 大多数 Python 项目都是 “pure Python”, 这意味着他们不使用其他语言定义模块, 例如 C, C++, FORTRAN 或 Rust. 然而, 使用扩展模块的项目通常在性能敏感的代码中使用.\n创建一个扩展模块需要选择一个构建系统. uv 支持下面的构建系统:\nmaturin 用于支持 Rust 项目 scikit-build-core: 用于 C, C++, FORTRAN, Cython 使用 --build-backend flag 指定构建系统\nuv init --build-backend maturin example-ext 这个项目包含一个 Cargo.toml 和一个 src/lib.rs 文件.\nRust 库定义了一个简单的函数\nuse pyo3::prelude::*; #[pyfunction] fn hello_from_bin() -\u003e String { \"Hello from example-ext!\".to_string() } #[pymodule] fn _core(m: \u0026Bound\u003c'_, PyModule\u003e) -\u003e PyResult\u003c()\u003e { m.add_function(wrap_pyfunction!(hello_from_bin, m)?)?; Ok(()) } 并在 Python 模块中将其导入, src/example-ext/__init__.py 内容如下:\nfrom example_ext._core import hello_from_bin def main() -\u003e None: print(hello_from_bin()) 可以使用下面命令执行\nuv run example-ext Creating a minimal project 如果只想创建一个 pyproject.toml 使用 --bare 选项\nuv init example --bare Managing dependencies Dependency fields 项目依赖由以下几个字段定义\nproject.dependencies: 发布的依赖 project.optional-dependencies: 发布的可选依赖 dependency-groups: 本地开发依赖 tool.uv.sources: 开发依赖的可选源 NOTE\n项目的 project.dependencies 和 project.optional-dependencies 字段即使不发布也能使用.\nuv 支持使用 uv add 和 uv remove 来定义项目依赖, 但也可以直接修改 pyproject.toml.\nAdding dependencies 例如这样\nuv add httpx 可以添加一个项目依赖\n[project] name = \"example\" version = \"0.1.0\" dependencies = [\"httpx\u003e=0.27.2\"] 使用 --dev, --group, --optional flag 可以用来为可选字段添加依赖. 依赖将会添加一个约束, 例如 \u003e=0.27.2, 这是最近的兼容版本. 这样的约束可以使用 --bounds 调整, 或者直接提供约束.\nuv add \"httpx\u003e=0.20\" 当从源添加一个依赖而不是 package registry 的时候, uv 会在源字段中添加一个条目, 例如下面从 GitHub 添加 httpx:\nuv add \"httpx @ git+https://github.com/encode/httpx\" 这会在 pyproject.toml 添加一个 Git 入口源:\n[project] name = \"example\" version = \"0.1.0\" dependencies = [ \"httpx\", ] [tool.uv.sources] httpx = { git = \"https://github.com/encode/httpx\" } 如果依赖无法添加, uv 将会输出一个报错.\nImporting dependencies from requirements files 可以使用 -r 选项添加 requirements.txt 里面的依赖\nuv add -r requirements.txt Removing dependencies 使用下面命令移除依赖\nuv remove httpx 使用 --dev, --group 或 --optional flags 来移除其他特定的依赖. 如果被移除的依赖项定义了源, 并且没有其他依赖项引用它, 那么这个源也将被一并移除.\nChanging dependencies 如果要修改现有的依赖, 可以这样\nuv add \"httpx\u003e0.1.0\" 使用一个不同的依赖源\nuv add \"httpx @ .../httpx\" Platform-specific dependencies 为了使用只在具体平台的依赖或具体的 Python 版本, 使用 environment markers.\n例如, 只在 Linux 平台安装 jax:\nuv add \"jax; sys_paltform == 'linux'\" 这会使 pyproject.toml 包含下面这样的定义\n[project] name = \"project\" version = \"0.1.0\" requires-python = \"\u003e=3.11\" dependencies = [\"jax; sys_platform == 'linux'\"] 相似的, 只为 Python 3.11 之后的版本添加 numpy:\nuv add \"numpy; python_version \u003e= '3.11'\" Project dependencies project.dependencies 代表上传到 PyPI 或者构建 wheel 使用的依赖. 单独依赖具体使用 dependency specifiers 语法, 并遵循 PEP 621 标准.\nproject.dependencies 定义了一个项目需要的依赖列表, 以及需要的版本限制. 每一项都包含一个项目名称和项目版本号, 有些项还包含额外的 environment markers, 例如:\n[project] name = \"albatross\" version = \"0.1.0\" dependencies = [ # Any version in this range \"tqdm \u003e=4.66.2,\u003c5\", # Exactly this version of torch \"torch ==2.2.2\", # Install transformers with the torch extra \"transformers[torch] \u003e=4.39.3,\u003c5\", # Only install this package on older python version \"importlib_metadata \u003e=7.1.0,\u003c8; python_version \u003c '3.10'\", \"mollymawk ==0.1.0\" ] Dependency sources tool.uv.sources 表是对标准依赖表的扩展, 增加了例如可编辑安装和相对路径. 例如, 从项目根目录的相对目录安装 foo.\n[project] name = \"example\" version = \"0.1.0\" dependencies = [\"foo\"] [tool.uv.sources] foo = { path = \"./package/foo\" } uv 支持下面几种依赖源:\nIndex: 从特定包索引解析的包 Git: 一个 Git 仓库 URL: 一个远程的 wheel 包或源码分发包 Path: 一个本地 wheel, 源码包或项目目录 Workspace: 当前工作空间的成员 Optional dependencies 项目作为库发布时, 使一些功能称为可选的, 从而降低默认依赖树的大小, 这种做法很常见. 例如, Pandas 有额外的 excel extra 和 plot extra 包, 来避免安装 Excel 解析器和 matplotlib. 除非明确说明安装, Extras 使用 package[] 语法指明, 例如 pandas[plot, excel].\n可选依赖具体在 [project.optional-dependencies] 中, 可选依赖可以像普通依赖一样在 tool.uv.sources 中替换源\n[project] name = \"pandas\" version = \"1.0.0\" [project.optional-dependencies] plot = [ \"matplotlib\u003e=3.6.3\" ] excel = [ \"odfpy\u003e=1.4.1\", \"openyxl\u003e=3.1.0\", \"python-calamine\u003e=0.17\", \"pyxlsb\u003e=1.0.10\", \"xlrd\u003e=2.0.1\", \"xlsxwriter\u003e-3.0.5\" ] 如果要添加可选依赖, 使用 --optional 选项:\nuv add httpx --optional network 源也可以声明为只适用特定的可选依赖项. 例如, 根据可选的 cpu 或 gpu 额外依赖项, 从不同的 PyTorch 索引来去 torch 包\n[project] dependencies = [] [project.optional-dependencies] cpu = [ 'torch', ] gpu = [ 'torch', ] [tool.uv.sources] torch = [ { index = \"torch-cpu\", extra = \"cpu\" }, { index = \"torch-gpu\", extra = \"gpu\" }, ] [[tool.uv.index]] name = \"torch-cpu\" url = \"https://download.pytorch.org/whl/cpu\" [[tool.uv.index]] name = \"torch-gpu\" url = \"https://download.pytorch.org/whl/cu124\" Development dependencies 不同于可选依赖, 开发依赖只会在本地安装, 不会在发布到 PyPI 这样的项目依赖中生效. 因此, 开发依赖不包含在 [project] 表中. 同样地, 开发依赖也可以使用 tool.uv.sources 来指定源.\n使用下面命令添加开发依赖\nuv add --dev pytest uv 使用 [dependency-groups] 表来声明开发依赖, 上面命令会创建一个 dev 组\n[dependency-groups] dev = [ \"pytest \u003e=8.1.1\u003c9\" ] dev 组是一个特例, 可以使用 --dev, --only-dev 和 --no-dev flags 来设置包含或排除依赖.\nDependency groups 开发环境可以被拆分成多个组, 使用 --group flag. 例如, 想要为开发依赖 ruff 加入 lint 组:\nuv add --group lint ruff 这会导致下面的 [dependency-groups] 定义:\n[dependency-groups] dev = [ \"pytest\" ] lint = [ \"ruff\" ] 一但组被定义了, --all-groups, --no-default-groups, --group, --only-group 和 --no-group 选项可以用来包含和排除依赖.\nuv 要求所有的依赖组之间是相互兼容的, 并且会在创建 lockfile 时解析所有的组.\n如果一组的依赖和其他组的依赖不兼容, uv 会无法解析依赖并报错.\nNesting groups 一个依赖组可以包含其他依赖组, 例如:\n[dependency-groups] dev = [ {include-group = \"lint\"}, {include-group = \"test\"} ] lint = [ \"ruff\" ] test = [ \"pytest\" ] Default groups 默认情况下, uv 在环境中包含一个 dev 依赖组. 默认的组可以使用 tool.uv.default-groups 来设置:\n[tool.uv] default-groups = [\"dev\", \"foo\"] 要默认启用所有的组依赖, 使用 “all” 而不是列出所有的组名:\n[tool.uv] default-groups = \"all\" requires-python 组 默认情况下, 依赖组必须和项目 requires-python 兼容. 如果一个依赖组需要不同的 Python 版本, 可以在 [tool.uv.dependency-groups] 里面指定 Python 版本.\n[project] name = \"example\" version = \"0.0.0\" requires-python = \"\u003e=3.10\" [dependency-groups] dev = [\"pytest\"] [tool.uv.dependency-groups] dev = {requires-python = \"\u003e=3.12\"} Legacy dev-dependencies 在 [dependency-groups] 成为标准之前, uv 使用 tool.uv.dev-dependencies 字段来指定开发依赖\n[tool.uv] dev-dependencies = [ \"pytest\" ] Build dependencies 如果一个项目使用 Python package 的结构, 它可能需要构建项目的依赖, 但无需运行. 这类依赖是 [build-system], 在 build-system.requires 下面, 详见 PEP 518.\n例如, 如果一个项目使用 setuptools 作为后端构建, 它应该声明 setuptools 作为一个构建依赖:\n[project] name = \"pandas\" version = \"0.1.0\" [build-system] requires = [\"setuptools\u003e=42\"] build-backend = \"setuptools.build_meta\" 默认情况下, uv 构建依赖的时候会检查 tool.uv.sources. 例如, 使用本地版本的 setuptools 进行构建, 将源添加进 tool.uv.sources\n[project] name = pandas version = \"0.1.0\" [build-system] requires = [\"setuptools\u003e=42\"] build-backend = \"setuptools.build_meta\" [tool.uv.sources] setuptools = { path = \"./packages/setuptools\" } 当发布一个包的时候, 建议当 tool.uv.sources 被禁用时, 运行 uv build --no-source 来确保正确构建. 使用其他构建工具也是一样的, 例如 pypa/build.\nEditable dependencies 常规的目录安装会先构建 wheel 包, 然后将该 wheel 包安装到虚拟环境中, 这回复制所有的源文件. 当包源文件被编译时, 虚拟环境中的版本将保持旧版本.\n可编辑安装通过向虚拟环境内添加项目连接 (.pth 文件) 解决了这个问题, 该链接指示解释器直接包含源文件. 可编辑安装存在一些限制, 但对于开发常见非常实用, 因为虚拟环境会始终使用包的最新修改.\nuv 默认对工作区包采用可编辑安装模式.\nVirtual dependencies uv 运行依赖项设置为\"虚拟\"模式, 在此模式下, 依赖项本身不会作为软件包被安装, 但其依赖关系会被正常处理.\n默认情况下, 依赖项永远不会被视作虚拟依赖.\n对于路径源的依赖项, 若显示设置 tool.uv.package = false 则可成为虚拟依赖. 与在依赖项目中使用 uv 工作不同, 即使未声明构建系统, 该软件包仍会被构建.\n若要将某个依赖项视位虚拟依赖, 需要在其源配置中设置 package = false:\n[project] dependencies = [\"bar\"] [tool.uv.sources] bar = { path = \"../projects/bar\", package = false } 如果依赖设置 tool.uv.package = false, 则可以在 source 通过声明 package = true 来覆盖.\n[project] dependencies = [\"bar\"] [tool.uv.source] bar = { path = \"../projects/bar\", package = true } 同样地, 对于工作区源的依赖项, 若显式设置 tool.uv.package = false 也可成为虚拟依赖. 即使未声明构建系统, 该工作区成员仍会被构建.\n对于非依赖项的工作区成员, 默认情况下可设置为虚拟模式, 例如, 若父级 pyproject.toml 文件配置如下:\n[project] name = \"parent\" version = \"1.0.0\" dependencies = [] [tool.uv.workspace] members = [\"child\"] 并且 child 的 pyproject.toml 不含有构建系统.\n[project] name = \"child\" version = \"1.0.0\" dependencies = [\"anyio\"] 那么 child workspace 成员将不会被安装, 但是依赖 anyio 会被传递.\n相对的, 如果父级声明了对 child 的依赖:\n[project] name = \"parent\" version = \"1.0.0\" dependencies = [\"child\"] [tool.uv.sources] child = { workspace = true } [tool.uv.workspace] members = [\"child\"] 那么 child 将会被构建和安装.\nDependency specifiers uv 采用最初由 PEP 508 定义的依赖项限定符, 依赖项限定符按顺序包括以下组件:\n依赖项名称 所需额外功能 版本限定符 环境标记 版本限定符通过逗号分割进行组合, 例如 foo \u003e=1.2.3,\u003c2,!=1.4.0 表示 “foo 的版本需不低于 1.2.3, 小于 2, 且不能是 1.4.0”. 限定符会自动补零, 因此 foo ==2 也会匹配 foo 2.0.0.\n星号可以用于等号匹配的最后一位数字, 例如 foo ==2.1.* 将接受 2.1 系列的所有版本. 类似地, ~= 匹配最后一位数字相等或更高的版本, 例如 foo ~=1.2 等价于 foo \u003e=1.2,\u003c2, 而 foo ~=1.2.3 等价于 foo \u003e=1.2.3,\u003c1.3.\n额外功能在名称和版本直接的方括号内用逗号分隔, 例如 pandas[excel, plot] ==2.2. 额外功能名称之间的空格会被忽略.\n某些依赖项仅在特定环境中需要, 例如特定的 Python 版本或系统. 比如要为 importlib.metadata 模块安装 importlib-metadata 回溯包, 可使用 importlib-metadata \u003e=7.1.0,\u003c8; python_version \u003c '3.10'. 要在 Windows 上安装 colorama 则可使用 colorama \u003e=0.4.6,\u003c5; platform_systemm == \"Windows.\n环境标记通过 and, or 和括号进行组合, 例如\naiohttp \u003e=3.7.4,\u003c4; (sys_paltform != 'win32' or implementation_name != 'pypy') and python_version \u003e= '3.10' 注意标记内的版本需要加引号, 而标记外的版本不加引号.\nUsing workspace 工作空间受到 Cargo 的同名概念启发, 即将一个或多个包一起管理, 叫做 workspace.\nWorkspace 通过将项目拆分多个包和相同的依赖, 从而组织大型代码库. 例如, 有一个 FastAPI 的 web 应用, 和一些列的由不同的 Python 包维护的库, 都放在同一个 Git 仓库中. 在一个 workspace 中, 每个包定义自己的 pyproject.toml 文件, 但是工作空间共享同一个 lockfile, 以确保工作空间内的依赖一致.\n在定义 workspace 的时候, 必须要指定 members (必填) 和 exclude (可选) 键, 他们分别用于指示工作区包含或排除特定目录作为成员, 并接受通配符列表:\n[project] name = \"albatross\" version = \"0.1.0\" requires-python = \"\u003e=3.12\" dependencies = [\"bird-feeder\", \"tqdm\u003e=4,\u003c5\"] [tool.uv.sources] brid-feeder = { workspace = true } [tool.uv.workspace] members = [\"packages/*\"] exclude = [\"packages/seeds\"] 由 members 通配符包含的每个目录都必须包含一个 pyproject.toml 文件. 不过, 工作区成员即可以是应用程序, 也可以是库, 这两种类型在工作区环境中都支持.\n每个工作区都需要一个根目录, 该目录同时也是工作区成员. 在上面示例中, albatross 是工作区根目录, 工作区成员包括 packages 目录下面除 seeds 以外的所有项目.\n默认情况下, uv run 和 uv sync 命令会作用于工作区根目录. 例如上例中, uv run 与 uv run --package albatross 是等效的, 而 uv run --package bird-feeder 则会在 bird-feeder 包中执行命令.\nWorkspace sources 在一个 workspace 内, 对工作区成员的依赖通过 tool.uv.sources 实现, 例如:\n[project] name = \"albatross\" version = \"0.1.0\" requires-python = \"\u003e=3.12\" dependencies = [\"bird-feeder\", \"tqdm\u003e=4,\u003c5\"] [tool.uv.sources] bird-feeder = { workspace = true } [tool.uv.workspace] members = [\"packages/*\"] [build-system] requires = [\"uv_build\u003e=0.8.20,\u003c0.9.0\"] 在此示例中, albatross 项目依赖于同属工作区的 bird-feeder 项目. tool.uv.sources 表中 workspace = true 的键值对表明, bird-feeder 依赖应由工作区提供, 而非 PyPI 或其他注册源获取.\n工作区根目录中的任何 tool.uv.sources 定义将适用于所有成员, 除非在特定成员的 tool.uv.sources 中被覆盖.\nWorkspace layouts 最常见的工作区布局可以是一个根目录和一系列的库组成. 例如, 接着上面的例子, 工作区间有一个根目录 albatross, 以及 packages 目录下面的两个库 bird-feeder 和 seed.\nalbatross ├── packages │ ├── bird-feeder │ │ ├── pyproject.toml │ │ └── src │ │ └── bird_feeder │ │ ├── __init__.py │ │ └── foo.py │ └── seeds │ ├── pyproject.toml │ └── src │ └── seeds │ ├── __init__.py │ └── bar.py ├── pyproject.toml ├── README.md ├── uv.lock └── src └── albatross └── main.py 由于 seeds 被 pyproject.toml 排除在外, 故该工作区一共有两个成员: albatross 和 bird-feeder.\nWhen (not) to use workspaces Workspaces 是为了促进同一仓库下的多个包之间内部连接的开发. 当代码库逐渐变复杂, 将其切分成更小的可组合的包将十分有用. 每个包都有自己的依赖和版本限制.\n工作区有助于执行隔离和分离问题. 例如, 在 uv 中, 有分离的 core 包和命令行界面, 这使得我们可以分开测试 core 包和 CLI, 反之亦然.\n其他常见工作区间使用包括:\n在模块中实现了性能关键的扩展库 插件系统库, 每个插件是一个分离的 workspace 包和一个根目录下的依赖 工作区模式不适用于成员之间存在需求冲突, 或需要为每个成员创建独立虚拟环境的场景. 此类情况下, 路径依赖通常是更优选择. 例如, 无需将 albatross 及其相关组件强制归入同一工作区, 可以将每个软件包定义为独立项目, 并通过在 tool.uv.sources 中配置路径依赖来定义包间依赖关系.\n[project] name = \"albatross\" version = \"0.1.0\" requires-python = \"\u003e=3.12\" dependencies = [\"bird-feeder\", \"tqdm\u003e=4,\u003c5\"] [tool.uv.sources] bird-feeder = { path = \"packages/bird-feeder\" } [build-system] requires = [\"uv_build\u003e=0.8.20,\u003c0.9.0\"] build-backend = \"uv_build\" 这种方法能带来许多相同优势, 同时运行依赖解析和虚拟环境管理进行更精细的控制 (但无法使用 uv run --package 命令, 需要从对应软件目录运行命令).\n最后, uv 的工作区强制要求整个工作区间采用统一的 requires-python 配置, 该配置取所有 requires-python 值的交集. 如果需要给某个成员测试工作区其他成员不支持的 Python 版本, 可能需要使用 uv pip 将该成员安装到独立的虚拟环境中.\n","wordCount":"2131","inLanguage":"en","image":"https://starslayerx.github.io/images/og-default.avif","datePublished":"2025-09-22T08:00:00+08:00","dateModified":"2025-09-22T08:00:00+08:00","author":{"@type":"Person","name":"Starslayerx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://starslayerx.github.io/posts/uv-python-package-manager/"},"publisher":{"@type":"Organization","name":"Starslayerx' Blog","logo":{"@type":"ImageObject","url":"https://starslayerx.github.io/favicon.svg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://starslayerx.github.io/ accesskey=h title="Starslayerx' Blog (Alt + H)"><img src=https://starslayerx.github.io/favicon.svg alt aria-label=logo height=35>Starslayerx' Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://starslayerx.github.io/zh-cn/ title=简体中文 aria-label=简体中文>Zh-Cn</a></li></ul></div></div><ul id=menu><li><a href=https://starslayerx.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://starslayerx.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://starslayerx.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://starslayerx.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://starslayerx.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://starslayerx.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://starslayerx.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">uv - Python package manager</h1><div class=post-meta><span title='2025-09-22 08:00:00 +0800 +0800'>September 22, 2025</span>&nbsp;·&nbsp;<span>11 min</span>&nbsp;·&nbsp;<span>2131 words</span>&nbsp;·&nbsp;<span>Starslayerx</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#features>Features</a><ul><li><ul><li><a href=#python-versions>Python versions</a></li><li><a href=#scripts>Scripts</a></li><li><a href=#projects>Projects</a></li><li><a href=#tools>Tools</a></li><li><a href=#the-pip-interface>The pip interface</a></li><li><a href=#utility>Utility</a></li></ul></li></ul></li><li><a href=#projects-1>Projects</a><ul><li><a href=#structure-and-files>Structure and files</a><ul><li><a href=#the-project-environment>The project environment</a></li><li><a href=#the-lockfile>The lockfile</a></li><li><a href=#relationship-to-pylocktoml>Relationship to <code>pylock.toml</code></a></li></ul></li><li><a href=#creating-projects>Creating projects</a><ul><li><a href=#target-directory>Target directory</a></li><li><a href=#applications>Applications</a></li><li><a href=#packaged-applications>Packaged applications</a></li><li><a href=#libraries>Libraries</a></li><li><a href=#projects-with-extension-modules>Projects with extension modules</a></li><li><a href=#creating-a-minimal-project>Creating a minimal project</a></li></ul></li><li><a href=#managing-dependencies>Managing dependencies</a><ul><li><a href=#dependency-fields>Dependency fields</a></li><li><a href=#adding-dependencies>Adding dependencies</a></li><li><a href=#removing-dependencies>Removing dependencies</a></li><li><a href=#changing-dependencies>Changing dependencies</a></li><li><a href=#platform-specific-dependencies>Platform-specific dependencies</a></li><li><a href=#project-dependencies>Project dependencies</a></li><li><a href=#dependency-sources>Dependency sources</a></li><li><a href=#optional-dependencies>Optional dependencies</a></li><li><a href=#development-dependencies>Development dependencies</a></li><li><a href=#build-dependencies>Build dependencies</a></li><li><a href=#editable-dependencies>Editable dependencies</a></li><li><a href=#virtual-dependencies>Virtual dependencies</a></li><li><a href=#dependency-specifiers>Dependency specifiers</a></li></ul></li><li><a href=#using-workspace>Using workspace</a><ul><li><a href=#workspace-sources>Workspace sources</a></li><li><a href=#workspace-layouts>Workspace layouts</a></li><li><a href=#when-not-to-use-workspaces>When (not) to use workspaces</a></li></ul></li></ul></li></ul></nav></div></details></div><div class=post-content><p>这篇文章深入介绍 uv 管理 Python 项目的使用</p><h2 id=features>Features<a hidden class=anchor aria-hidden=true href=#features>#</a></h2><h4 id=python-versions>Python versions<a hidden class=anchor aria-hidden=true href=#python-versions>#</a></h4><ul><li><code>uv python install</code>: 安装 Python 版本</li><li><code>uv python list</code>: 查看可用的 Python 版本</li><li><code>uv python find</code>: 查找安装的 Python 版本</li><li><code>uv python pin</code>: 固定当前项目的 Python 版本</li><li><code>uv python uninstall</code>: 卸载一个 Python 版本</li></ul><h4 id=scripts>Scripts<a hidden class=anchor aria-hidden=true href=#scripts>#</a></h4><ul><li><code>uv run</code>: 运行一个脚本</li><li><code>uv add --script</code>: 为脚本添加一个依赖</li><li><code>uv remove --script</code>: 移除一个依赖</li></ul><h4 id=projects>Projects<a hidden class=anchor aria-hidden=true href=#projects>#</a></h4><p>使用 <code>pyproject.toml</code> 配置项目</p><ul><li><code>uv init</code>: 创建一个 Python 项目</li><li><code>uv add</code>: 为项目添加依赖</li><li><code>uv remove</code>: 删除项目依赖</li><li><code>uv sync</code>: 同步环境下的依赖</li><li><code>uv lock</code>: 为项目依赖创建一个锁文件</li><li><code>uv run</code>: 在项目环境执行命令</li><li><code>uv tree</code>: 查看项目依赖树</li><li><code>uv build</code>: 将项目构建为分发归档文件</li><li><code>uv publish</code>: 将项目发布到包索引</li></ul><h4 id=tools>Tools<a hidden class=anchor aria-hidden=true href=#tools>#</a></h4><p>允许与安装工具</p><ul><li><code>uvx / uv tool run</code>: 在临时环境运行一个工具</li><li><code>uv tool install</code>: 安装一个工具</li><li><code>uv tool uninstall</code>: 卸载一个工具</li><li><code>uv tool list</code>: 列出已安装工具</li><li><code>uv tool update-shell</code>: 更新 shell 以包含工具执行</li></ul><h4 id=the-pip-interface>The pip interface<a hidden class=anchor aria-hidden=true href=#the-pip-interface>#</a></h4><p>手动管理环境与包, 用于旧的工作流, 或一些高级命令功能</p><ul><li><code>uv venv</code>: 创建虚拟环境</li></ul><p>下面命令手动管理环境中的包 (替代 <code>pip</code> 和 <code>pipdeptree</code>)</p><ul><li><code>uv pip install</code>: 在当前环境安装包</li><li><code>uv pip show</code>: 显示已安装包的细节</li><li><code>uv pip freeze</code>: 列出安装的包以及版本</li><li><code>uv pip check</code>: 检查当前环境是否有兼容的软件包</li><li><code>uv pip list</code>: 列出已安装包</li><li><code>uv pip uninstall</code>: 卸载包</li><li><code>uv pip tree</code>: 查看环境依赖</li></ul><p>在环境中锁定包 (替代 <code>pip-tools</code>)</p><ul><li><code>uv pip compile</code>: 将依赖编译到一个锁文件中</li><li><code>uv pip sync</code>: 使用锁文件同步环境</li></ul><h4 id=utility>Utility<a hidden class=anchor aria-hidden=true href=#utility>#</a></h4><p>管理与检查 uv 的状态, 例如缓存、存储目录或子升级</p><ul><li><code>uv cache clean</code>: 清除缓存条目</li><li><code>uv cache prune</code>: 移除过期的缓存条目</li><li><code>uv cache dir</code>: 显示 uv 缓存目录的路径</li><li><code>uv tool dir</code>: 显示 uv 工具目录路径</li><li><code>uv python dir</code>: 显示 uv 安装的 Python 各版本路径</li><li><code>uv self update</code>: 更新 uv</li></ul><h2 id=projects-1>Projects<a hidden class=anchor aria-hidden=true href=#projects-1>#</a></h2><h3 id=structure-and-files>Structure and files<a hidden class=anchor aria-hidden=true href=#structure-and-files>#</a></h3><p>Python 项目依赖元数据定义在 <code>pyproject.toml</code> 中, uv 依赖这个文件来确定项目根目录.</p><p>一个最小的项目定义包含名称和版本</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span></code></pre></div><p>额外的项目元数据和配置包含:</p><ul><li><a href=https://docs.astral.sh/uv/concepts/projects/config/#python-version-requirement>Python version requirement</a></li><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/>Dependencies</a></li><li><a href=https://docs.astral.sh/uv/concepts/projects/config/#build-systems>Build system</a></li><li><a href=https://docs.astral.sh/uv/concepts/projects/config/#entry-points>Entry points</a></li></ul><h4 id=the-project-environment>The project environment<a hidden class=anchor aria-hidden=true href=#the-project-environment>#</a></h4><p>使用 uv 处理项目时, uv 会根据需要创建虚拟环境.
虽然某些 uv 命令会创建临时环境 (<code>uv run --isolated</code>), 但 uv 也会在 <code>pyproject.toml</code> 旁边的 <code>.venv</code> 目录中管理一个持久环境, 其中包含项目及其依赖项.
它存储在项目内部是为了方便编辑器查找, 编辑器需要环境来提供代码补全和类型提示.
不建议将 <code>.venv</code> 目录包含在版本控制中, 它会通过内部 <code>.gitignore</code> 文件自动从 git 中排除.</p><p>要在项目环境中运行命令, 应该使用 <code>uv run</code>.
或者, 项目环境可以像普通虚拟环境一样正常激活.</p><p>当调用 <code>uv run</code> 时, 如果项目环境尚不存在, 它将创建项目环境, 如果已存在则确保其是最新的.
项目环境也可以通过 <code>uv sync</code> 显式创建.</p><p>不建议手动修改项目环境, 例如使用 <code>uv pip install</code>.
对于项目依赖项, 使用 <code>uv add</code> 将包添加到环境中.
对于一次性需求, 使用 <code>uvx</code> 或 <code>uv run --with</code>.</p><blockquote><p>TIP 提示</p></blockquote><p>如果不希望 uv 管理项目环境, 设置 <code>managed = false</code> 来禁用项目的自动锁定和同步, 例如:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>managed</span> <span class=p>=</span> <span class=kc>false</span>
</span></span></code></pre></div><h4 id=the-lockfile>The lockfile<a hidden class=anchor aria-hidden=true href=#the-lockfile>#</a></h4><p>uv 会在 <code>pyproject.toml</code> 旁边创建一个 <code>uv.lock</code> 文件.</p><p><code>uv.lock</code> 是一个通用或跨平台锁文件, 它捕获在所有可能的 Python 标记 (操作系统、架构和Py版本) 上将要安装的包.</p><p>与用于指定项目广泛要求的 <code>pyproject.toml</code> 不同, 锁文件包含在项目环境中安装的确切解析版本.
此文件应检入版本控制, 以允许在不同机器上进行一致且可重现的安装.</p><p>锁文件确保从事项目工作的开发人员使用一致的包版本.
它确保在将项目部署为应用程序时，已知使用的确切包版本.</p><p>锁文件在使用项目环境的 uv 调用期间自动创建和更新, 即 <code>uv sync</code> 和 <code>uv run</code>.
锁文件也可以使用 <code>uv lock</code> 显式更新.</p><p>uv.lock 是一个人类可读的 TOML 文件, 但由 uv 管理, 不应手动编辑.
uv.lock 格式专用于 uv, 其他工具无法使用.</p><h4 id=relationship-to-pylocktoml>Relationship to <code>pylock.toml</code><a hidden class=anchor aria-hidden=true href=#relationship-to-pylocktoml>#</a></h4><p>在 PEP 751 中, Python 标准化了一种新的解析文件格式 <code>pylock.toml</code>.
<code>pylock.toml</code> 是一种解析输出格式，旨在替代 <code>requirements.txt</code>.
<code>pylock.toml</code> 是标准化的且与工具无关的, 这样在未来, uv 生成的 <code>pylock.toml</code> 文件可以由其他工具安装.
uv 的某些功能无法在 <code>pylock.toml</code> 格式中表达; 因此, uv 将继续在项目接口中使用 <code>uv.lock</code> 格式.</p><p>但是, uv 支持将 <code>pylock.toml</code> 作为导出目标以及在 <code>uv pip</code> CLI 中使用:</p><ul><li><code>uv export -o pylock.toml</code>: 将 <code>uv.lock</code> 导出为 <code>pylock.toml</code> 格式</li><li><code>uv pip compile -o pylock.toml -r requirements.in</code>: 一组要求生成 <code>pylock.toml</code> 文件</li><li><code>uv pip sync pylock.toml</code> 或 <code>uv pip install -r pylock.toml</code>: 从 <code>pylock.toml</code> 文件安装</li></ul><h3 id=creating-projects>Creating projects<a hidden class=anchor aria-hidden=true href=#creating-projects>#</a></h3><p>uv 支持使用 <code>uv init</code> 创建项目.
当创建项目时, uv 支持两种基本的模板: <a href=https://docs.astral.sh/uv/concepts/projects/init/#applications>applications</a> 和 <a href=https://docs.astral.sh/uv/concepts/projects/init/#libraries>libraries</a>.
默认 uv 会创建应用项目, 使用 <code>--lib</code> flag 可以创建 library 项目.</p><h4 id=target-directory>Target directory<a hidden class=anchor aria-hidden=true href=#target-directory>#</a></h4><p>uv 会在工作目录创建项目, 或者在目标目录, 例如 <code>uv init foo</code>.
如果这个位置已经存在项目了, uv 会退出并报错.</p><h4 id=applications>Applications<a hidden class=anchor aria-hidden=true href=#applications>#</a></h4><p>应用项目模板很适合 web 服务器、脚本和命令行接口. 该模板是默认的 <code>uv init</code> 生成目标, 也可以使用 <code>--app</code> flag 显示指定</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init example-app
</span></span></code></pre></div><p>项目结构包含一个 <code>pyproject.toml</code>、一个样本文件 <code>main.py</code> 一个 readme 和一个 Python 版本文件 <code>.python-version</code></p><p><code>pyproject.toml</code> 文件包含了基本的元数据.
不包含构建系统, 它不是一个包, 并且不会在环境中安装.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example-app&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>description</span> <span class=p>=</span> <span class=s2>&#34;Add your description here&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>readme</span> <span class=p>=</span> <span class=s2>&#34;README.md&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.11&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span></code></pre></div><p><code>main.py</code> 文件有类似下面的样板</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Hello from example-app!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><p>通过下面命令运行 python 代码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv run main.py
</span></span></code></pre></div><h4 id=packaged-applications>Packaged applications<a hidden class=anchor aria-hidden=true href=#packaged-applications>#</a></h4><p>如果是想要创建一个命令行工具, 并发布到 PyPI 上面, 可以使用 package 模板.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init --package example-pkg
</span></span></code></pre></div><p>如果要放到 <code>package/</code> 目录下面使用</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init --package packages/example-pkg
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init packages/exmaple-pkg
</span></span></code></pre></div><p><code>main.py</code> 被替换为 <code>src/</code> 目录, 该目录中会包含一个模块目录, 以及一个 <code>__init__.py</code> 文件.</p><p>Build system 被定义了, 因此该项目会被安装到环境中, <code>pyproject.toml</code> 类似下面这样:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example-pkg&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>description</span> <span class=p>=</span> <span class=s2>&#34;Add your description here&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>readme</span> <span class=p>=</span> <span class=s2>&#34;README.md&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.11&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>.</span><span class=nx>scripts</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>example-pkg</span> <span class=p>=</span> <span class=s2>&#34;example_pkg:main&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;uv_build&gt;=0.8.20,&lt;0.9.0&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;uv_build&#34;</span>
</span></span></code></pre></div><p>命令也被定义了, 可以使用下面这样命令运行 <code>uv run</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv run exmaple-pkg
</span></span></code></pre></div><h4 id=libraries>Libraries<a hidden class=anchor aria-hidden=true href=#libraries>#</a></h4><p>一个库提供函数和对象为其他项目使用.
库需要构建和分发, 例如上传到 PyPI.
使用 <code>--lib</code> flag 来创建库结构.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init --lib example-lib
</span></span></code></pre></div><p>类似 packaged application, 项目采用了 <code>src/</code> 布局, 其中包含一个 <code>py.typed</code> 标记文件, 用于告知使用者此库提供了类型注解信息.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example-lib&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>description</span> <span class=p>=</span> <span class=s2>&#34;Add your description here&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>readme</span> <span class=p>=</span> <span class=s2>&#34;README.md&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.11&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;uv_build&gt;=0.8.20,&lt;0.9.0&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;uv_build&#34;</span>
</span></span></code></pre></div><p>可以自行选择不同的构建后端, 使用 <code>--build-backend</code> 结合 <code>hatchling</code>, <code>uv_build</code>, <code>flitcore</code>, <code>pdm-backend</code>, <code>setuptools</code>, <code>maturin</code> 或 <code>scikit-build-core</code> 等使用.</p><p>创建的模块定义了一个简单的 API 函数 <code>__init__.py</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Hello from example-lib!&#34;</span>
</span></span></code></pre></div><p>然后可以使用 <code>uv run</code> 运行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv run python -c <span class=s2>&#34;import example_lib; print(example_lib.hello())&#34;</span>
</span></span></code></pre></div><h4 id=projects-with-extension-modules>Projects with extension modules<a hidden class=anchor aria-hidden=true href=#projects-with-extension-modules>#</a></h4><p>大多数 Python 项目都是 &ldquo;pure Python&rdquo;, 这意味着他们不使用其他语言定义模块, 例如 C, C++, FORTRAN 或 Rust.
然而, 使用扩展模块的项目通常在性能敏感的代码中使用.</p><p>创建一个扩展模块需要选择一个构建系统.
uv 支持下面的构建系统:</p><ul><li><code>maturin</code> 用于支持 Rust 项目</li><li><code>scikit-build-core</code>: 用于 C, C++, FORTRAN, Cython</li></ul><p>使用 <code>--build-backend</code> flag 指定构建系统</p><pre tabindex=0><code>uv init --build-backend maturin example-ext
</code></pre><p>这个项目包含一个 <code>Cargo.toml</code> 和一个 <code>src/lib.rs</code> 文件.</p><p>Rust 库定义了一个简单的函数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Rust data-lang=Rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>pyo3</span>::<span class=n>prelude</span>::<span class=o>*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cp>#[pyfunction]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>fn</span> <span class=nf>hello_from_bin</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;Hello from example-ext!&#34;</span><span class=p>.</span><span class=n>to_string</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cp>#[pymodule]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>fn</span> <span class=nf>_core</span><span class=p>(</span><span class=n>m</span>: <span class=kp>&amp;</span><span class=nc>Bound</span><span class=o>&lt;</span><span class=nb>&#39;_</span><span class=p>,</span><span class=w> </span><span class=n>PyModule</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>PyResult</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>add_function</span><span class=p>(</span><span class=fm>wrap_pyfunction!</span><span class=p>(</span><span class=n>hello_from_bin</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>)</span><span class=o>?</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>Ok</span><span class=p>(())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>并在 Python 模块中将其导入, <code>src/example-ext/__init__.py</code> 内容如下:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>example_ext._core</span> <span class=kn>import</span> <span class=n>hello_from_bin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>hello_from_bin</span><span class=p>())</span>
</span></span></code></pre></div><p>可以使用下面命令执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv run example-ext
</span></span></code></pre></div><h4 id=creating-a-minimal-project>Creating a minimal project<a hidden class=anchor aria-hidden=true href=#creating-a-minimal-project>#</a></h4><p>如果只想创建一个 <code>pyproject.toml</code> 使用 <code>--bare</code> 选项</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv init example --bare
</span></span></code></pre></div><h3 id=managing-dependencies>Managing dependencies<a hidden class=anchor aria-hidden=true href=#managing-dependencies>#</a></h3><h4 id=dependency-fields>Dependency fields<a hidden class=anchor aria-hidden=true href=#dependency-fields>#</a></h4><p>项目依赖由以下几个字段定义</p><ul><li><code>project.dependencies</code>: 发布的依赖</li><li><code>project.optional-dependencies</code>: 发布的可选依赖</li><li><code>dependency-groups</code>: 本地开发依赖</li><li><code>tool.uv.sources</code>: 开发依赖的可选源</li></ul><blockquote><p>NOTE</p></blockquote><p>项目的 <code>project.dependencies</code> 和 <code>project.optional-dependencies</code> 字段即使不发布也能使用.</p><p>uv 支持使用 <code>uv add</code> 和 <code>uv remove</code> 来定义项目依赖, 但也可以直接修改 <code>pyproject.toml</code>.</p><h4 id=adding-dependencies>Adding dependencies<a hidden class=anchor aria-hidden=true href=#adding-dependencies>#</a></h4><p>例如这样</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add httpx
</span></span></code></pre></div><p>可以添加一个项目依赖</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;httpx&gt;=0.27.2&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>使用 <code>--dev</code>, <code>--group</code>, <code>--optional</code> flag 可以用来为可选字段添加依赖.
依赖将会添加一个约束, 例如 <code>>=0.27.2</code>, 这是最近的兼容版本.
这样的约束可以使用 <code>--bounds</code> 调整, 或者直接提供约束.</p><pre tabindex=0><code class=language-tomo data-lang=tomo>uv add &#34;httpx&gt;=0.20&#34;
</code></pre><p>当从源添加一个依赖而不是 package registry 的时候, uv 会在源字段中添加一个条目, 例如下面从 GitHub 添加 <code>httpx</code>:</p><pre tabindex=0><code>uv add &#34;httpx @ git+https://github.com/encode/httpx&#34;
</code></pre><p>这会在 <code>pyproject.toml</code> 添加一个 Git 入口源:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;httpx&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>httpx</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>git</span> <span class=p>=</span> <span class=s2>&#34;https://github.com/encode/httpx&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><p>如果依赖无法添加, uv 将会输出一个报错.</p><ul><li>Importing dependencies from requirements files</li></ul><p>可以使用 <code>-r</code> 选项添加 <code>requirements.txt</code> 里面的依赖</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add -r requirements.txt
</span></span></code></pre></div><h4 id=removing-dependencies>Removing dependencies<a hidden class=anchor aria-hidden=true href=#removing-dependencies>#</a></h4><p>使用下面命令移除依赖</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv remove httpx
</span></span></code></pre></div><p>使用 <code>--dev</code>, <code>--group</code> 或 <code>--optional</code> flags 来移除其他特定的依赖.
如果被移除的依赖项定义了源, 并且没有其他依赖项引用它, 那么这个源也将被一并移除.</p><h4 id=changing-dependencies>Changing dependencies<a hidden class=anchor aria-hidden=true href=#changing-dependencies>#</a></h4><p>如果要修改现有的依赖, 可以这样</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add <span class=s2>&#34;httpx&gt;0.1.0&#34;</span>
</span></span></code></pre></div><p>使用一个不同的依赖源</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add <span class=s2>&#34;httpx @ .../httpx&#34;</span>
</span></span></code></pre></div><h4 id=platform-specific-dependencies>Platform-specific dependencies<a hidden class=anchor aria-hidden=true href=#platform-specific-dependencies>#</a></h4><p>为了使用只在具体平台的依赖或具体的 Python 版本, 使用 <a href=https://peps.python.org/pep-0508/#environment-markers>environment markers</a>.</p><p>例如, 只在 Linux 平台安装 <code>jax</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add <span class=s2>&#34;jax; sys_paltform == &#39;linux&#39;&#34;</span>
</span></span></code></pre></div><p>这会使 <code>pyproject.toml</code> 包含下面这样的定义</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;project&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.11&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;jax; sys_platform == &#39;linux&#39;&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>相似的, 只为 Python 3.11 之后的版本添加 <code>numpy</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add <span class=s2>&#34;numpy; python_version &gt;= &#39;3.11&#39;&#34;</span>
</span></span></code></pre></div><h4 id=project-dependencies>Project dependencies<a hidden class=anchor aria-hidden=true href=#project-dependencies>#</a></h4><p><code>project.dependencies</code> 代表上传到 PyPI 或者构建 wheel 使用的依赖.
单独依赖具体使用 <a href=https://packaging.python.org/en/latest/specifications/dependency-specifiers/>dependency specifiers</a> 语法, 并遵循 <a href=https://packaging.python.org/en/latest/specifications/pyproject-toml/>PEP 621</a> 标准.</p><p><code>project.dependencies</code> 定义了一个项目需要的依赖列表, 以及需要的版本限制.
每一项都包含一个项目名称和项目版本号, 有些项还包含额外的 environment markers, 例如:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;albatross&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=c># Any version in this range</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tqdm &gt;=4.66.2,&lt;5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c># Exactly this version of torch</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;torch ==2.2.2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c># Install transformers with the torch extra</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;transformers[torch] &gt;=4.39.3,&lt;5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c># Only install this package on older python version</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;importlib_metadata &gt;=7.1.0,&lt;8; python_version &lt; &#39;3.10&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;mollymawk ==0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h4 id=dependency-sources>Dependency sources<a hidden class=anchor aria-hidden=true href=#dependency-sources>#</a></h4><p><code>tool.uv.sources</code> 表是对标准依赖表的扩展, 增加了例如可编辑安装和相对路径.
例如, 从项目根目录的相对目录安装 <code>foo</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;foo&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>foo</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>path</span> <span class=p>=</span> <span class=s2>&#34;./package/foo&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><p>uv 支持下面几种依赖源:</p><ul><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/#index>Index</a>: 从特定包索引解析的包</li><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/#git>Git</a>: 一个 Git 仓库</li><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/#url>URL</a>: 一个远程的 wheel 包或源码分发包</li><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/#path>Path</a>: 一个本地 wheel, 源码包或项目目录</li><li><a href=https://docs.astral.sh/uv/concepts/projects/dependencies/#workspace-member>Workspace</a>: 当前工作空间的成员</li></ul><h4 id=optional-dependencies>Optional dependencies<a hidden class=anchor aria-hidden=true href=#optional-dependencies>#</a></h4><p>项目作为库发布时, 使一些功能称为可选的, 从而降低默认依赖树的大小, 这种做法很常见.
例如, Pandas 有额外的 excel extra 和 plot extra 包, 来避免安装 Excel 解析器和 matplotlib.
除非明确说明安装, Extras 使用 <code>package[&lt;extra>]</code> 语法指明, 例如 <code>pandas[plot, excel]</code>.</p><p>可选依赖具体在 <code>[project.optional-dependencies]</code> 中, 可选依赖可以像普通依赖一样在 <code>tool.uv.sources</code> 中替换源</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;pandas&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;1.0.0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>.</span><span class=nx>optional-dependencies</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>plot</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;matplotlib&gt;=3.6.3&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>excel</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;odfpy&gt;=1.4.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;openyxl&gt;=3.1.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;python-calamine&gt;=0.17&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pyxlsb&gt;=1.0.10&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;xlrd&gt;=2.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;xlsxwriter&gt;-3.0.5&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>如果要添加可选依赖, 使用 <code>--optional &lt;extra></code> 选项:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add httpx --optional network
</span></span></code></pre></div><p>源也可以声明为只适用特定的可选依赖项.
例如, 根据可选的 <code>cpu</code> 或 <code>gpu</code> 额外依赖项, 从不同的 PyTorch 索引来去 <code>torch</code> 包</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>.</span><span class=nx>optional-dependencies</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>cpu</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;torch&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>gpu</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;torch&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>torch</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>index</span> <span class=p>=</span> <span class=s2>&#34;torch-cpu&#34;</span><span class=p>,</span> <span class=nx>extra</span> <span class=p>=</span> <span class=s2>&#34;cpu&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>index</span> <span class=p>=</span> <span class=s2>&#34;torch-gpu&#34;</span><span class=p>,</span> <span class=nx>extra</span> <span class=p>=</span> <span class=s2>&#34;gpu&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>index</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;torch-cpu&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>url</span> <span class=p>=</span> <span class=s2>&#34;https://download.pytorch.org/whl/cpu&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>index</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;torch-gpu&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>url</span> <span class=p>=</span> <span class=s2>&#34;https://download.pytorch.org/whl/cu124&#34;</span>
</span></span></code></pre></div><h4 id=development-dependencies>Development dependencies<a hidden class=anchor aria-hidden=true href=#development-dependencies>#</a></h4><p>不同于可选依赖, 开发依赖只会在本地安装, 不会在发布到 PyPI 这样的项目依赖中生效.
因此, 开发依赖不包含在 <code>[project]</code> 表中.
同样地, 开发依赖也可以使用 <code>tool.uv.sources</code> 来指定源.</p><p>使用下面命令添加开发依赖</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add --dev pytest
</span></span></code></pre></div><p>uv 使用 <code>[dependency-groups]</code> 表来声明开发依赖, 上面命令会创建一个 <code>dev</code> 组</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>dependency-groups</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pytest &gt;=8.1.1&lt;9&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p><code>dev</code> 组是一个特例, 可以使用 <code>--dev</code>, <code>--only-dev</code> 和 <code>--no-dev</code> flags 来设置包含或排除依赖.</p><h5 id=dependency-groups>Dependency groups<a hidden class=anchor aria-hidden=true href=#dependency-groups>#</a></h5><p>开发环境可以被拆分成多个组, 使用 <code>--group</code> flag.
例如, 想要为开发依赖 <code>ruff</code> 加入 lint 组:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>uv add --group lint ruff
</span></span></code></pre></div><p>这会导致下面的 <code>[dependency-groups]</code> 定义:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>dependency-groups</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pytest&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>lint</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ruff&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>一但组被定义了, <code>--all-groups</code>, <code>--no-default-groups</code>, <code>--group</code>, <code>--only-group</code> 和 <code>--no-group</code> 选项可以用来包含和排除依赖.</p><p>uv 要求所有的依赖组之间是相互兼容的, 并且会在创建 lockfile 时解析所有的组.</p><p>如果一组的依赖和其他组的依赖不兼容, uv 会无法解析依赖并报错.</p><h5 id=nesting-groups>Nesting groups<a hidden class=anchor aria-hidden=true href=#nesting-groups>#</a></h5><p>一个依赖组可以包含其他依赖组, 例如:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>dependency-groups</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nx>include-group</span> <span class=p>=</span> <span class=s2>&#34;lint&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nx>include-group</span> <span class=p>=</span> <span class=s2>&#34;test&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>lint</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ruff&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>test</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pytest&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h5 id=default-groups>Default groups<a hidden class=anchor aria-hidden=true href=#default-groups>#</a></h5><p>默认情况下, uv 在环境中包含一个 <code>dev</code> 依赖组.
默认的组可以使用 <code>tool.uv.default-groups</code> 来设置:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>default-groups</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;dev&#34;</span><span class=p>,</span> <span class=s2>&#34;foo&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>要默认启用所有的组依赖, 使用 &ldquo;all&rdquo; 而不是列出所有的组名:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>default-groups</span> <span class=p>=</span> <span class=s2>&#34;all&#34;</span>
</span></span></code></pre></div><h5 id=requires-python-组><code>requires-python</code> 组<a hidden class=anchor aria-hidden=true href=#requires-python-组>#</a></h5><p>默认情况下, 依赖组必须和项目 <code>requires-python</code> 兼容.
如果一个依赖组需要不同的 Python 版本, 可以在 <code>[tool.uv.dependency-groups]</code> 里面指定 Python 版本.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;example&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.10&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>dependency-groups</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;pytest&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>dependency-groups</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev</span> <span class=p>=</span> <span class=p>{</span><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.12&#34;</span><span class=p>}</span>
</span></span></code></pre></div><h5 id=legacy-dev-dependencies>Legacy <code>dev-dependencies</code><a hidden class=anchor aria-hidden=true href=#legacy-dev-dependencies>#</a></h5><p>在 <code>[dependency-groups]</code> 成为标准之前, uv 使用 <code>tool.uv.dev-dependencies</code> 字段来指定开发依赖</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dev-dependencies</span> <span class=p>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pytest&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><h4 id=build-dependencies>Build dependencies<a hidden class=anchor aria-hidden=true href=#build-dependencies>#</a></h4><p>如果一个项目使用 <a href=https://docs.astral.sh/uv/concepts/projects/config/#build-systems>Python package</a> 的结构, 它可能需要构建项目的依赖, 但无需运行. 这类依赖是 <code>[build-system]</code>, 在 <code>build-system.requires</code> 下面, 详见 <a href=https://peps.python.org/pep-0518/>PEP 518</a>.</p><p>例如, 如果一个项目使用 <code>setuptools</code> 作为后端构建, 它应该声明 <code>setuptools</code> 作为一个构建依赖:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;pandas&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;setuptools&gt;=42&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;setuptools.build_meta&#34;</span>
</span></span></code></pre></div><p>默认情况下, uv 构建依赖的时候会检查 <code>tool.uv.sources</code>.
例如, 使用本地版本的 <code>setuptools</code> 进行构建, 将源添加进 <code>tool.uv.sources</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=nx>pandas</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;setuptools&gt;=42&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;setuptools.build_meta&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>setuptools</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>path</span> <span class=p>=</span> <span class=s2>&#34;./packages/setuptools&#34;</span> <span class=p>}</span>
</span></span></code></pre></div><p>当发布一个包的时候, 建议当 <code>tool.uv.sources</code> 被禁用时, 运行 <code>uv build --no-source</code> 来确保正确构建.
使用其他构建工具也是一样的, 例如 <code>pypa/build</code>.</p><h4 id=editable-dependencies>Editable dependencies<a hidden class=anchor aria-hidden=true href=#editable-dependencies>#</a></h4><p>常规的目录安装会先构建 wheel 包, 然后将该 wheel 包安装到虚拟环境中, 这回复制所有的源文件.
当包源文件被编译时, 虚拟环境中的版本将保持旧版本.</p><p>可编辑安装通过向虚拟环境内添加项目连接 (.pth 文件) 解决了这个问题, 该链接指示解释器直接包含源文件.
可编辑安装存在一些限制, 但对于开发常见非常实用, 因为虚拟环境会始终使用包的最新修改.</p><p>uv 默认对工作区包采用可编辑安装模式.</p><h4 id=virtual-dependencies>Virtual dependencies<a hidden class=anchor aria-hidden=true href=#virtual-dependencies>#</a></h4><p>uv 运行依赖项设置为"虚拟"模式, 在此模式下, 依赖项本身不会作为软件包被安装, 但其依赖关系会被正常处理.</p><p>默认情况下, 依赖项永远不会被视作虚拟依赖.</p><p>对于路径源的依赖项, 若显示设置 <code>tool.uv.package = false</code> 则可成为虚拟依赖.
与在依赖项目中使用 <code>uv</code> 工作不同, 即使未声明构建系统, 该软件包仍会被构建.</p><p>若要将某个依赖项视位虚拟依赖, 需要在其源配置中设置 <code>package = false</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;bar&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>bar</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>path</span> <span class=p>=</span> <span class=s2>&#34;../projects/bar&#34;</span><span class=p>,</span> <span class=nx>package</span> <span class=p>=</span> <span class=kc>false</span> <span class=p>}</span>
</span></span></code></pre></div><p>如果依赖设置 <code>tool.uv.package = false</code>, 则可以在 source 通过声明 <code>package = true</code> 来覆盖.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;bar&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>source</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>bar</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>path</span> <span class=p>=</span> <span class=s2>&#34;../projects/bar&#34;</span><span class=p>,</span> <span class=nx>package</span> <span class=p>=</span> <span class=kc>true</span> <span class=p>}</span>
</span></span></code></pre></div><p>同样地, 对于工作区源的依赖项, 若显式设置 <code>tool.uv.package = false</code> 也可成为虚拟依赖.
即使未声明构建系统, 该工作区成员仍会被构建.</p><p>对于非依赖项的工作区成员, 默认情况下可设置为虚拟模式, 例如, 若父级 <code>pyproject.toml</code> 文件配置如下:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;parent&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;1.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>workspace</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>members</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;child&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>并且 child 的 <code>pyproject.toml</code> 不含有构建系统.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;child&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;1.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;anyio&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>那么 <code>child</code> workspace 成员将不会被安装, 但是依赖 <code>anyio</code> 会被传递.</p><p>相对的, 如果父级声明了对 <code>child</code> 的依赖:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;parent&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;1.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;child&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>child</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>workspace</span> <span class=p>=</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>workspace</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>members</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;child&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>那么 <code>child</code> 将会被构建和安装.</p><h4 id=dependency-specifiers>Dependency specifiers<a hidden class=anchor aria-hidden=true href=#dependency-specifiers>#</a></h4><p>uv 采用最初由 <a href=https://peps.python.org/pep-0508/>PEP 508</a> 定义的依赖项限定符, 依赖项限定符按顺序包括以下组件:</p><ul><li>依赖项名称</li><li>所需额外功能</li><li>版本限定符</li><li>环境标记</li></ul><p>版本限定符通过逗号分割进行组合, 例如 <code>foo >=1.2.3,&lt;2,!=1.4.0</code> 表示 &ldquo;<code>foo</code> 的版本需不低于 1.2.3, 小于 2, 且不能是 1.4.0&rdquo;.
限定符会自动补零, 因此 <code>foo ==2</code> 也会匹配 foo 2.0.0.</p><p>星号可以用于等号匹配的最后一位数字, 例如 <code>foo ==2.1.*</code> 将接受 2.1 系列的所有版本.
类似地, <code>~=</code> 匹配最后一位数字相等或更高的版本, 例如 <code>foo ~=1.2</code> 等价于 <code>foo >=1.2,&lt;2</code>, 而 <code>foo ~=1.2.3</code> 等价于 <code>foo >=1.2.3,&lt;1.3</code>.</p><p>额外功能在名称和版本直接的方括号内用逗号分隔, 例如 <code>pandas[excel, plot] ==2.2</code>.
额外功能名称之间的空格会被忽略.</p><p>某些依赖项仅在特定环境中需要, 例如特定的 Python 版本或系统.
比如要为 <code>importlib.metadata</code> 模块安装 importlib-metadata 回溯包, 可使用 <code>importlib-metadata >=7.1.0,&lt;8; python_version &lt; '3.10'</code>.
要在 Windows 上安装 colorama 则可使用 <code>colorama >=0.4.6,&lt;5; platform_systemm == "Windows</code>.</p><p>环境标记通过 and, or 和括号进行组合, 例如</p><pre tabindex=0><code>aiohttp &gt;=3.7.4,&lt;4; (sys_paltform != &#39;win32&#39; or implementation_name != &#39;pypy&#39;) and python_version &gt;= &#39;3.10&#39;
</code></pre><p>注意标记内的版本需要加引号, 而标记外的版本不加引号.</p><h3 id=using-workspace>Using workspace<a hidden class=anchor aria-hidden=true href=#using-workspace>#</a></h3><p>工作空间受到 Cargo 的同名概念启发, 即将一个或多个包一起管理, 叫做 workspace.</p><p>Workspace 通过将项目拆分多个包和相同的依赖, 从而组织大型代码库.
例如, 有一个 FastAPI 的 web 应用, 和一些列的由不同的 Python 包维护的库, 都放在同一个 Git 仓库中.
在一个 workspace 中, 每个包定义自己的 <code>pyproject.toml</code> 文件, 但是工作空间共享同一个 lockfile, 以确保工作空间内的依赖一致.</p><p>在定义 workspace 的时候, 必须要指定 <code>members</code> (必填) 和 <code>exclude</code> (可选) 键, 他们分别用于指示工作区包含或排除特定目录作为成员, 并接受通配符列表:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;albatross&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.12&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;bird-feeder&#34;</span><span class=p>,</span> <span class=s2>&#34;tqdm&gt;=4,&lt;5&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>brid-feeder</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>workspace</span> <span class=p>=</span> <span class=kc>true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>workspace</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>members</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;packages/*&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>exclude</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;packages/seeds&#34;</span><span class=p>]</span>
</span></span></code></pre></div><p>由 <code>members</code> 通配符包含的每个目录都必须包含一个 <code>pyproject.toml</code> 文件.
不过, 工作区成员即可以是应用程序, 也可以是库, 这两种类型在工作区环境中都支持.</p><p>每个工作区都需要一个根目录, 该目录同时也是工作区成员.
在上面示例中, <code>albatross</code> 是工作区根目录, 工作区成员包括 <code>packages</code> 目录下面除 <code>seeds</code> 以外的所有项目.</p><p>默认情况下, <code>uv run</code> 和 <code>uv sync</code> 命令会作用于工作区根目录.
例如上例中, <code>uv run</code> 与 <code>uv run --package albatross</code> 是等效的, 而 <code>uv run --package bird-feeder</code> 则会在 <code>bird-feeder</code> 包中执行命令.</p><h4 id=workspace-sources>Workspace sources<a hidden class=anchor aria-hidden=true href=#workspace-sources>#</a></h4><p>在一个 workspace 内, 对工作区成员的依赖通过 <code>tool.uv.sources</code> 实现, 例如:</p><pre tabindex=0><code>[project]
name = &#34;albatross&#34;
version = &#34;0.1.0&#34;
requires-python = &#34;&gt;=3.12&#34;
dependencies = [&#34;bird-feeder&#34;, &#34;tqdm&gt;=4,&lt;5&#34;]

[tool.uv.sources]
bird-feeder = { workspace = true }

[tool.uv.workspace]
members = [&#34;packages/*&#34;]

[build-system]
requires = [&#34;uv_build&gt;=0.8.20,&lt;0.9.0&#34;]
</code></pre><p>在此示例中, albatross 项目依赖于同属工作区的 bird-feeder 项目.
<code>tool.uv.sources</code> 表中 <code>workspace = true</code> 的键值对表明, bird-feeder 依赖应由工作区提供, 而非 PyPI 或其他注册源获取.</p><p>工作区根目录中的任何 <code>tool.uv.sources</code> 定义将适用于所有成员, 除非在特定成员的 <code>tool.uv.sources</code> 中被覆盖.</p><h4 id=workspace-layouts>Workspace layouts<a hidden class=anchor aria-hidden=true href=#workspace-layouts>#</a></h4><p>最常见的工作区布局可以是一个根目录和一系列的库组成.
例如, 接着上面的例子, 工作区间有一个根目录 <code>albatross</code>, 以及 <code>packages</code> 目录下面的两个库 <code>bird-feeder</code> 和 <code>seed</code>.</p><pre tabindex=0><code>albatross
├── packages
│   ├── bird-feeder
│   │   ├── pyproject.toml
│   │   └── src
│   │       └── bird_feeder
│   │           ├── __init__.py
│   │           └── foo.py
│   └── seeds
│       ├── pyproject.toml
│       └── src
│           └── seeds
│               ├── __init__.py
│               └── bar.py
├── pyproject.toml
├── README.md
├── uv.lock
└── src
    └── albatross
        └── main.py
</code></pre><p>由于 <code>seeds</code> 被 <code>pyproject.toml</code> 排除在外, 故该工作区一共有两个成员: <code>albatross</code> 和 <code>bird-feeder</code>.</p><h4 id=when-not-to-use-workspaces>When (not) to use workspaces<a hidden class=anchor aria-hidden=true href=#when-not-to-use-workspaces>#</a></h4><p>Workspaces 是为了促进同一仓库下的多个包之间内部连接的开发.
当代码库逐渐变复杂, 将其切分成更小的可组合的包将十分有用.
每个包都有自己的依赖和版本限制.</p><p>工作区有助于执行隔离和分离问题.
例如, 在 uv 中, 有分离的 core 包和命令行界面, 这使得我们可以分开测试 core 包和 CLI, 反之亦然.</p><p>其他常见工作区间使用包括:</p><ul><li>在模块中实现了性能关键的扩展库</li><li>插件系统库, 每个插件是一个分离的 workspace 包和一个根目录下的依赖</li></ul><p>工作区模式不适用于成员之间存在需求冲突, 或需要为每个成员创建独立虚拟环境的场景.
此类情况下, 路径依赖通常是更优选择.
例如, 无需将 albatross 及其相关组件强制归入同一工作区, 可以将每个软件包定义为独立项目, 并通过在 <code>tool.uv.sources</code> 中配置路径依赖来定义包间依赖关系.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>project</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>name</span> <span class=p>=</span> <span class=s2>&#34;albatross&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>version</span> <span class=p>=</span> <span class=s2>&#34;0.1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>requires-python</span> <span class=p>=</span> <span class=s2>&#34;&gt;=3.12&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>dependencies</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;bird-feeder&#34;</span><span class=p>,</span> <span class=s2>&#34;tqdm&gt;=4,&lt;5&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>tool</span><span class=p>.</span><span class=nx>uv</span><span class=p>.</span><span class=nx>sources</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>bird-feeder</span> <span class=p>=</span> <span class=p>{</span> <span class=nx>path</span> <span class=p>=</span> <span class=s2>&#34;packages/bird-feeder&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>build-system</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>requires</span> <span class=p>=</span> <span class=p>[</span><span class=s2>&#34;uv_build&gt;=0.8.20,&lt;0.9.0&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>build-backend</span> <span class=p>=</span> <span class=s2>&#34;uv_build&#34;</span>
</span></span></code></pre></div><p>这种方法能带来许多相同优势, 同时运行依赖解析和虚拟环境管理进行更精细的控制 (但无法使用 <code>uv run --package</code> 命令, 需要从对应软件目录运行命令).</p><p>最后, uv 的工作区强制要求整个工作区间采用统一的 <code>requires-python</code> 配置, 该配置取所有 <code>requires-python</code> 值的交集.
如果需要给某个成员测试工作区其他成员不支持的 Python 版本, 可能需要使用 <code>uv pip</code> 将该成员安装到独立的虚拟环境中.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://starslayerx.github.io/tags/python/>Python</a></li></ul><nav class=paginav><a class=prev href=https://starslayerx.github.io/posts/docker-containers/><span class=title>« Prev</span><br><span>Docker - Containers</span>
</a><a class=next href=https://starslayerx.github.io/posts/morden-javascript-tutorial-chapter-2-fundamentals-11~18/><span class=title>Next »</span><br><span>Morden Javascript Tutorial Chapter 2 - Fundamentals: 11~18</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on x" href="https://x.com/intent/tweet/?text=uv%20-%20Python%20package%20manager&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f&amp;hashtags=Python"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f&amp;title=uv%20-%20Python%20package%20manager&amp;summary=uv%20-%20Python%20package%20manager&amp;source=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f&title=uv%20-%20Python%20package%20manager"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on whatsapp" href="https://api.whatsapp.com/send?text=uv%20-%20Python%20package%20manager%20-%20https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on telegram" href="https://telegram.me/share/url?text=uv%20-%20Python%20package%20manager&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share uv - Python package manager on ycombinator" href="https://news.ycombinator.com/submitlink?t=uv%20-%20Python%20package%20manager&u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fuv-python-package-manager%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://starslayerx.github.io/>Starslayerx' Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>