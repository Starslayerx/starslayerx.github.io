<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Docker - Images and Registeries | Starslayerx' Blog</title><meta name=keywords content="Docker"><meta name=description content="The Docker Images | Docker 镜像
Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.
镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行.
就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.
可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.
Pulling and Inspecting an Image 拉取并查看镜像
镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像
% docker pull celery:latest
latest: Pulling from library/celery
ef0380f84d05: Pull complete
ada810c79ed7: Pull complete
4608a1c4fe47: Pull complete
58086cbb21fb: Pull complete
a7bccb4a3faa: Pull complete
9de06a08ec25: Pull complete
ad6feb8c6a6b: Pull complete
7568ca85d492: Pull complete
2d6f458f7411: Pull complete
Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31
Status: Downloaded newer image for celery:latest
docker.io/library/celery:latest

What's next:
    View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest
现在查看镜像信息"><meta name=author content="Starslayerx"><link rel=canonical href=https://starslayerx.github.io/posts/docker-images-and-registeries/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=16x16 href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://starslayerx.github.io/favicon.svg><link rel=apple-touch-icon href=https://starslayerx.github.io/favicon.svg><link rel=mask-icon href=https://starslayerx.github.io/favicon.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://starslayerx.github.io/posts/docker-images-and-registeries/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://starslayerx.github.io/posts/docker-images-and-registeries/"><meta property="og:site_name" content="Starslayerx' Blog"><meta property="og:title" content="Docker - Images and Registeries"><meta property="og:description" content="The Docker Images | Docker 镜像 Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.
镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行. 就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.
可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.
Pulling and Inspecting an Image 拉取并查看镜像 镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像
% docker pull celery:latest latest: Pulling from library/celery ef0380f84d05: Pull complete ada810c79ed7: Pull complete 4608a1c4fe47: Pull complete 58086cbb21fb: Pull complete a7bccb4a3faa: Pull complete 9de06a08ec25: Pull complete ad6feb8c6a6b: Pull complete 7568ca85d492: Pull complete 2d6f458f7411: Pull complete Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31 Status: Downloaded newer image for celery:latest docker.io/library/celery:latest What's next: View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest 现在查看镜像信息"><meta property="og:locale" content="en-US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-05T08:00:00+08:00"><meta property="article:modified_time" content="2025-09-05T08:00:00+08:00"><meta property="article:tag" content="Docker"><meta property="og:image" content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:title content="Docker - Images and Registeries"><meta name=twitter:description content="The Docker Images | Docker 镜像
Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.
镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行.
就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.
可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.
Pulling and Inspecting an Image 拉取并查看镜像
镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像
% docker pull celery:latest
latest: Pulling from library/celery
ef0380f84d05: Pull complete
ada810c79ed7: Pull complete
4608a1c4fe47: Pull complete
58086cbb21fb: Pull complete
a7bccb4a3faa: Pull complete
9de06a08ec25: Pull complete
ad6feb8c6a6b: Pull complete
7568ca85d492: Pull complete
2d6f458f7411: Pull complete
Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31
Status: Downloaded newer image for celery:latest
docker.io/library/celery:latest

What's next:
    View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest
现在查看镜像信息"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://starslayerx.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Docker - Images and Registeries","item":"https://starslayerx.github.io/posts/docker-images-and-registeries/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Docker - Images and Registeries","name":"Docker - Images and Registeries","description":"The Docker Images | Docker 镜像 Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.\n镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行. 就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.\n可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.\nPulling and Inspecting an Image 拉取并查看镜像 镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像\n% docker pull celery:latest latest: Pulling from library/celery ef0380f84d05: Pull complete ada810c79ed7: Pull complete 4608a1c4fe47: Pull complete 58086cbb21fb: Pull complete a7bccb4a3faa: Pull complete 9de06a08ec25: Pull complete ad6feb8c6a6b: Pull complete 7568ca85d492: Pull complete 2d6f458f7411: Pull complete Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31 Status: Downloaded newer image for celery:latest docker.io/library/celery:latest What\u0026#39;s next: View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest 现在查看镜像信息\n","keywords":["Docker"],"articleBody":"The Docker Images | Docker 镜像 Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.\n镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行. 就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.\n可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.\nPulling and Inspecting an Image 拉取并查看镜像 镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像\n% docker pull celery:latest latest: Pulling from library/celery ef0380f84d05: Pull complete ada810c79ed7: Pull complete 4608a1c4fe47: Pull complete 58086cbb21fb: Pull complete a7bccb4a3faa: Pull complete 9de06a08ec25: Pull complete ad6feb8c6a6b: Pull complete 7568ca85d492: Pull complete 2d6f458f7411: Pull complete Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31 Status: Downloaded newer image for celery:latest docker.io/library/celery:latest What's next: View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest 现在查看镜像信息\n% docker image inspect celery 这个命令会以 JSON 格式输出关于镜像的详细信息\n[ { \"Id\": \"sha256:e111a70eee6a42a68768ec0734a6b2f1ceab34b27e4c4325ed6a14d4f36c2568\", \"RepoTags\": [ \"celery:latest\" ], \"RepoDigests\": [ \"celery@sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31\" ], \"Parent\": \"\", \"Comment\": \"\", \"Created\": \"2017-06-19T16:53:14.832853892Z\", \"DockerVersion\": \"17.03.1-ce\", \"Author\": \"\", \"Architecture\": \"amd64\", \"Os\": \"linux\", \"Size\": 215773711, \"GraphDriver\": { \"Data\": { \"LowerDir\": \"/var/lib/docker/overlay2/48895e03352004bc8ce3d6a639e808ba64b209349af83a3c75b481be2ed94938/diff:/var/lib/docker/overlay2/c845387bc00200c8fb7eb3e3305dba41fdb4ff2d9aa6c085fb0a6ad24c290c73/diff:/var/lib/docker/overlay2/17756520f50f2cbf3e556f44abb1c0b5b6789cd6f6df47246baaabcc3c14d8e0/diff:/var/lib/docker/overlay2/4d0e644e7332550ce97905e7784f5d9f96d9213c774a7204e2fd8b8aa3b11035/diff:/var/lib/docker/overlay2/5d44ed5515c803cd01048443fc3fa4d3372b48fb956d7574513f72a83ab83f66/diff:/var/lib/docker/overlay2/72ff0fa932bdc072f1beb1bc8ff782dc4b1fbde9a658307a698d4e0160d92797/diff:/var/lib/docker/overlay2/78b31a20c2e61a0d663de9c13830def1ae6d14c106dd3a78a581e0e40e7b4689/diff:/var/lib/docker/overlay2/d137d2107e48055ec9dcb33a81a136f0c6625f5e0a7439d1ccd972df8266edce/diff\", \"MergedDir\": \"/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/merged\", \"UpperDir\": \"/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/diff\", \"WorkDir\": \"/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/work\" }, \"Name\": \"overlay2\" }, \"RootFS\": { \"Type\": \"layers\", \"Layers\": [ \"sha256:007ab444b234be691d8dafd51839b7713324a261b16e2487bf4a3f989ded912d\", \"sha256:e2a576046222da3c29f237fa2d751d18c7a8f875ddc32fc803466aeaf998b9ee\", \"sha256:b5fa8e7e036448cb8c431f6b28eb1fbc4573c9330b197c7a0ba8e2292fa9fc2f\", \"sha256:4437df14034b8c6be5537d719f45f305b8e3365e01abe23a2207ba0963618214\", \"sha256:2b3426b547f7dade968deaaed73f75d25a883f6688f817ec0c3d1999b2a5c7cf\", \"sha256:df324182704a2a1f6229c5712619b2f2f8e5c0e79c1c90c97b99f2c9e8f0a22d\", \"sha256:bfac39c3713affaa50703d23c5a3dfd7a4f54bdae75af9ea23551cf221b3ae7c\", \"sha256:5c5a2dec46e80510abd744b0d469feaa20a5c10d70c937748509577c5a280dfb\", \"sha256:e4cff87cc854a86536342699faf3e67ce0c2ccf4b735d9998991a024e6fe4db6\" ] }, \"Metadata\": { \"LastTagTime\": \"0001-01-01T00:00:00Z\" }, \"Config\": { \"ArgsEscaped\": true, \"Cmd\": [ \"celery\", \"worker\" ], \"Entrypoint\": null, \"Env\": [ \"PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\", \"LANG=C.UTF-8\", \"GPG_KEY=97FC712E4C024BBEA48A61ED3A5CA953F73C700D\", \"PYTHON_VERSION=3.5.3\", \"PYTHON_PIP_VERSION=9.0.1\", \"CELERY_VERSION=3.1.25\", \"CELERY_BROKER_URL=amqp://guest@rabbit\" ], \"Labels\": null, \"OnBuild\": null, \"User\": \"user\", \"Volumes\": null, \"WorkingDir\": \"/home/user\" } } ] Docker 引擎在从镜像创建容器时, 会使用这个 JSON 对象, 该对象包含许多属性, 例如:\nId: 镜像的唯一标识符 RepoTags: 关联的标签 RepoDigests: 镜像的分发摘要 (用于校验) Created: 镜像创建时间戳 Author: 镜像创建者 当使用 docker image pull 命令而没有指定 tag 或版本时, Docker 会自动拉取以 latest 标记的镜像.\n这里一般是最新版本, 但注意 latest 知识一直约定, 并非所有镜像最新版本的 tag 都是 latest\nThe Layers Property | Layers 属性 镜像 JSON 对象中最关键的属性之一是 Layers, 如下\n{ \"Type\": \"layers\", \"Layers\": [ \"sha256:007ab444b234be691d8dafd51839b7713324a261b16e2487bf4a3f989ded912d\", \"sha256:e2a576046222da3c29f237fa2d751d18c7a8f875ddc32fc803466aeaf998b9ee\", \"sha256:b5fa8e7e036448cb8c431f6b28eb1fbc4573c9330b197c7a0ba8e2292fa9fc2f\", \"sha256:4437df14034b8c6be5537d719f45f305b8e3365e01abe23a2207ba0963618214\", \"sha256:2b3426b547f7dade968deaaed73f75d25a883f6688f817ec0c3d1999b2a5c7cf\", \"sha256:df324182704a2a1f6229c5712619b2f2f8e5c0e79c1c90c97b99f2c9e8f0a22d\", \"sha256:bfac39c3713affaa50703d23c5a3dfd7a4f54bdae75af9ea23551cf221b3ae7c\", \"sha256:5c5a2dec46e80510abd744b0d469feaa20a5c10d70c937748509577c5a280dfb\", \"sha256:e4cff87cc854a86536342699faf3e67ce0c2ccf4b735d9998991a024e6fe4db6\" ] } What is Layer? | 什么是 Layer? 文章开头提到镜像包含所有必要信息(依赖 配置等), 在 Docker 中, 模块化和解耦是关键原则. Docker 中的 layer 本质是一组文件(或单个文件), 例如一个 Python 应用可能需要:\nPython 二进制文件 apt 包管理器 / 所需系统工具 最后是应用文件 (又一个 layer) layer 的好处在于: 一旦创建并存储了 Python 二进制的 layer, 任何需要它的镜像都可以直接引用它的位置. Docker 会按需获取它, 如果世界另一端的某人也需要相同的 Python Layer, 他们不需要重新创建或重复上传该层, 可以直接使用相同的 Layer. 这种做法运行我们共享、重用并高效管理资源. 更棒的是, 分层让本地的更加高效, 如果机器的另一个镜像已经下载了一些 layer, Docker 会智能地复用这些已存在的 layer, 而不是重复下载.\n简单来说: Layer 是一组文件, 而 Image 指明了它包含哪些层, 以及他们如何堆叠. 层的顺序很重要, 因为上层的文件可以屏蔽下层的文件.\n但是, 容器本身并不知道层或文件在层中的组织方式, 容器看到的是一个完整的文件系统. 这由 Docker 的存储驱动完成: 它将所有层的文件收集合并, 为容器呈现一个单一的文件系统.\n例如下面两个数据库镜像\n$ docker pull redis Using default tag: latest latest: Pulling from library/redis af302e5c37e9: Pull complete # \u003c\u003c\u003c\u003c----- [1] 01b95e092fd0: Pull complete c111ca53a743: Pull complete f7d6cf14046e: Pull complete 589f36d317d9: Pull complete 94041d0cae8f: Pull complete 4f4fb700ef54: Pull complete 4f5f785c9703: Pull complete Digest: sha256:ca65ea36ae16e709b0f1c7534bc7e5b5ac2e5bb3c97236e4fec00e3625eb678d Status: Downloaded newer image for redis:latest docker.io/library/redis:latest $ docker pull postgres Using default tag: latest latest: Pulling from library/postgres af302e5c37e9: Already exists # \u003c\u003c\u003c\u003c----- Check this out, this layer was already fetched in [1] 23db180a1f67: Pull complete dc59dd9c8eb3: Pull complete aec09e638045: Pull complete 4dd47a683737: Pull complete 7cebbe7849b3: Pull complete dc4330b02129: Pull complete 498cc40b9fe9: Pull complete 6d3411bb4696: Pull complete 8f14f34d54d3: Pull complete 88d4f7416643: Pull complete e91ad5cfb8d0: Pull complete e0c4d5055fb9: Pull complete 254ee626d709: Pull complete Digest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae Status: Downloaded newer image for postgres:latest docker.io/library/postgres:latest Base Layer 基础层 镜像中的 base layer 就像建筑的地基, 它是后续构建的起点. 通常 base layer 包含操作系统或运行环境所需的基础文件和工具. 每个 Docker 镜像都以 base layer 开始, 后续层在其基础上构建. 这个基础层保证了一致性, 并为应用提供了稳定的运行环境. 由于 base layer 可以在做个镜像之间重复使用, Docker 只需下载并存储一份, 从而提高效率并节省空间. 在上面的 Redis / Postgres 示例中, af302e5c37e9 就是 base layer.\nDigests 摘要 如前所述, layer 是可重用的, 所以 Docker 需要一种系统来高效存储、组织和定位他们. 这些数字就是 layer 的唯一地址, 使得他们可以被识别和重用, 每个 layer 都有一个基于其内容计算出来的哈希值, 准确的说是该层的 content-addressable identifier 内容寻址.\nDocker 会为 layer 中的每个文件计算哈希, 然后生成该 layer 的合并哈希. 这个哈希确保 layer 是唯一可寻址的, 从而让镜像可以指向它\n如果某个 layer 中的文件被更新了, 文件的哈希会改变, layer 的合并哈希也会改变, 而产生一个全新的、唯一的 layer.\nImage Digests 镜像摘要 $ docker pull postgres Using default tag: latest latest: Pulling from library/postgres af302e5c37e9: Already exists 23db180a1f67: Pull complete ... 254ee626d709: Pull complete Digest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae #\u003c----- Distribution Hash Status: Downloaded newer image for postgres:latest docker.io/library/postgres:latest 每个镜像由一系列 layer 构成, 每个 layer 有自己的哈希, 这意味着整个镜像也可以有一个用于识别它的唯一哈希, 在 layer 列表后看到的那个值就是\nDigest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae 这个就是 image digest, 是整个镜像的唯一哈希值.\n镜像通常按名字拉取, 但 digest 在安全性方面非常关键, 用于确认拉取的镜像没有被篡改, 保证镜像的安全与真实性.\n镜像有两种类型的 digest 值:\nDistribution Digest: 压缩后镜像的哈希, 用于传输阶段 Content Digest: 每个未压缩 layer 的内容哈希 The Role of Comparession and Digest Verification 压缩与摘要检验的角色 在将镜像推送到 registry 之前, Docker 会对 layer 和镜像进行压缩以节省存储和网络流量. 压缩后会计算一个哈希, 并将其发送给 registry. registry 会基于接收到的内容, 重新计算哈希并与 DOcker 发来的哈希比较. 这个哈下就是 Distribution Digest. 当另一端拉取镜像时, Docker 会计算接收到内容的哈希并与原始的 Distribution Digest 比对, 确保镜像在传输过程中未被篡改.\n# Content Hash $ docker image inspect redis ... \"RootFS\": { \"Type\": \"layers\", \"Layers\": [ \"sha256:f5fe472da25334617e6e6467c7ebce41e0ae5580e5bd0ecbf0d573bacd560ecb\", # \u003c--- Content Digest \"sha256:3e62a323d3749bd1fc58ef850f0d6e5a9c901f71cc160426da9f6fb7507293ef\", \"sha256:b5a15fcf554ab5310928776fceacdc57d225c145d96a3d3b62382a31684a6c7e\", ..., \"sha256:ca15e9bb0d852a5e8c1d4c3264fa085f68197056b80da09003764bfa6dda5067\" ] }, # Distribution hash $ docker images --digests redis redis latest sha256:ca65ea36ae16e709b0f1c7534bc7e5b5ac2e5bb3c97236e4fec00e3625eb678d 4075a3f8c3f8 13 days ago 117MB Image Registry 镜像仓库 镜像仓库是容器镜像的存储中心, 各类软件, 像 Redis、Postgres、Node.js 这样的热门软件会把他们的容器化版本存放在这里. 这些仓库让用户可以方便地随时访问这些镜像, 虽然存在许多仓库, 但最广泛的是 Docker 的镜像仓库 - Docker Hub.\n当运行类似 docker pull 的命令时, 其实在使用一个简写. 完整的命令包含注册中心 registry, 组织 organization 和标签 tag, 如下所示:\ndocker pull //: # 例如 # docker pull docker.io/library/redis:latest # docker pull docker.io/fredj/sample:1.0 当省略某些细节时, Docker 会做一些默认假设来补全:\nRegistry \u0026 Organization: 如果不指定, docker 默认使用 Docker Hub (docker.io), 并假设官方镜像位于 library 组织下 Tag: 如果不提供 tag, Docker 会拉取标记为 latest 的镜像 Repository: The Heart of the Registry | 仓库: 镜像仓库的核心 仓库 repository 是镜像仓库中的核心单位. 每个 registry 托管多个 repository, 每个 repository 代表一个应用或工具, 例如 redis、postgres、alpine、node. 在一个 repository 下可以有多个 tag, 每个 tag 对应镜像的一个具体版本.\n有点类似 Git: Docker 的 repository 有点类似, 可以包含多个带标签的版本. 例如:\nRedis 在 GitHub 上带有标签的发布 类似的, Docker 上的 Redis 仓库也有标签 Two Types of Repositories on Docker Hub | Docker Hub 上的两类仓库 官方仓库 Offical Repositories\n这些是经过 Docker 官方策划与验证的高质量镜像, 位于仓库的顶层, 因此可以不写组织名直接拉取, 例如:\ndocker pull ubuntu 这些官方仓库包含像 Redis、Ubuntu、Python、Node.js 等流行工具的镜像\nRegular Repositories 普通仓库\n这些由个人、团队或组织创建, 拉取普通仓库的镜像时通常需要指定组织, 例如:\ndocker pull mycompany/sample:1.0 Other Registries 其他仓库 虽然 Docker Hub 是默认选项, 但他并非唯一选择, 还有很多其他仓库, 例如:\nAWS Elastic Container Registry (ECR) Google Container Registry (GCR) GitHub Container Registry (GHCR) 从这些仓库拉取镜像时, 需要在命令中指定 registry 名称, 例如:\ndocker pull //: # 例如 # docker pull ghcr.io/myteam/myapp:1.0 不同的镜像仓库之所以能无缝工作, 是因为遵循了 OCI 标准, 它定义了镜像的创建与分发方式. 两个关键标准是:\nImage Specification: 定义容器镜像如何创建, 像一个通用的镜像蓝图规范 Distribution Specification: 规定镜像如何在注册中心之间共享和分发 只要注册中心和镜像遵循这些标准, 使用什么工具制作镜像, 把镜像发布到哪个 registry, 都能互相兼容, 像魔法一样地协同工作.\nConclusion 结论 Docker 镜像与层构成了容器化应用开发的骨干. 理解镜像如何构建, 存储与分发是掌握 Docker 的重要一步. 这些概念不仅是理论上的, 还是让容器轻量、可重用并高效的实用工具.\n","wordCount":"890","inLanguage":"en","image":"https://starslayerx.github.io/images/og-default.avif","datePublished":"2025-09-05T08:00:00+08:00","dateModified":"2025-09-05T08:00:00+08:00","author":{"@type":"Person","name":"Starslayerx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://starslayerx.github.io/posts/docker-images-and-registeries/"},"publisher":{"@type":"Organization","name":"Starslayerx' Blog","logo":{"@type":"ImageObject","url":"https://starslayerx.github.io/favicon.svg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://starslayerx.github.io/ accesskey=h title="Starslayerx' Blog (Alt + H)"><img src=https://starslayerx.github.io/favicon.svg alt aria-label=logo height=35>Starslayerx' Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://starslayerx.github.io/zh-cn/ title=简体中文 aria-label=简体中文>Zh-Cn</a></li></ul></div></div><ul id=menu><li><a href=https://starslayerx.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://starslayerx.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://starslayerx.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://starslayerx.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://starslayerx.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://starslayerx.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://starslayerx.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Docker - Images and Registeries</h1><div class=post-meta><span title='2025-09-05 08:00:00 +0800 +0800'>September 5, 2025</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>890 words</span>&nbsp;·&nbsp;<span>Starslayerx</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#the-docker-images--docker-镜像>The Docker Images | Docker 镜像</a><ul><li><a href=#pulling-and-inspecting-an-image-拉取并查看镜像>Pulling and Inspecting an Image 拉取并查看镜像</a></li><li><a href=#the-layers-property--layers-属性>The Layers Property | Layers 属性</a></li><li><a href=#what-is-layer--什么是-layer>What is Layer? | 什么是 Layer?</a></li><li><a href=#base-layer-基础层>Base Layer 基础层</a></li><li><a href=#digests-摘要>Digests 摘要</a></li><li><a href=#image-digests-镜像摘要>Image Digests 镜像摘要</a></li><li><a href=#the-role-of-comparession-and-digest-verification-压缩与摘要检验的角色>The Role of Comparession and Digest Verification 压缩与摘要检验的角色</a></li><li><a href=#image-registry-镜像仓库>Image Registry 镜像仓库</a></li><li><a href=#repository-the-heart-of-the-registry--仓库-镜像仓库的核心>Repository: The Heart of the Registry | 仓库: 镜像仓库的核心</a></li><li><a href=#two-types-of-repositories-on-docker-hub--docker-hub-上的两类仓库>Two Types of Repositories on Docker Hub | Docker Hub 上的两类仓库</a></li><li><a href=#other-registries-其他仓库>Other Registries 其他仓库</a></li></ul></li><li><a href=#conclusion-结论>Conclusion 结论</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=the-docker-images--docker-镜像>The Docker Images | Docker 镜像<a hidden class=anchor aria-hidden=true href=#the-docker-images--docker-镜像>#</a></h3><p>Image、OCI Image、Docker Image、Container Image 都是指同一个概念镜像的不容叫法.</p><p>镜像是一个轻量、只读且不可变的蓝图, 指定了应用运行所谁要的一切, 以及在 Docker 系统上如何运行.
就像是一份配方, 包括所有必要的原料, 诸如依赖、配置、环境设置和你的应用代码, 以及确保应用每次都能稳定运行的详细指令.</p><p>可以把镜像类比为面向对象编程中的类: 定义结构和行为, 但不能直接与类交互, 需要创建实例.</p><h4 id=pulling-and-inspecting-an-image-拉取并查看镜像>Pulling and Inspecting an Image 拉取并查看镜像<a hidden class=anchor aria-hidden=true href=#pulling-and-inspecting-an-image-拉取并查看镜像>#</a></h4><p>镜像其实就是一个 JSON 对象, 可以这样拉取一个镜像</p><pre tabindex=0><code>% docker pull celery:latest
latest: Pulling from library/celery
ef0380f84d05: Pull complete
ada810c79ed7: Pull complete
4608a1c4fe47: Pull complete
58086cbb21fb: Pull complete
a7bccb4a3faa: Pull complete
9de06a08ec25: Pull complete
ad6feb8c6a6b: Pull complete
7568ca85d492: Pull complete
2d6f458f7411: Pull complete
Digest: sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31
Status: Downloaded newer image for celery:latest
docker.io/library/celery:latest

What&#39;s next:
    View a summary of image vulnerabilities and recommendations → docker scout quickview celery:latest
</code></pre><p>现在查看镜像信息</p><pre tabindex=0><code>% docker image inspect celery
</code></pre><p>这个命令会以 JSON 格式输出关于镜像的详细信息</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Id&#34;</span><span class=p>:</span> <span class=s2>&#34;sha256:e111a70eee6a42a68768ec0734a6b2f1ceab34b27e4c4325ed6a14d4f36c2568&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;RepoTags&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;celery:latest&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;RepoDigests&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;celery@sha256:5c236059192a0389a2be21fc42d8db59411d953b7af5457faf501d4eec32dc31&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Parent&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Comment&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Created&#34;</span><span class=p>:</span> <span class=s2>&#34;2017-06-19T16:53:14.832853892Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DockerVersion&#34;</span><span class=p>:</span> <span class=s2>&#34;17.03.1-ce&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Author&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Architecture&#34;</span><span class=p>:</span> <span class=s2>&#34;amd64&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Os&#34;</span><span class=p>:</span> <span class=s2>&#34;linux&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Size&#34;</span><span class=p>:</span> <span class=mi>215773711</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;GraphDriver&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;LowerDir&#34;</span><span class=p>:</span> <span class=s2>&#34;/var/lib/docker/overlay2/48895e03352004bc8ce3d6a639e808ba64b209349af83a3c75b481be2ed94938/diff:/var/lib/docker/overlay2/c845387bc00200c8fb7eb3e3305dba41fdb4ff2d9aa6c085fb0a6ad24c290c73/diff:/var/lib/docker/overlay2/17756520f50f2cbf3e556f44abb1c0b5b6789cd6f6df47246baaabcc3c14d8e0/diff:/var/lib/docker/overlay2/4d0e644e7332550ce97905e7784f5d9f96d9213c774a7204e2fd8b8aa3b11035/diff:/var/lib/docker/overlay2/5d44ed5515c803cd01048443fc3fa4d3372b48fb956d7574513f72a83ab83f66/diff:/var/lib/docker/overlay2/72ff0fa932bdc072f1beb1bc8ff782dc4b1fbde9a658307a698d4e0160d92797/diff:/var/lib/docker/overlay2/78b31a20c2e61a0d663de9c13830def1ae6d14c106dd3a78a581e0e40e7b4689/diff:/var/lib/docker/overlay2/d137d2107e48055ec9dcb33a81a136f0c6625f5e0a7439d1ccd972df8266edce/diff&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;MergedDir&#34;</span><span class=p>:</span> <span class=s2>&#34;/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/merged&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;UpperDir&#34;</span><span class=p>:</span> <span class=s2>&#34;/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/diff&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;WorkDir&#34;</span><span class=p>:</span> <span class=s2>&#34;/var/lib/docker/overlay2/4421a44d9ab8308305d3a051ca7672cb4d8e778bdbba66b8800348a805ee3dfc/work&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Name&#34;</span><span class=p>:</span> <span class=s2>&#34;overlay2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;RootFS&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;layers&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Layers&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:007ab444b234be691d8dafd51839b7713324a261b16e2487bf4a3f989ded912d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:e2a576046222da3c29f237fa2d751d18c7a8f875ddc32fc803466aeaf998b9ee&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:b5fa8e7e036448cb8c431f6b28eb1fbc4573c9330b197c7a0ba8e2292fa9fc2f&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:4437df14034b8c6be5537d719f45f305b8e3365e01abe23a2207ba0963618214&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:2b3426b547f7dade968deaaed73f75d25a883f6688f817ec0c3d1999b2a5c7cf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:df324182704a2a1f6229c5712619b2f2f8e5c0e79c1c90c97b99f2c9e8f0a22d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:bfac39c3713affaa50703d23c5a3dfd7a4f54bdae75af9ea23551cf221b3ae7c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:5c5a2dec46e80510abd744b0d469feaa20a5c10d70c937748509577c5a280dfb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sha256:e4cff87cc854a86536342699faf3e67ce0c2ccf4b735d9998991a024e6fe4db6&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;LastTagTime&#34;</span><span class=p>:</span> <span class=s2>&#34;0001-01-01T00:00:00Z&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;ArgsEscaped&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Cmd&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;celery&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;worker&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Entrypoint&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Env&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;LANG=C.UTF-8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;GPG_KEY=97FC712E4C024BBEA48A61ED3A5CA953F73C700D&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;PYTHON_VERSION=3.5.3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;PYTHON_PIP_VERSION=9.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;CELERY_VERSION=3.1.25&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;CELERY_BROKER_URL=amqp://guest@rabbit&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Labels&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;OnBuild&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;User&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Volumes&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;WorkingDir&#34;</span><span class=p>:</span> <span class=s2>&#34;/home/user&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></div><p>Docker 引擎在从镜像创建容器时, 会使用这个 JSON 对象, 该对象包含许多属性, 例如:</p><ul><li><code>Id</code>: 镜像的唯一标识符</li><li><code>RepoTags</code>: 关联的标签</li><li><code>RepoDigests</code>: 镜像的分发摘要 (用于校验)</li><li><code>Created</code>: 镜像创建时间戳</li><li><code>Author</code>: 镜像创建者</li></ul><p>当使用 <code>docker image pull</code> 命令而没有指定 tag 或版本时, Docker 会自动拉取以 <code>latest</code> 标记的镜像.<br>这里一般是最新版本, 但注意 <code>latest</code> 知识一直约定, 并非所有镜像最新版本的 tag 都是 <code>latest</code></p><h4 id=the-layers-property--layers-属性>The Layers Property | Layers 属性<a hidden class=anchor aria-hidden=true href=#the-layers-property--layers-属性>#</a></h4><p>镜像 JSON 对象中最关键的属性之一是 Layers, 如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;layers&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;Layers&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:007ab444b234be691d8dafd51839b7713324a261b16e2487bf4a3f989ded912d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:e2a576046222da3c29f237fa2d751d18c7a8f875ddc32fc803466aeaf998b9ee&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:b5fa8e7e036448cb8c431f6b28eb1fbc4573c9330b197c7a0ba8e2292fa9fc2f&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:4437df14034b8c6be5537d719f45f305b8e3365e01abe23a2207ba0963618214&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:2b3426b547f7dade968deaaed73f75d25a883f6688f817ec0c3d1999b2a5c7cf&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:df324182704a2a1f6229c5712619b2f2f8e5c0e79c1c90c97b99f2c9e8f0a22d&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:bfac39c3713affaa50703d23c5a3dfd7a4f54bdae75af9ea23551cf221b3ae7c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:5c5a2dec46e80510abd744b0d469feaa20a5c10d70c937748509577c5a280dfb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sha256:e4cff87cc854a86536342699faf3e67ce0c2ccf4b735d9998991a024e6fe4db6&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=what-is-layer--什么是-layer>What is Layer? | 什么是 Layer?<a hidden class=anchor aria-hidden=true href=#what-is-layer--什么是-layer>#</a></h4><p>文章开头提到镜像包含所有必要信息(依赖 配置等), 在 Docker 中, 模块化和解耦是关键原则.
Docker 中的 layer 本质是一组文件(或单个文件), 例如一个 Python 应用可能需要:</p><ul><li>Python 二进制文件</li><li>apt 包管理器 / 所需系统工具</li><li>最后是应用文件 (又一个 layer)</li></ul><p>layer 的好处在于: 一旦创建并存储了 Python 二进制的 layer, 任何需要它的镜像都可以直接引用它的位置.
Docker 会按需获取它, 如果世界另一端的某人也需要相同的 Python Layer, 他们不需要重新创建或重复上传该层, 可以直接使用相同的 Layer.
这种做法运行我们共享、重用并高效管理资源. 更棒的是, 分层让本地的更加高效, 如果机器的另一个镜像已经下载了一些 layer, Docker 会智能地复用这些已存在的 layer, 而不是重复下载.</p><p>简单来说: Layer 是一组文件, 而 Image 指明了它包含哪些层, 以及他们如何堆叠. 层的顺序很重要, 因为上层的文件可以屏蔽下层的文件.</p><p>但是, 容器本身并不知道层或文件在层中的组织方式, 容器看到的是一个完整的文件系统. 这由 Docker 的存储驱动完成: 它将所有层的文件收集合并, 为容器呈现一个单一的文件系统.</p><p>例如下面两个数据库镜像</p><pre tabindex=0><code>$ docker pull redis
        Using default tag: latest
        latest: Pulling from library/redis
        af302e5c37e9: Pull complete  # &lt;&lt;&lt;&lt;-----  [1]
        01b95e092fd0: Pull complete
        c111ca53a743: Pull complete
        f7d6cf14046e: Pull complete
        589f36d317d9: Pull complete
        94041d0cae8f: Pull complete
        4f4fb700ef54: Pull complete
        4f5f785c9703: Pull complete
        Digest: sha256:ca65ea36ae16e709b0f1c7534bc7e5b5ac2e5bb3c97236e4fec00e3625eb678d
        Status: Downloaded newer image for redis:latest
        docker.io/library/redis:latest

$ docker pull postgres
        Using default tag: latest
        latest: Pulling from library/postgres
        af302e5c37e9: Already exists # &lt;&lt;&lt;&lt;-----  Check this out, this layer was already fetched in [1]
        23db180a1f67: Pull complete
        dc59dd9c8eb3: Pull complete
        aec09e638045: Pull complete
        4dd47a683737: Pull complete
        7cebbe7849b3: Pull complete
        dc4330b02129: Pull complete
        498cc40b9fe9: Pull complete
        6d3411bb4696: Pull complete
        8f14f34d54d3: Pull complete
        88d4f7416643: Pull complete
        e91ad5cfb8d0: Pull complete
        e0c4d5055fb9: Pull complete
        254ee626d709: Pull complete
        Digest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae
        Status: Downloaded newer image for postgres:latest
        docker.io/library/postgres:latest
</code></pre><h4 id=base-layer-基础层>Base Layer 基础层<a hidden class=anchor aria-hidden=true href=#base-layer-基础层>#</a></h4><p>镜像中的 base layer 就像建筑的地基, 它是后续构建的起点.
通常 base layer 包含操作系统或运行环境所需的基础文件和工具.
每个 Docker 镜像都以 base layer 开始, 后续层在其基础上构建.
这个基础层保证了一致性, 并为应用提供了稳定的运行环境.
由于 base layer 可以在做个镜像之间重复使用, Docker 只需下载并存储一份, 从而提高效率并节省空间.
在上面的 Redis / Postgres 示例中, <code>af302e5c37e9</code> 就是 base layer.</p><h4 id=digests-摘要>Digests 摘要<a hidden class=anchor aria-hidden=true href=#digests-摘要>#</a></h4><p>如前所述, layer 是可重用的, 所以 Docker 需要一种系统来高效存储、组织和定位他们.
这些数字就是 layer 的唯一地址, 使得他们可以被识别和重用, 每个 layer 都有一个基于其内容计算出来的哈希值, 准确的说是该层的 content-addressable identifier 内容寻址.</p><p>Docker 会为 layer 中的每个文件计算哈希, 然后生成该 layer 的合并哈希.
这个哈希确保 layer 是唯一可寻址的, 从而让镜像可以指向它</p><p>如果某个 layer 中的文件被更新了, 文件的哈希会改变, layer 的合并哈希也会改变, 而产生一个全新的、唯一的 layer.</p><h4 id=image-digests-镜像摘要>Image Digests 镜像摘要<a hidden class=anchor aria-hidden=true href=#image-digests-镜像摘要>#</a></h4><pre tabindex=0><code>$ docker pull postgres
    Using default tag: latest
    latest: Pulling from library/postgres
    af302e5c37e9: Already exists
    23db180a1f67: Pull complete
    ...
    254ee626d709: Pull complete
    Digest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae #&lt;----- Distribution Hash
    Status: Downloaded newer image for postgres:latest
    docker.io/library/postgres:latest
</code></pre><p>每个镜像由一系列 layer 构成, 每个 layer 有自己的哈希, 这意味着整个镜像也可以有一个用于识别它的唯一哈希, 在 layer 列表后看到的那个值就是</p><pre tabindex=0><code>Digest: sha256:87ec5e0a167dc7d4831729f9e1d2ee7b8597dcc49ccd9e43cc5f89e808d2adae
</code></pre><p>这个就是 image digest, 是整个镜像的唯一哈希值.</p><p>镜像通常按名字拉取, 但 digest 在安全性方面非常关键, 用于确认拉取的镜像没有被篡改, 保证镜像的安全与真实性.</p><p>镜像有两种类型的 digest 值:</p><ul><li>Distribution Digest: 压缩后镜像的哈希, 用于传输阶段</li><li>Content Digest: 每个未压缩 layer 的内容哈希</li></ul><h4 id=the-role-of-comparession-and-digest-verification-压缩与摘要检验的角色>The Role of Comparession and Digest Verification 压缩与摘要检验的角色<a hidden class=anchor aria-hidden=true href=#the-role-of-comparession-and-digest-verification-压缩与摘要检验的角色>#</a></h4><p>在将镜像推送到 registry 之前, Docker 会对 layer 和镜像进行压缩以节省存储和网络流量.
压缩后会计算一个哈希, 并将其发送给 registry.
registry 会基于接收到的内容, 重新计算哈希并与 DOcker 发来的哈希比较.
这个哈下就是 Distribution Digest.
当另一端拉取镜像时, Docker 会计算接收到内容的哈希并与原始的 Distribution Digest 比对, 确保镜像在传输过程中未被篡改.</p><pre tabindex=0><code># Content Hash
$ docker image inspect redis
...
 &#34;RootFS&#34;: {
            &#34;Type&#34;: &#34;layers&#34;,
            &#34;Layers&#34;: [
                &#34;sha256:f5fe472da25334617e6e6467c7ebce41e0ae5580e5bd0ecbf0d573bacd560ecb&#34;, # &lt;--- Content Digest
                &#34;sha256:3e62a323d3749bd1fc58ef850f0d6e5a9c901f71cc160426da9f6fb7507293ef&#34;,
                &#34;sha256:b5a15fcf554ab5310928776fceacdc57d225c145d96a3d3b62382a31684a6c7e&#34;,
                                ...,
                &#34;sha256:ca15e9bb0d852a5e8c1d4c3264fa085f68197056b80da09003764bfa6dda5067&#34;
            ]
        },
</code></pre><pre tabindex=0><code># Distribution hash
$ docker images --digests redis
redis        latest    sha256:ca65ea36ae16e709b0f1c7534bc7e5b5ac2e5bb3c97236e4fec00e3625eb678d   4075a3f8c3f8   13 days ago   117MB
</code></pre><h4 id=image-registry-镜像仓库>Image Registry 镜像仓库<a hidden class=anchor aria-hidden=true href=#image-registry-镜像仓库>#</a></h4><p>镜像仓库是容器镜像的存储中心, 各类软件, 像 Redis、Postgres、Node.js 这样的热门软件会把他们的容器化版本存放在这里.
这些仓库让用户可以方便地随时访问这些镜像, 虽然存在许多仓库, 但最广泛的是 Docker 的镜像仓库 - Docker Hub.</p><p>当运行类似 <code>docker pull &lt;image-name></code> 的命令时, 其实在使用一个简写.
完整的命令包含注册中心 registry, 组织 organization 和标签 tag, 如下所示:</p><pre tabindex=0><code>docker pull &lt;registry&gt;/&lt;organization&gt;/&lt;repository&gt;:&lt;tag&gt;

# 例如
# docker pull docker.io/library/redis:latest
# docker pull docker.io/fredj/sample:1.0
</code></pre><p>当省略某些细节时, Docker 会做一些默认假设来补全:</p><ul><li>Registry & Organization: 如果不指定, docker 默认使用 Docker Hub (<code>docker.io</code>), 并假设官方镜像位于 <code>library</code> 组织下</li><li>Tag: 如果不提供 tag, Docker 会拉取标记为 <code>latest</code> 的镜像</li></ul><h4 id=repository-the-heart-of-the-registry--仓库-镜像仓库的核心>Repository: The Heart of the Registry | 仓库: 镜像仓库的核心<a hidden class=anchor aria-hidden=true href=#repository-the-heart-of-the-registry--仓库-镜像仓库的核心>#</a></h4><p>仓库 repository 是镜像仓库中的核心单位.
每个 registry 托管多个 repository, 每个 repository 代表一个应用或工具, 例如 redis、postgres、alpine、node.
在一个 repository 下可以有多个 tag, 每个 tag 对应镜像的一个具体版本.</p><p>有点类似 Git: Docker 的 repository 有点类似, 可以包含多个带标签的版本. 例如:</p><ul><li>Redis 在 GitHub 上带有标签的发布</li><li>类似的, Docker 上的 Redis 仓库也有标签</li></ul><h4 id=two-types-of-repositories-on-docker-hub--docker-hub-上的两类仓库>Two Types of Repositories on Docker Hub | Docker Hub 上的两类仓库<a hidden class=anchor aria-hidden=true href=#two-types-of-repositories-on-docker-hub--docker-hub-上的两类仓库>#</a></h4><ul><li><p>官方仓库 Offical Repositories<br>这些是经过 Docker 官方策划与验证的高质量镜像, 位于仓库的顶层, 因此可以不写组织名直接拉取, 例如:</p><pre tabindex=0><code>docker pull ubuntu
</code></pre><p>这些官方仓库包含像 Redis、Ubuntu、Python、Node.js 等流行工具的镜像</p></li><li><p>Regular Repositories 普通仓库<br>这些由个人、团队或组织创建, 拉取普通仓库的镜像时通常需要指定组织, 例如:</p><pre tabindex=0><code>docker pull mycompany/sample:1.0
</code></pre></li></ul><h4 id=other-registries-其他仓库>Other Registries 其他仓库<a hidden class=anchor aria-hidden=true href=#other-registries-其他仓库>#</a></h4><p>虽然 Docker Hub 是默认选项, 但他并非唯一选择, 还有很多其他仓库, 例如:</p><ul><li>AWS Elastic Container Registry (ECR)</li><li>Google Container Registry (GCR)</li><li>GitHub Container Registry (GHCR)</li></ul><p>从这些仓库拉取镜像时, 需要在命令中指定 registry 名称, 例如:</p><pre tabindex=0><code>docker pull &lt;registry&gt;/&lt;organization&gt;/&lt;repository&gt;:&lt;tag&gt;

# 例如
# docker pull ghcr.io/myteam/myapp:1.0
</code></pre><p>不同的镜像仓库之所以能无缝工作, 是因为遵循了 OCI 标准, 它定义了镜像的创建与分发方式. 两个关键标准是:</p><ul><li>Image Specification: 定义容器镜像如何创建, 像一个通用的镜像蓝图规范</li><li>Distribution Specification: 规定镜像如何在注册中心之间共享和分发</li></ul><p>只要注册中心和镜像遵循这些标准, 使用什么工具制作镜像, 把镜像发布到哪个 registry, 都能互相兼容, 像魔法一样地协同工作.</p><h3 id=conclusion-结论>Conclusion 结论<a hidden class=anchor aria-hidden=true href=#conclusion-结论>#</a></h3><p>Docker 镜像与层构成了容器化应用开发的骨干. 理解镜像如何构建, 存储与分发是掌握 Docker 的重要一步.
这些概念不仅是理论上的, 还是让容器轻量、可重用并高效的实用工具.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://starslayerx.github.io/tags/docker/>Docker</a></li></ul><nav class=paginav><a class=prev href=https://starslayerx.github.io/posts/docker-workflow/><span class=title>« Prev</span><br><span>Docker - Workflow</span>
</a><a class=next href=https://starslayerx.github.io/posts/docker-engine-and-netowrking/><span class=title>Next »</span><br><span>Docker - Engine and Netowrking</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on x" href="https://x.com/intent/tweet/?text=Docker%20-%20Images%20and%20Registeries&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f&amp;hashtags=Docker"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f&amp;title=Docker%20-%20Images%20and%20Registeries&amp;summary=Docker%20-%20Images%20and%20Registeries&amp;source=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f&title=Docker%20-%20Images%20and%20Registeries"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on whatsapp" href="https://api.whatsapp.com/send?text=Docker%20-%20Images%20and%20Registeries%20-%20https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on telegram" href="https://telegram.me/share/url?text=Docker%20-%20Images%20and%20Registeries&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Docker - Images and Registeries on ycombinator" href="https://news.ycombinator.com/submitlink?t=Docker%20-%20Images%20and%20Registeries&u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fdocker-images-and-registeries%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://starslayerx.github.io/>Starslayerx' Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>