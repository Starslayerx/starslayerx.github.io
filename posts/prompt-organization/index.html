<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Prompt Organization | Starslayerx' Blog</title><meta name=keywords content="Prompt,LLMs"><meta name=description content='这篇文章旨在介绍 Python 中常用的提示词组织方式
f-string
使用 f 字符串填充变量得到提示词
def get_prompt(query: str) -> list[dict]:
    SYSTEM_PROMPT = f"""...
...
多行提示词, 也可以填充变量
"""
    USER_PROMPT = f"""INPUT:
{query}
....
"""
    return [
        {"role": "system", "content": SYSTEM_PROMPT},
        {"role": "user", "content": USER_PROMPT},
    ]
这种方法实现简单, 速度快, 但是:

多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱
# 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅
system_prompt = (
    f"你是一名{role}负责...\n"
    f"具体规则:\n"
    f"1. ...."
    f"2. ...."
)
上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了
通过代码构造提示词, 任何修改都需要修改代码, 扩展性差

string.Template
使用 Python 元素字符串模板
SYSTEM_PROMPT = string.Template("""你是一名$role
多行提示词...
""")

USER_PROMPT = string.Template("""INPUT:
$query
""")

def get_prompt(role: str, query: str) -> list[dict]:
    system_prompt = SYSTEM_PROMPT.subtitute(role="助手")
    user_prompt = USER_PROMPT.subtitute(query="问题...")
    return [
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": user_prompt},
    ]
使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 .safe_substitute()方法传入一个字典, 例如 {"query": "问题..."}, 对没有传入的变量解析为 $var
对比 f-string, 模板字符串更加灵活, 且可以只传入部分值'><meta name=author content="Starslayerx"><link rel=canonical href=https://starslayerx.github.io/posts/prompt-organization/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=16x16 href=https://starslayerx.github.io/favicon.svg><link rel=icon type=image/png sizes=32x32 href=https://starslayerx.github.io/favicon.svg><link rel=apple-touch-icon href=https://starslayerx.github.io/favicon.svg><link rel=mask-icon href=https://starslayerx.github.io/favicon.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://starslayerx.github.io/posts/prompt-organization/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://starslayerx.github.io/posts/prompt-organization/"><meta property="og:site_name" content="Starslayerx' Blog"><meta property="og:title" content="Prompt Organization"><meta property="og:description" content='这篇文章旨在介绍 Python 中常用的提示词组织方式
f-string 使用 f 字符串填充变量得到提示词
def get_prompt(query: str) -> list[dict]: SYSTEM_PROMPT = f"""... ... 多行提示词, 也可以填充变量 """ USER_PROMPT = f"""INPUT: {query} .... """ return [ {"role": "system", "content": SYSTEM_PROMPT}, {"role": "user", "content": USER_PROMPT}, ] 这种方法实现简单, 速度快, 但是:
多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱 # 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅 system_prompt = ( f"你是一名{role}负责...\n" f"具体规则:\n" f"1. ...." f"2. ...." ) 上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了 通过代码构造提示词, 任何修改都需要修改代码, 扩展性差 string.Template 使用 Python 元素字符串模板
SYSTEM_PROMPT = string.Template("""你是一名$role 多行提示词... """) USER_PROMPT = string.Template("""INPUT: $query """) def get_prompt(role: str, query: str) -> list[dict]: system_prompt = SYSTEM_PROMPT.subtitute(role="助手") user_prompt = USER_PROMPT.subtitute(query="问题...") return [ {"role": "system", "content": system_prompt}, {"role": "user", "content": user_prompt}, ] 使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 .safe_substitute()方法传入一个字典, 例如 {"query": "问题..."}, 对没有传入的变量解析为 $var
对比 f-string, 模板字符串更加灵活, 且可以只传入部分值'><meta property="og:locale" content="en-US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-28T08:00:00+08:00"><meta property="article:modified_time" content="2025-08-28T08:00:00+08:00"><meta property="article:tag" content="Prompt"><meta property="article:tag" content="LLMs"><meta property="og:image" content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://starslayerx.github.io/images/og-default.avif"><meta name=twitter:title content="Prompt Organization"><meta name=twitter:description content='这篇文章旨在介绍 Python 中常用的提示词组织方式
f-string
使用 f 字符串填充变量得到提示词
def get_prompt(query: str) -> list[dict]:
    SYSTEM_PROMPT = f"""...
...
多行提示词, 也可以填充变量
"""
    USER_PROMPT = f"""INPUT:
{query}
....
"""
    return [
        {"role": "system", "content": SYSTEM_PROMPT},
        {"role": "user", "content": USER_PROMPT},
    ]
这种方法实现简单, 速度快, 但是:

多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱
# 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅
system_prompt = (
    f"你是一名{role}负责...\n"
    f"具体规则:\n"
    f"1. ...."
    f"2. ...."
)
上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了
通过代码构造提示词, 任何修改都需要修改代码, 扩展性差

string.Template
使用 Python 元素字符串模板
SYSTEM_PROMPT = string.Template("""你是一名$role
多行提示词...
""")

USER_PROMPT = string.Template("""INPUT:
$query
""")

def get_prompt(role: str, query: str) -> list[dict]:
    system_prompt = SYSTEM_PROMPT.subtitute(role="助手")
    user_prompt = USER_PROMPT.subtitute(query="问题...")
    return [
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": user_prompt},
    ]
使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 .safe_substitute()方法传入一个字典, 例如 {"query": "问题..."}, 对没有传入的变量解析为 $var
对比 f-string, 模板字符串更加灵活, 且可以只传入部分值'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://starslayerx.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Prompt Organization","item":"https://starslayerx.github.io/posts/prompt-organization/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Prompt Organization","name":"Prompt Organization","description":"这篇文章旨在介绍 Python 中常用的提示词组织方式\nf-string 使用 f 字符串填充变量得到提示词\ndef get_prompt(query: str) -\u0026gt; list[dict]: SYSTEM_PROMPT = f\u0026#34;\u0026#34;\u0026#34;... ... 多行提示词, 也可以填充变量 \u0026#34;\u0026#34;\u0026#34; USER_PROMPT = f\u0026#34;\u0026#34;\u0026#34;INPUT: {query} .... \u0026#34;\u0026#34;\u0026#34; return [ {\u0026#34;role\u0026#34;: \u0026#34;system\u0026#34;, \u0026#34;content\u0026#34;: SYSTEM_PROMPT}, {\u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: USER_PROMPT}, ] 这种方法实现简单, 速度快, 但是:\n多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱 # 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅 system_prompt = ( f\u0026#34;你是一名{role}负责...\\n\u0026#34; f\u0026#34;具体规则:\\n\u0026#34; f\u0026#34;1. ....\u0026#34; f\u0026#34;2. ....\u0026#34; ) 上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了 通过代码构造提示词, 任何修改都需要修改代码, 扩展性差 string.Template 使用 Python 元素字符串模板\nSYSTEM_PROMPT = string.Template(\u0026#34;\u0026#34;\u0026#34;你是一名$role 多行提示词... \u0026#34;\u0026#34;\u0026#34;) USER_PROMPT = string.Template(\u0026#34;\u0026#34;\u0026#34;INPUT: $query \u0026#34;\u0026#34;\u0026#34;) def get_prompt(role: str, query: str) -\u0026gt; list[dict]: system_prompt = SYSTEM_PROMPT.subtitute(role=\u0026#34;助手\u0026#34;) user_prompt = USER_PROMPT.subtitute(query=\u0026#34;问题...\u0026#34;) return [ {\u0026#34;role\u0026#34;: \u0026#34;system\u0026#34;, \u0026#34;content\u0026#34;: system_prompt}, {\u0026#34;role\u0026#34;: \u0026#34;user\u0026#34;, \u0026#34;content\u0026#34;: user_prompt}, ] 使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 .safe_substitute()方法传入一个字典, 例如 {\u0026quot;query\u0026quot;: \u0026quot;问题...\u0026quot;}, 对没有传入的变量解析为 $var\n对比 f-string, 模板字符串更加灵活, 且可以只传入部分值\n","keywords":["Prompt","LLMs"],"articleBody":"这篇文章旨在介绍 Python 中常用的提示词组织方式\nf-string 使用 f 字符串填充变量得到提示词\ndef get_prompt(query: str) -\u003e list[dict]: SYSTEM_PROMPT = f\"\"\"... ... 多行提示词, 也可以填充变量 \"\"\" USER_PROMPT = f\"\"\"INPUT: {query} .... \"\"\" return [ {\"role\": \"system\", \"content\": SYSTEM_PROMPT}, {\"role\": \"user\", \"content\": USER_PROMPT}, ] 这种方法实现简单, 速度快, 但是:\n多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱 # 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅 system_prompt = ( f\"你是一名{role}负责...\\n\" f\"具体规则:\\n\" f\"1. ....\" f\"2. ....\" ) 上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了 通过代码构造提示词, 任何修改都需要修改代码, 扩展性差 string.Template 使用 Python 元素字符串模板\nSYSTEM_PROMPT = string.Template(\"\"\"你是一名$role 多行提示词... \"\"\") USER_PROMPT = string.Template(\"\"\"INPUT: $query \"\"\") def get_prompt(role: str, query: str) -\u003e list[dict]: system_prompt = SYSTEM_PROMPT.subtitute(role=\"助手\") user_prompt = USER_PROMPT.subtitute(query=\"问题...\") return [ {\"role\": \"system\", \"content\": system_prompt}, {\"role\": \"user\", \"content\": user_prompt}, ] 使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 .safe_substitute()方法传入一个字典, 例如 {\"query\": \"问题...\"}, 对没有传入的变量解析为 $var\n对比 f-string, 模板字符串更加灵活, 且可以只传入部分值\nJinja Jinja 是一个现代的设计者友好的, 仿照 Django 模板的 Python 模板语言. 它速度快, 被广泛使用, 并且提供了可选的沙箱模板执行环境保证安全:\n例如下面这个 .j2 文件内容, 构造了一个用于少样本提示的模板\n{% if examples %} {% for example in examples %} INPUT: {{ example.input }} OUPUT: {{ example.output }} {% endfor %} {% endif %} INPUT: {{ user_input }} 导入该模板文件代码如下:\nfrom jinja2 import Environment, PackageLoader # 根据需要不同也可以使用 FileSystemLoader env = Environment( loader=PackageLoader(\"app.module.prompt\", \"template\"), trim_blocks=True, # 移除 {% ... %} 块前后的多余空白 lstrip_blocks=True, # 移除行首 {% ... %} 块前的空白 ) def get_prompt(user_input: str) -\u003e list[dict]: system_template = env.get_template(\"system_template.j2\") user_template = env.get_template(\"user_template.j2\") system_data = {\"var\": val, ...} user_data = { \"examples\": [ {\"input\": \"示例输入1\", \"output\": \"示例输出1\"}, # 具体样例也可以通过函数传入 {\"input\": \"示例输入2\", \"output\": \"示例输出2\"}, ], \"user_input\": user_input\", } messages = [ {\"role\": \"system\", \"content\": system_template.render(system_data)}, {\"role\": \"user\", \"content\": user_template.render(user_prompt)}, ] return messages 使用 Jinja 模板文件的好处是:\n方便组织提示词文件, 例如这里是将提示词文件放在 ProjectRoot/app/module/prompt 里面, 模板文件放在 prompt/template 里面, 在提示词文件中导入模板文件十分方便, 文件组织清晰, 代码可读性高, 且方便扩展 提示词灵活性更好, 对比 string.Template, Jinja 模板不仅可以填充变量, 还可以在模板中插入循环和条件判断等语法, 使得代码中只需提供一个字典格式的数据即可, 无需在代码里拼凑提示词, 也方便和 RAG 系统结合使用 虽然 Jinja 对比 string.Template 性能上要差一些, 但是 LLM 应用真正花时间的地方是模型的推理部分, 相比之下提示词渲染的时间几乎可以忽略不计. 如果提示词非常多, Jinja 还提供了异步渲染功能, 可以结合异步框架进一步提升性能.\nWrapping Up 上面就是近期使用的一些构造提示词的方法, 分别是 f-string、string.Template 和 Jinja.\n当然也有像 langchain_core.prompts.prompt.PromptTemplate 这样专用框架提供的提示词模板功能, 但是为了支持 LangChain LCEL 语法等原因, 导致其类型设计十分抽象, 且 LangChain 对新模型和新功能的支持比较缓慢, 加上版本不稳定, 接口经常变动, 故没有考虑使用 LangChain 框架提供的功能.(实际上, langchain 也支持使用 Jinja 模板)\n总之, 上面介绍的提示词构造方法各有优劣, 应该根据你项目的复杂度, 自行选择合适的提示词构造方式.\n","wordCount":"305","inLanguage":"en","image":"https://starslayerx.github.io/images/og-default.avif","datePublished":"2025-08-28T08:00:00+08:00","dateModified":"2025-08-28T08:00:00+08:00","author":{"@type":"Person","name":"Starslayerx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://starslayerx.github.io/posts/prompt-organization/"},"publisher":{"@type":"Organization","name":"Starslayerx' Blog","logo":{"@type":"ImageObject","url":"https://starslayerx.github.io/favicon.svg"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://starslayerx.github.io/ accesskey=h title="Starslayerx' Blog (Alt + H)"><img src=https://starslayerx.github.io/favicon.svg alt aria-label=logo height=35>Starslayerx' Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://starslayerx.github.io/zh-cn/ title=简体中文 aria-label=简体中文>Zh-Cn</a></li></ul></div></div><ul id=menu><li><a href=https://starslayerx.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://starslayerx.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://starslayerx.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://starslayerx.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://starslayerx.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://starslayerx.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://starslayerx.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Prompt Organization</h1><div class=post-meta><span title='2025-08-28 08:00:00 +0800 +0800'>August 28, 2025</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>305 words</span>&nbsp;·&nbsp;<span>Starslayerx</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#f-string>f-string</a></li><li><a href=#stringtemplate>string.Template</a></li><li><a href=#jinja>Jinja</a></li><li><a href=#wrapping-up>Wrapping Up</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>这篇文章旨在介绍 Python 中常用的提示词组织方式</p><h3 id=f-string>f-string<a hidden class=anchor aria-hidden=true href=#f-string>#</a></h3><p>使用 f 字符串填充变量得到提示词</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_prompt</span><span class=p>(</span><span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>SYSTEM_PROMPT</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;...
</span></span></span><span class=line><span class=cl><span class=s2>...
</span></span></span><span class=line><span class=cl><span class=s2>多行提示词, 也可以填充变量
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>USER_PROMPT</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;INPUT:
</span></span></span><span class=line><span class=cl><span class=si>{</span><span class=n>query</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>....
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>SYSTEM_PROMPT</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>USER_PROMPT</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span></code></pre></div><p>这种方法实现简单, 速度快, 但是:</p><ol><li>多行字符串由于填充变量的需要, 需写在函数内, 导致代码格式混乱<div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=c1># 实际上, 多行字符串还可以这样实现, 但也不太时候提示词太多的时候, 但这样代码格式会更加优雅</span>
</span></span><span class=line><span class=cl><span class=n>system_prompt</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;你是一名</span><span class=si>{</span><span class=n>role</span><span class=si>}</span><span class=s2>负责...</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;具体规则:</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;1. ....&#34;</span>
</span></span><span class=line><span class=cl>    <span class=sa>f</span><span class=s2>&#34;2. ....&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div>上面这种方法会将多行字符串合并, 注意不要加逗号, 不然就变成元组了</li><li>通过代码构造提示词, 任何修改都需要修改代码, 扩展性差</li></ol><h3 id=stringtemplate>string.Template<a hidden class=anchor aria-hidden=true href=#stringtemplate>#</a></h3><p>使用 Python 元素字符串模板</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=n>SYSTEM_PROMPT</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>Template</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;你是一名$role
</span></span></span><span class=line><span class=cl><span class=s2>多行提示词...
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>USER_PROMPT</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>Template</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;INPUT:
</span></span></span><span class=line><span class=cl><span class=s2>$query
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_prompt</span><span class=p>(</span><span class=n>role</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>query</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>system_prompt</span> <span class=o>=</span> <span class=n>SYSTEM_PROMPT</span><span class=o>.</span><span class=n>subtitute</span><span class=p>(</span><span class=n>role</span><span class=o>=</span><span class=s2>&#34;助手&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>user_prompt</span> <span class=o>=</span> <span class=n>USER_PROMPT</span><span class=o>.</span><span class=n>subtitute</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=s2>&#34;问题...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>system_prompt</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>user_prompt</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span></code></pre></div><p>使用模板字符串, 模板则不必写在函数内, 且模板字符串可以选择替换部分变量, 使用 <code>.safe_substitute()</code>方法传入一个字典, 例如 <code>{"query": "问题..."}</code>, 对没有传入的变量解析为 <code>$var</code><br>对比 f-string, 模板字符串更加灵活, 且可以只传入部分值</p><h3 id=jinja>Jinja<a hidden class=anchor aria-hidden=true href=#jinja>#</a></h3><p>Jinja 是一个现代的设计者友好的, 仿照 Django 模板的 Python 模板语言. 它速度快, 被广泛使用, 并且提供了可选的沙箱模板执行环境保证安全:<br>例如下面这个 <code>.j2</code> 文件内容, 构造了一个用于少样本提示的模板</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Jinja data-lang=Jinja><span class=line><span class=cl><span class=cp>{%</span> <span class=k>if</span> <span class=nv>examples</span> <span class=cp>%}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=cp>{%</span> <span class=k>for</span> <span class=nv>example</span> <span class=k>in</span> <span class=nv>examples</span> <span class=cp>%}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>INPUT:
</span></span></span><span class=line><span class=cl><span class=cp>{{</span> <span class=nv>example.input</span> <span class=cp>}}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>OUPUT:
</span></span></span><span class=line><span class=cl><span class=cp>{{</span> <span class=nv>example.output</span> <span class=cp>}}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>
</span></span></span><span class=line><span class=cl><span class=cp>{%</span> <span class=k>endfor</span> <span class=cp>%}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=cp>{%</span> <span class=k>endif</span> <span class=cp>%}</span><span class=x>
</span></span></span><span class=line><span class=cl><span class=x>INPUT:
</span></span></span><span class=line><span class=cl><span class=cp>{{</span> <span class=nv>user_input</span> <span class=cp>}}</span><span class=x>
</span></span></span></code></pre></div><p>导入该模板文件代码如下:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>jinja2</span> <span class=kn>import</span> <span class=n>Environment</span><span class=p>,</span> <span class=n>PackageLoader</span> <span class=c1># 根据需要不同也可以使用 FileSystemLoader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>env</span> <span class=o>=</span> <span class=n>Environment</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>loader</span><span class=o>=</span><span class=n>PackageLoader</span><span class=p>(</span><span class=s2>&#34;app.module.prompt&#34;</span><span class=p>,</span> <span class=s2>&#34;template&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>trim_blocks</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=c1># 移除 {% ... %} 块前后的多余空白</span>
</span></span><span class=line><span class=cl>    <span class=n>lstrip_blocks</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=c1># 移除行首 {% ... %} 块前的空白</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_prompt</span><span class=p>(</span><span class=n>user_input</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=n>system_template</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>get_template</span><span class=p>(</span><span class=s2>&#34;system_template.j2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>user_template</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>get_template</span><span class=p>(</span><span class=s2>&#34;user_template.j2&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>system_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;var&#34;</span><span class=p>:</span> <span class=n>val</span><span class=p>,</span> <span class=o>...</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>user_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;examples&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;input&#34;</span><span class=p>:</span> <span class=s2>&#34;示例输入1&#34;</span><span class=p>,</span> <span class=s2>&#34;output&#34;</span><span class=p>:</span> <span class=s2>&#34;示例输出1&#34;</span><span class=p>},</span> <span class=c1># 具体样例也可以通过函数传入</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;input&#34;</span><span class=p>:</span> <span class=s2>&#34;示例输入2&#34;</span><span class=p>,</span> <span class=s2>&#34;output&#34;</span><span class=p>:</span> <span class=s2>&#34;示例输出2&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;user_input&#34;</span><span class=p>:</span> <span class=n>user_input</span><span class=s2>&#34;,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>messages</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>system_template</span><span class=o>.</span><span class=n>render</span><span class=p>(</span><span class=n>system_data</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>user_template</span><span class=o>.</span><span class=n>render</span><span class=p>(</span><span class=n>user_prompt</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>messages</span>
</span></span></code></pre></div><p>使用 Jinja 模板文件的好处是:</p><ol><li>方便组织提示词文件, 例如这里是将提示词文件放在 <code>ProjectRoot/app/module/prompt</code> 里面, 模板文件放在 <code>prompt/template</code> 里面, 在提示词文件中导入模板文件十分方便, 文件组织清晰, 代码可读性高, 且方便扩展</li><li>提示词灵活性更好, 对比 string.Template, Jinja 模板不仅可以填充变量, 还可以在模板中插入循环和条件判断等语法, 使得代码中只需提供一个字典格式的数据即可, 无需在代码里拼凑提示词, 也方便和 RAG 系统结合使用</li></ol><p>虽然 Jinja 对比 string.Template 性能上要差一些, 但是 LLM 应用真正花时间的地方是模型的推理部分, 相比之下提示词渲染的时间几乎可以忽略不计. 如果提示词非常多, Jinja 还提供了异步渲染功能, 可以结合异步框架进一步提升性能.</p><h3 id=wrapping-up>Wrapping Up<a hidden class=anchor aria-hidden=true href=#wrapping-up>#</a></h3><p>上面就是近期使用的一些构造提示词的方法, 分别是 <code>f-string</code>、<code>string.Template</code> 和 <code>Jinja</code>.<br>当然也有像 <code>langchain_core.prompts.prompt.PromptTemplate</code> 这样专用框架提供的提示词模板功能, 但是为了支持 LangChain LCEL 语法等原因, 导致其类型设计十分抽象, 且 LangChain 对新模型和新功能的支持比较缓慢, 加上版本不稳定, 接口经常变动, 故没有考虑使用 LangChain 框架提供的功能.(实际上, langchain 也支持使用 Jinja 模板)<br>总之, 上面介绍的提示词构造方法各有优劣, 应该根据你项目的复杂度, 自行选择合适的提示词构造方式.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://starslayerx.github.io/tags/prompt/>Prompt</a></li><li><a href=https://starslayerx.github.io/tags/llms/>LLMs</a></li></ul><nav class=paginav><a class=prev href=https://starslayerx.github.io/posts/asyncio-vs-gevents-in-python/><span class=title>« Prev</span><br><span>Asyncio vs Gevents in Python</span>
</a><a class=next href=https://starslayerx.github.io/posts/from-python-to-go/><span class=title>Next »</span><br><span>From Python to Go</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on x" href="https://x.com/intent/tweet/?text=Prompt%20Organization&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f&amp;hashtags=Prompt%2cLLMs"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f&amp;title=Prompt%20Organization&amp;summary=Prompt%20Organization&amp;source=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f&title=Prompt%20Organization"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on whatsapp" href="https://api.whatsapp.com/send?text=Prompt%20Organization%20-%20https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on telegram" href="https://telegram.me/share/url?text=Prompt%20Organization&amp;url=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Prompt Organization on ycombinator" href="https://news.ycombinator.com/submitlink?t=Prompt%20Organization&u=https%3a%2f%2fstarslayerx.github.io%2fposts%2fprompt-organization%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://starslayerx.github.io/>Starslayerx' Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>